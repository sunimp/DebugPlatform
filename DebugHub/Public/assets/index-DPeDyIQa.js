var Ts=Object.defineProperty;var Cs=(t,s,r)=>s in t?Ts(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var me=(t,s,r)=>Cs(t,typeof s!="symbol"?s+"":s,r);import{r as x,a as zt,u as tt,b as Ut,L as de,c as Ds,d as Os,B as Rs,e as Is,f as je,R as Ps}from"./vendor-C1y34kgY.js";import{c as ne}from"./zustand-DNIvzKHV.js";import{p as Ms,a as Ee}from"./protobuf-NWeOYLG2.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var qt={exports:{}},Be={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fs=x,Ls=Symbol.for("react.element"),_s=Symbol.for("react.fragment"),As=Object.prototype.hasOwnProperty,$s=Fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Bs={key:!0,ref:!0,__self:!0,__source:!0};function Yt(t,s,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(n in s)As.call(s,n)&&!Bs.hasOwnProperty(n)&&(a[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:Ls,type:t,key:i,ref:o,props:a,_owner:$s.current}}Be.Fragment=_s;Be.jsx=Yt;Be.jsxs=Yt;qt.exports=Be;var e=qt.exports,Ke={},pt=zt;Ke.createRoot=pt.createRoot,Ke.hydrateRoot=pt.hydrateRoot;const Fe=ne(t=>({isServerOnline:!0,isRealtimeConnected:!1,isInDeviceDetail:!1,setServerOnline:s=>t({isServerOnline:s}),setRealtimeConnected:s=>t({isRealtimeConnected:s}),setInDeviceDetail:s=>t({isInDeviceDetail:s}),get isConnected(){return!1},setConnected:s=>t({isRealtimeConnected:s})}));let Se=null;function Hs(){if(Se)return;const t=async()=>{try{const s=await fetch("/api/health",{headers:{Accept:"application/json"}});Fe.getState().setServerOnline(s.ok)}catch{Fe.getState().setServerOnline(!1)}};t(),Se=setInterval(t,1e4)}function Ws(){Se&&(clearInterval(Se),Se=null)}const B="/api";async function U(t,s){const r=await fetch(t,{headers:{"Content-Type":"application/json",Accept:"application/json",...s==null?void 0:s.headers},...s});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()}const De={get:t=>U(t),post:(t,s)=>U(t,{method:"POST",body:s!==void 0?JSON.stringify(s):void 0}),put:(t,s)=>U(t,{method:"PUT",body:s!==void 0?JSON.stringify(s):void 0}),delete:t=>U(t,{method:"DELETE"})};async function zs(){return U(`${B}/devices`)}async function Us(t){return U(`${B}/devices/${t}`)}async function qs(t,s,r){await fetch(`${B}/devices/${t}/control/toggle-capture`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({network:s,log:r})})}async function Ys(t){await fetch(`${B}/devices/${t}/data`,{method:"DELETE"})}async function Vs(t,s={}){const r=new URLSearchParams;s.page&&r.set("page",String(s.page)),s.pageSize&&r.set("pageSize",String(s.pageSize)),s.method&&r.set("method",s.method),s.statusCode&&r.set("statusCode",String(s.statusCode)),s.urlContains&&r.set("urlContains",s.urlContains),s.isMocked!==void 0&&r.set("isMocked",String(s.isMocked)),s.timeFrom&&r.set("timeFrom",s.timeFrom),s.timeTo&&r.set("timeTo",s.timeTo);const n=r.toString();return U(`${B}/devices/${t}/http${n?`?${n}`:""}`)}async function Gs(t,s){return U(`${B}/devices/${t}/http/${s}`)}async function Js(t,s){return U(`${B}/devices/${t}/http/${s}/curl`)}async function Qs(t,s){return U(`${B}/devices/${t}/http/${s}/replay`,{method:"POST"})}async function Ks(t,s){return U(`${B}/devices/${t}/http/${s}/favorite`,{method:"POST"})}async function Xs(t,s){return U(`${B}/devices/${t}/http/batch/delete`,{method:"POST",body:JSON.stringify({ids:s})})}async function Zs(t,s,r){return U(`${B}/devices/${t}/http/batch/favorite`,{method:"POST",body:JSON.stringify({ids:s,isFavorite:r})})}async function er(){await fetch(`${B}/cleanup/truncate`,{method:"POST"})}async function tr(t,s={}){var a;const r=new URLSearchParams;s.page&&r.set("page",String(s.page)),s.pageSize&&r.set("pageSize",String(s.pageSize)),s.level&&r.set("level",s.level),(a=s.levels)!=null&&a.length&&r.set("levels",s.levels.join(",")),s.subsystem&&r.set("subsystem",s.subsystem),s.category&&r.set("category",s.category),s.loggerName&&r.set("loggerName",s.loggerName),s.text&&r.set("text",s.text),s.traceId&&r.set("traceId",s.traceId),s.timeFrom&&r.set("timeFrom",s.timeFrom),s.timeTo&&r.set("timeTo",s.timeTo);const n=r.toString();return U(`${B}/devices/${t}/logs${n?`?${n}`:""}`)}async function sr(t){return U(`${B}/devices/${t}/logs/subsystems`)}async function rr(t){return U(`${B}/devices/${t}/logs/categories`)}async function nr(t,s={}){const r=new URLSearchParams;s.page&&r.set("page",String(s.page)),s.pageSize&&r.set("pageSize",String(s.pageSize)),s.urlContains&&r.set("urlContains",s.urlContains),s.host&&r.set("host",s.host),s.isOpen!==void 0&&r.set("isOpen",String(s.isOpen)),s.timeFrom&&r.set("timeFrom",s.timeFrom),s.timeTo&&r.set("timeTo",s.timeTo);const n=r.toString();return U(`${B}/devices/${t}/ws-sessions${n?`?${n}`:""}`)}async function Vt(t,s){return U(`${B}/devices/${t}/ws-sessions/${s}`)}async function ft(t,s,r={}){const n=new URLSearchParams;r.page&&n.set("page",String(r.page)),r.pageSize&&n.set("pageSize",String(r.pageSize)),r.direction&&n.set("direction",r.direction);const a=n.toString();return U(`${B}/devices/${t}/ws-sessions/${s}/frames${a?`?${a}`:""}`)}async function ar(t,s,r){return U(`${B}/devices/${t}/ws-sessions/${s}/frames/${r}`)}async function ir(t,s){return U(`${B}/devices/${t}/ws-sessions/batch/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:s})})}async function or(t){return U(`${B}/devices/${t}/mock-rules`)}async function lr(t,s){return U(`${B}/devices/${t}/mock-rules`,{method:"POST",body:JSON.stringify(s)})}async function gt(t,s,r){return U(`${B}/devices/${t}/mock-rules/${s}`,{method:"PUT",body:JSON.stringify(r)})}async function cr(t,s){await fetch(`${B}/devices/${t}/mock-rules/${s}`,{method:"DELETE"})}function dr(t,s="json"){return`${B}/devices/${t}/export/logs?format=${s}`}function ur(t,s="json"){return`${B}/devices/${t}/export/http?format=${s}`}function mr(t,s){const r=new URLSearchParams;s&&s.length>0&&r.set("ids",s.join(","));const n=r.toString();return`${B}/devices/${t}/export/har${n?`?${n}`:""}`}async function xr(t){return U(`${B}/devices/${t}/breakpoints`)}async function hr(t,s){return U(`${B}/devices/${t}/breakpoints`,{method:"POST",body:JSON.stringify(s)})}async function bt(t,s,r){return U(`${B}/devices/${t}/breakpoints/${s}`,{method:"PUT",body:JSON.stringify(r)})}async function pr(t,s){await fetch(`${B}/devices/${t}/breakpoints/${s}`,{method:"DELETE"})}async function Gt(t){return U(`${B}/devices/${t}/breakpoints/pending`)}async function Jt(t,s,r){await fetch(`${B}/devices/${t}/breakpoints/resume/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}async function fr(t){return U(`${B}/devices/${t}/chaos`)}async function gr(t,s){return U(`${B}/devices/${t}/chaos`,{method:"POST",body:JSON.stringify(s)})}async function yt(t,s,r){return U(`${B}/devices/${t}/chaos/${s}`,{method:"PUT",body:JSON.stringify(r)})}async function br(t,s){await fetch(`${B}/devices/${t}/chaos/${s}`,{method:"DELETE"})}async function yr(t){return U(`${B}/devices/${t}/databases`)}async function vr(t,s){return U(`${B}/devices/${t}/databases/${s}/tables`)}async function jr(t,s,r){return U(`${B}/devices/${t}/databases/${s}/tables/${r}/schema`)}async function Ue(t,s,r,n){const a=new URLSearchParams;n!=null&&n.page&&a.set("page",n.page.toString()),n!=null&&n.pageSize&&a.set("pageSize",n.pageSize.toString()),n!=null&&n.orderBy&&a.set("orderBy",n.orderBy),(n==null?void 0:n.ascending)!==void 0&&a.set("ascending",n.ascending.toString());const i=a.toString(),o=`${B}/devices/${t}/databases/${s}/tables/${r}/rows${i?"?"+i:""}`;return U(o)}async function Nr(t,s,r){return U(`${B}/devices/${t}/databases/${s}/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r})})}const st=ne((t,s)=>({rules:[],deviceRules:[],isLoading:!1,fetchRules:async()=>{t({isLoading:!0});try{const r=await De.get("/api/traffic-rules");t({rules:r})}catch(r){console.error("Failed to fetch traffic rules",r)}finally{t({isLoading:!1})}},fetchDeviceRules:async r=>{t({isLoading:!0});try{const n=await De.get(`/api/devices/${r}/traffic-rules`);t({deviceRules:n})}catch(n){console.error("Failed to fetch device traffic rules",n)}finally{t({isLoading:!1})}},createOrUpdateRule:async r=>{try{const n=await De.post("/api/traffic-rules",r);t(a=>{let i=a.rules;a.rules.some(l=>l.id===n.id)?i=a.rules.map(l=>l.id===n.id?n:l):i=[n,...a.rules];let o=a.deviceRules;return a.deviceRules.some(l=>l.id===n.id)?o=a.deviceRules.map(l=>l.id===n.id?n:l):(n.deviceId===null||r.deviceId&&a.deviceRules.some(l=>l.deviceId===r.deviceId))&&(o=[n,...a.deviceRules]),{rules:i,deviceRules:o}})}catch(n){throw console.error("Failed to save traffic rule",n),n}},deleteRule:async r=>{try{await De.delete(`/api/traffic-rules/${r}`),t(n=>({rules:n.rules.filter(a=>a.id!==r),deviceRules:n.deviceRules.filter(a=>a.id!==r)}))}catch(n){throw console.error("Failed to delete traffic rule",n),n}},getDomainRule:(r,n)=>{const{deviceRules:a,rules:i}=s();return(n?a:i).find(l=>l.isEnabled&&l.matchType==="domain"&&l.matchValue===r&&(n?l.deviceId===n||l.deviceId===null:!0))},matchRule:(r,n)=>{const{deviceRules:a,rules:i}=s();return(n?a:i).find(l=>{if(!l.isEnabled)return!1;if(l.matchType==="domain")try{return new URL(r.url).hostname===l.matchValue}catch{return!1}if(l.matchType==="urlRegex")try{return new RegExp(l.matchValue).test(r.url)}catch{return!1}return l.matchType==="header",!1})}}));function rt(t){return t.type==="session-divider"}function xe(t,s){return t.filter(r=>{if(rt(r))return!1;const n=r;if(s.method&&n.method!==s.method)return!1;if(s.statusRange&&n.statusCode){const[a,i]=s.statusRange.split("-").map(Number);if(n.statusCode<a||n.statusCode>i)return!1}if(s.urlContains&&!n.url.toLowerCase().includes(s.urlContains.toLowerCase())||s.mockedOnly&&!n.isMocked||s.favoritesOnly&&!n.isFavorite)return!1;if(s.domains&&s.domains.length>0)try{const a=new URL(n.url);if(!s.domains.includes(a.hostname))return!1}catch{return!1}if(!s.showBlacklisted){const a=st.getState().matchRule(n);if(a&&a.action==="hide")return!1}return!0})}const nt=ne((t,s)=>({events:[],listItems:[],filteredItems:[],selectedEventId:null,selectedEvent:null,total:0,page:1,pageSize:100,isLoading:!1,autoScroll:!0,selectedIds:new Set,isSelectMode:!1,currentSessionId:null,groupMode:"none",filters:{method:"",statusRange:"",urlContains:"",mockedOnly:!1,favoritesOnly:!1,domains:[],showBlacklisted:!1},fetchEvents:async r=>{const{pageSize:n,filters:a}=s();t({isLoading:!0});try{const i=await Vs(r,{pageSize:n,method:a.method||void 0,urlContains:a.urlContains||void 0,isMocked:a.mockedOnly?!0:void 0});let o=i.items;a.favoritesOnly&&(o=o.filter(c=>c.isFavorite));const l=xe(o,a);t({events:o,listItems:o,filteredItems:l,total:i.total,page:i.page,isLoading:!1}),s().fetchSessionHistory(r)}catch(i){console.error("Failed to fetch HTTP events:",i),t({isLoading:!1})}},fetchSessionHistory:async r=>{},selectEvent:async(r,n)=>{t({selectedEventId:n});try{const a=await Gs(r,n);t({selectedEvent:a})}catch(a){console.error("Failed to fetch HTTP event detail:",a)}},clearSelection:()=>{t({selectedEventId:null,selectedEvent:null})},addRealtimeEvent:r=>{t(n=>{const a=[r,...n.events].slice(0,1e3),i=[r,...n.listItems].slice(0,1e3),o=xe(i,n.filters);return{events:a,listItems:i,filteredItems:o,total:n.total+1}})},clearEvents:()=>{t({events:[],listItems:[],filteredItems:[],total:0,selectedEventId:null,selectedEvent:null,selectedIds:new Set,currentSessionId:null})},addSessionDivider:(r,n)=>{},setFilter:(r,n)=>{t(a=>{const i={...a.filters,[r]:n},o=xe(a.listItems,i);return{filters:i,filteredItems:o}})},toggleDomain:r=>{t(n=>{const a=n.filters.domains,i=a.includes(r)?a.filter(c=>c!==r):[...a,r],o={...n.filters,domains:i},l=xe(n.listItems,o);return{filters:o,filteredItems:l}})},clearDomains:()=>{t(r=>{const n={...r.filters,domains:[]},a=xe(r.listItems,n);return{filters:n,filteredItems:a}})},applyFilters:()=>{t(r=>({filteredItems:xe(r.listItems,r.filters)}))},setAutoScroll:r=>{t({autoScroll:r})},setGroupMode:r=>{t({groupMode:r})},updateEventFavorite:(r,n)=>{t(a=>{var c;const i=a.events.map(d=>d.id===r?{...d,isFavorite:n}:d),o=a.listItems.map(d=>!rt(d)&&d.id===r?{...d,isFavorite:n}:d),l=xe(o,a.filters);return{events:i,listItems:o,filteredItems:l,selectedEvent:((c=a.selectedEvent)==null?void 0:c.id)===r?{...a.selectedEvent,isFavorite:n}:a.selectedEvent}})},toggleSelectMode:()=>{t(r=>({isSelectMode:!r.isSelectMode,selectedIds:r.isSelectMode?new Set:r.selectedIds}))},toggleSelectId:r=>{t(n=>{const a=new Set(n.selectedIds);return a.has(r)?a.delete(r):a.add(r),{selectedIds:a}})},selectAll:()=>{t(r=>{const n=new Set(r.events.map(i=>i.id));return{selectedIds:r.selectedIds.size===r.events.length?new Set:n}})},clearSelectedIds:()=>{t({selectedIds:new Set})},batchDelete:async r=>{const{selectedIds:n,events:a}=s();if(n.size!==0)try{await Xs(r,Array.from(n)),t({events:a.filter(i=>!n.has(i.id)),selectedIds:new Set,total:s().total-n.size})}catch(i){console.error("Failed to batch delete:",i)}},batchFavorite:async(r,n)=>{const{selectedIds:a,events:i}=s();if(a.size!==0)try{await Zs(r,Array.from(a),n),t({events:i.map(o=>a.has(o.id)?{...o,isFavorite:n}:o),selectedIds:new Set})}catch(o){console.error("Failed to batch favorite:",o)}}})),Xe={verbose:0,debug:1,info:2,warning:3,error:4};function wr(t){const s={};if(!t.trim())return s;const r=[{field:"level",pattern:/level:(>=)?(\w+)/gi},{field:"subsystem",pattern:/subsystem:("([^"]+)"|(\S+))/gi},{field:"category",pattern:/category:("([^"]+)"|(\S+))/gi},{field:"message",pattern:/message:("([^"]+)"|(\S+))/gi},{field:"traceId",pattern:/traceId:(\S+)/gi},{field:"file",pattern:/file:("([^"]+)"|(\S+))/gi},{field:"function",pattern:/function:("([^"]+)"|(\S+))/gi},{field:"timestampFrom",pattern:/timestamp:>(\S+)/gi},{field:"timestampTo",pattern:/timestamp:<(\S+)/gi}];let n=t;for(const{field:i,pattern:o}of r){let l;for(;(l=o.exec(t))!==null;)switch(n=n.replace(l[0],""),i){case"level":{const c=l[1]===">=",d=l[2].toLowerCase();Xe[d]!==void 0&&(c?s.minLevel=d:s.level=d);break}case"subsystem":s.subsystem=l[2]||l[3];break;case"category":s.category=l[2]||l[3];break;case"message":{const c=l[2]||l[3];s.message=c;try{s.messageRegex=new RegExp(c,"i")}catch{}break}case"traceId":s.traceId=l[1];break;case"file":s.file=l[2]||l[3];break;case"function":s.function=l[2]||l[3];break;case"timestampFrom":{const c=new Date(l[1]);isNaN(c.getTime())||(s.timestampFrom=c);break}case"timestampTo":{const c=new Date(l[1]);isNaN(c.getTime())||(s.timestampTo=c);break}}}const a=n.trim();return a&&(s.freeText=a),s}function kr(t,s,r="verbose"){const n=s.minLevel||s.level||r,a=Xe[n];return t.filter(i=>{var l,c,d,u;const o=Xe[i.level]??0;if(s.level&&i.level!==s.level||o<a||s.subsystem&&i.subsystem!==s.subsystem||s.category&&i.category!==s.category)return!1;if(s.message){if(s.messageRegex){if(!s.messageRegex.test(i.message))return!1}else if(!i.message.toLowerCase().includes(s.message.toLowerCase()))return!1}if(s.traceId&&i.traceId!==s.traceId||s.file&&i.file&&!i.file.toLowerCase().includes(s.file.toLowerCase())||s.function&&i.function&&!i.function.toLowerCase().includes(s.function.toLowerCase()))return!1;if(s.timestampFrom||s.timestampTo){const h=new Date(i.timestamp);if(s.timestampFrom&&h<s.timestampFrom||s.timestampTo&&h>s.timestampTo)return!1}if(s.freeText){const h=s.freeText.toLowerCase(),j=i.message.toLowerCase().includes(h),C=(l=i.subsystem)==null?void 0:l.toLowerCase().includes(h),p=(c=i.category)==null?void 0:c.toLowerCase().includes(h),b=(d=i.file)==null?void 0:d.toLowerCase().includes(h),D=(u=i.function)==null?void 0:u.toLowerCase().includes(h);if(!j&&!C&&!p&&!b&&!D)return!1}return!0})}const Sr=`
æ”¯æŒçš„æœç´¢è¯­æ³•:
â€¢ level:error - ç²¾ç¡®åŒ¹é…çº§åˆ«
â€¢ level:>=warning - æ˜¾ç¤º warning åŠä»¥ä¸Šçº§åˆ«
â€¢ subsystem:Network - åŒ¹é… subsystem
â€¢ category:API - åŒ¹é… category
â€¢ message:"error message" - æœç´¢æ¶ˆæ¯å†…å®¹
â€¢ traceId:xxx - åŒ¹é… traceId
â€¢ file:ViewController - åŒ¹é…æ–‡ä»¶å
â€¢ function:viewDidLoad - åŒ¹é…å‡½æ•°å
â€¢ timestamp:>2025-12-05T10:00:00 - æ—¶é—´èŒƒå›´
â€¢ ç›´æŽ¥è¾“å…¥æ–‡æœ¬æœç´¢æ¶ˆæ¯å†…å®¹
`.trim(),vt={verbose:0,debug:1,info:2,warning:3,error:4};function Er(t,s){const r=vt[s.minLevel];return t.filter(n=>!((vt[n.level]??0)<r||s.subsystem&&n.subsystem!==s.subsystem||s.category&&n.category!==s.category||s.text&&!s.searchQuery&&!n.message.toLowerCase().includes(s.text.toLowerCase())||s.traceId&&n.traceId!==s.traceId))}function fe(t,s){let r=Er(t,s);if(s.searchQuery){const n=wr(s.searchQuery);r=kr(r,n,s.minLevel)}return r}const Qt=ne((t,s)=>({events:[],filteredEvents:[],total:0,page:1,pageSize:500,isLoading:!1,autoScroll:!0,subsystems:[],categories:[],filters:{minLevel:"verbose",subsystem:"",category:"",text:"",traceId:"",searchQuery:""},fetchEvents:async r=>{const{pageSize:n}=s();t({isLoading:!0});try{const a=await tr(r,{pageSize:n}),{filters:i}=s(),o=fe(a.items,i);t({events:a.items,filteredEvents:o,total:a.total,page:a.page,isLoading:!1})}catch(a){console.error("Failed to fetch log events:",a),t({isLoading:!1})}},fetchFilterOptions:async r=>{try{const[n,a]=await Promise.all([sr(r),rr(r)]);t({subsystems:n,categories:a})}catch(n){console.error("Failed to fetch filter options:",n)}},addRealtimeEvent:r=>{t(n=>{const a=[r,...n.events].slice(0,5e3),i=fe(a,n.filters);return{events:a,filteredEvents:i,total:n.total+1}})},clearEvents:()=>{t({events:[],filteredEvents:[],total:0})},setFilter:(r,n)=>{t(a=>{const i={...a.filters,[r]:n},o=fe(a.events,i);return{filters:i,filteredEvents:o}})},setMinLevel:r=>{t(n=>{const a={...n.filters,minLevel:r},i=fe(n.events,a);return{filters:a,filteredEvents:i}})},setSearchQuery:r=>{t(n=>{const a={...n.filters,searchQuery:r},i=fe(n.events,a);return{filters:a,filteredEvents:i}})},applyFilters:()=>{t(r=>({filteredEvents:fe(r.events,r.filters)}))},setAutoScroll:r=>{t({autoScroll:r})}})),Kt="debug-hub-favorite-devices",Tr=()=>{try{const t=localStorage.getItem(Kt);if(t)return new Set(JSON.parse(t))}catch(t){console.error("Failed to load favorite devices:",t)}return new Set},Cr=t=>{try{localStorage.setItem(Kt,JSON.stringify([...t]))}catch(s){console.error("Failed to save favorite devices:",s)}},He=ne((t,s)=>({devices:[],currentDeviceId:null,currentDevice:null,isLoading:!1,error:null,favoriteDeviceIds:Tr(),fetchDevices:async()=>{t({isLoading:!0,error:null});try{const r=await zs();t({devices:r,isLoading:!1})}catch(r){t({error:r.message,isLoading:!1})}},selectDevice:async r=>{t({currentDeviceId:r,isLoading:!0,error:null});try{const n=await Us(r);t({currentDevice:n,isLoading:!1})}catch(n){t({error:n.message,isLoading:!1})}},clearSelection:()=>{t({currentDeviceId:null,currentDevice:null})},toggleCapture:async(r,n)=>{const{currentDeviceId:a}=s();if(a)try{await qs(a,r,n)}catch(i){t({error:i.message})}},clearDeviceData:async()=>{const{currentDeviceId:r}=s();if(r)try{await Ys(r),nt.getState().clearEvents(),Qt.getState().clearEvents()}catch(n){t({error:n.message})}},toggleFavorite:r=>{const{favoriteDeviceIds:n}=s(),a=new Set(n);a.has(r)?a.delete(r):a.add(r),Cr(a),t({favoriteDeviceIds:a})},isFavorite:r=>s().favoriteDeviceIds.has(r)})),Xt=ne((t,s)=>({sessions:[],totalSessions:0,sessionsLoading:!1,sessionsError:null,selectedSessionId:null,selectedSession:null,sessionLoading:!1,frames:[],totalFrames:0,framesLoading:!1,framesError:null,filters:{page:1,pageSize:50},framePage:1,framePageSize:100,frameDirection:"",autoScroll:!0,isSelectMode:!1,selectedIds:new Set,fetchSessions:async r=>{t({sessionsLoading:!0,sessionsError:null});try{const n=await nr(r,s().filters);t({sessions:n.items,totalSessions:n.total,sessionsLoading:!1})}catch(n){console.error("[wsStore] fetchSessions error:",n),t({sessionsLoading:!1,sessionsError:n instanceof Error?n.message:"åŠ è½½å¤±è´¥"})}},selectSession:async(r,n)=>{t({selectedSessionId:n,sessionLoading:!0,frames:[],totalFrames:0});try{const[a]=await Promise.all([Vt(r,n),s().fetchFrames(r,n)]);t({selectedSession:a,sessionLoading:!1})}catch{t({sessionLoading:!1})}},fetchFrames:async(r,n)=>{t({framesLoading:!0,framesError:null,framePage:1});try{const a=await ft(r,n,{page:1,pageSize:s().framePageSize,direction:s().frameDirection||void 0});t({frames:a.items,totalFrames:a.total,framesLoading:!1})}catch(a){t({framesLoading:!1,framesError:a instanceof Error?a.message:"åŠ è½½å¤±è´¥"})}},loadMoreFrames:async(r,n)=>{const{framePage:a,framePageSize:i,frames:o,totalFrames:l}=s();if(!(o.length>=l)){t({framesLoading:!0});try{const c=await ft(r,n,{page:a+1,pageSize:i,direction:s().frameDirection||void 0});t({frames:[...o,...c.items],framePage:a+1,framesLoading:!1})}catch{t({framesLoading:!1})}}},setFilter:(r,n)=>{t(a=>({filters:{...a.filters,[r]:n}}))},setFrameDirection:r=>{t({frameDirection:r})},clearSelection:()=>{t({selectedSessionId:null,selectedSession:null,frames:[],totalFrames:0})},clearSessions:()=>{t({sessions:[],totalSessions:0,selectedSessionId:null,selectedSession:null,frames:[],totalFrames:0})},setAutoScroll:r=>{t({autoScroll:r})},addRealtimeSession:r=>{t(n=>n.sessions.some(a=>a.id===r.id)?n:{sessions:[r,...n.sessions],totalSessions:n.totalSessions+1})},updateSessionStatus:(r,n,a,i)=>{t(o=>{var l;return{sessions:o.sessions.map(c=>c.id===r?{...c,isOpen:n,closeCode:a??c.closeCode,closeReason:i??c.closeReason}:c),selectedSession:((l=o.selectedSession)==null?void 0:l.id)===r?{...o.selectedSession,closeCode:a??null,closeReason:i??null}:o.selectedSession}})},updateSessionUrl:(r,n)=>{t(a=>({sessions:a.sessions.map(i=>i.id===r?{...i,url:n}:i)}))},addRealtimeFrame:r=>{const{selectedSessionId:n}=s();r.sessionId===n&&t(a=>({frames:[...a.frames,r],totalFrames:a.totalFrames+1}))},toggleSelectMode:()=>{t(r=>({isSelectMode:!r.isSelectMode,selectedIds:r.isSelectMode?new Set:r.selectedIds}))},toggleSelectId:r=>{t(n=>{const a=new Set(n.selectedIds);return a.has(r)?a.delete(r):a.add(r),{selectedIds:a}})},selectAll:()=>{t(r=>{const n=new Set(r.sessions.map(i=>i.id));return{selectedIds:r.selectedIds.size===r.sessions.length?new Set:n}})},clearSelectedIds:()=>{t({selectedIds:new Set})},batchDelete:async r=>{const{selectedIds:n,sessions:a}=s();if(n.size!==0)try{await ir(r,Array.from(n)),t({sessions:a.filter(i=>!n.has(i.id)),selectedIds:new Set,totalSessions:s().totalSessions-n.size,selectedSessionId:n.has(s().selectedSessionId??"")?null:s().selectedSessionId,selectedSession:n.has(s().selectedSessionId??"")?null:s().selectedSession})}catch(i){console.error("Failed to batch delete WS sessions:",i)}}}));function Zt(t){var s,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(s=0;s<a;s++)t[s]&&(r=Zt(t[s]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function y(){for(var t,s,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(s=Zt(t))&&(n&&(n+=" "),n+=s);return n}function Dr(){const t=tt(),s=Ut(),{isServerOnline:r}=Fe(),{devices:n,fetchDevices:a,currentDeviceId:i,selectDevice:o,favoriteDeviceIds:l,toggleFavorite:c}=He(),{events:d,toggleDomain:u,clearDomains:h,filters:j}=nt(),{sessions:C,setFilter:p,filters:b}=Xt(),{getDomainRule:D,createOrUpdateRule:k,deleteRule:w}=st(),[g,F]=x.useState(!1),E=x.useMemo(()=>new URLSearchParams(s.search).get("tab")||"http",[s.search]),[$,q]=x.useState(""),[G,Y]=x.useState(new Set),_=x.useRef({});x.useEffect(()=>{a()},[]);const z=x.useMemo(()=>{if(E==="websocket"){const O={};return C.forEach(W=>{try{const L=new URL(W.url).hostname;O[L]=(O[L]||0)+1}catch{}}),Object.entries(O).map(([W,A])=>({domain:W,count:A})).sort((W,A)=>A.count-W.count)}else{const O={};return d.forEach(W=>{try{const A=new URL(W.url).hostname;O[A]=(O[A]||0)+1}catch{}}),Object.entries(O).map(([W,A])=>({domain:W,count:A})).sort((W,A)=>A.count-W.count)}},[d,C,E]),Q=x.useRef(E);x.useEffect(()=>{if(Q.current!==E){Q.current=E;const A={};z.forEach(({domain:L,count:X})=>{A[L]=X}),_.current=A;return}const O={};z.forEach(({domain:A,count:L})=>{O[A]=L});const W=new Set;for(const[A,L]of Object.entries(O)){const X=_.current[A]||0;L>X&&W.add(A)}W.size>0&&(Y(A=>new Set([...A,...W])),setTimeout(()=>{Y(A=>{const L=new Set(A);return W.forEach(X=>L.delete(X)),L})},1500)),_.current=O},[z,E]);const I=x.useMemo(()=>{if(!$.trim())return z;const O=$.toLowerCase();return z.filter(({domain:W})=>W.toLowerCase().includes(O))},[z,$]),T=x.useMemo(()=>g?n:n.filter(O=>O.deviceId===i||l.has(O.deviceId)),[n,i,l,g]),m=n.length-T.length,N=O=>{o(O),t(`/device/${O}`)},f=(O,W)=>{O.stopPropagation(),c(W)},S=O=>{E==="websocket"?b.host===O?p("host",""):p("host",O):u(O)},v=()=>{E==="websocket"?p("host",""):h()},P=O=>E==="websocket"?b.host===O:j.domains.includes(O),H=()=>E==="websocket"?!b.host:j.domains.length===0,K=async(O,W)=>{O.stopPropagation();const A=D(W);A?A.action==="highlight"?await k({...A,action:"hide"}):A.id&&await w(A.id):await k({name:W,matchType:"domain",matchValue:W,action:"highlight",isEnabled:!0,priority:0})};return e.jsxs("aside",{className:"w-72 bg-bg-dark border-r border-border flex flex-col h-full",children:[e.jsxs("div",{className:"p-5 border-b border-border flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:"ðŸ”"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-text-primary text-lg",children:"Debug Hub"}),e.jsx("p",{className:"text-2xs text-text-muted",children:"Network Inspector"})]})]}),e.jsx(de,{to:"/rules",className:"text-xs text-text-muted hover:text-primary transition-colors px-2 py-1 rounded hover:bg-bg-light",title:"ç®¡ç†æµé‡è§„åˆ™",children:"Rules"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"px-3 py-4",children:[e.jsxs("div",{className:"px-2 mb-3 text-xs font-semibold text-text-secondary uppercase tracking-wider flex justify-between items-center",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"ðŸ“±"}),"Devices"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[m>0&&!g&&e.jsxs("button",{onClick:()=>F(!0),className:"text-2xs text-text-muted hover:text-primary transition-colors",title:"æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡",children:["+",m," æ›´å¤š"]}),g&&e.jsx("button",{onClick:()=>F(!1),className:"text-2xs text-text-muted hover:text-primary transition-colors",title:"åªæ˜¾ç¤ºæ”¶è—è®¾å¤‡",children:"æ”¶èµ·"}),e.jsx("span",{className:"bg-primary/10 text-primary px-2 py-0.5 rounded-full text-2xs font-bold",children:n.length})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[T.map(O=>{const W=l.has(O.deviceId);return e.jsxs("div",{onClick:()=>N(O.deviceId),className:y("group flex items-center gap-3 px-3 py-3 rounded-lg cursor-pointer transition-colors",i===O.deviceId?"bg-primary text-bg-darkest":"text-text-secondary hover:bg-bg-light hover:text-text-primary"),children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:y("w-10 h-10 rounded-lg flex items-center justify-center",i===O.deviceId?"bg-bg-darkest/20":"bg-bg-medium"),children:e.jsx("span",{className:"text-xl",children:"ðŸ“±"})}),O.isOnline&&e.jsx("span",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-bg-dark rounded-full"})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate text-sm",children:O.deviceName}),e.jsxs("div",{className:"text-2xs text-text-muted truncate mt-0.5",children:[O.appName," ",e.jsxs("span",{className:"opacity-60",children:[O.appVersion," (",O.buildNumber,")"]})]}),e.jsxs("div",{className:"text-2xs text-text-muted truncate mt-0.5",children:[O.platform," ",e.jsx("span",{className:"opacity-60",children:O.systemVersion})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:A=>f(A,O.deviceId),className:y("p-1.5 rounded transition-all",W?"text-yellow-400 hover:text-yellow-300":"text-text-muted opacity-0 group-hover:opacity-100 hover:text-yellow-400"),title:W?"å–æ¶ˆæ”¶è—":"æ”¶è—è®¾å¤‡",children:W?"â­":"â˜†"}),e.jsx("span",{className:"text-text-muted opacity-0 group-hover:opacity-100 transition-opacity text-sm",children:"â†’"})]})]},O.deviceId)}),T.length===0&&n.length>0&&e.jsx("div",{className:"px-4 py-4 text-center text-xs text-text-muted",children:e.jsxs("button",{onClick:()=>F(!0),className:"text-primary hover:underline",children:["æ˜¾ç¤ºå…¨éƒ¨ ",n.length," ä¸ªè®¾å¤‡"]})}),n.length===0&&!r&&e.jsxs("div",{className:"px-4 py-6 text-center text-xs text-text-muted bg-bg-light/20 rounded-lg border border-dashed border-border",children:[e.jsx("span",{className:"text-2xl block mb-2 opacity-50",children:"ðŸ“¡"}),"ç­‰å¾…æœåŠ¡è¿žæŽ¥..."]})]})]}),i&&(E==="http"||E==="websocket")&&e.jsx("div",{className:"divider mx-5 my-2"}),i&&(E==="http"||E==="websocket")&&e.jsxs("div",{className:"px-3 py-3",children:[e.jsxs("div",{className:"px-2 mb-3 text-xs font-semibold text-text-secondary uppercase tracking-wider flex justify-between items-center",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:E==="websocket"?"ðŸ”Œ":"ðŸŒ"}),E==="websocket"?"WS Hosts":"Domains"]}),e.jsx("span",{className:"bg-accent-blue/10 text-accent-blue px-2 py-0.5 rounded-full text-2xs font-bold",children:z.length})]}),e.jsx("div",{className:"px-1 mb-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted text-xs",children:"ðŸ”"}),e.jsx("input",{type:"text",value:$,onChange:O=>q(O.target.value),placeholder:E==="websocket"?"æœç´¢ä¸»æœº...":"æœç´¢åŸŸå...",className:"w-full pl-8 pr-3 py-2 text-xs bg-bg-medium border border-border rounded text-text-primary placeholder:text-text-muted focus:outline-none focus:border-primary transition-colors"})]})}),e.jsxs("div",{className:"space-y-0.5 max-h-[400px] overflow-y-auto pr-1",children:[e.jsxs("div",{onClick:v,className:y("flex items-center justify-between px-3 py-2 rounded cursor-pointer text-xs transition-colors group",H()?"bg-primary text-bg-darkest font-medium":"text-text-secondary hover:bg-bg-light"),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-sm",children:"ðŸ“‹"}),e.jsx("span",{className:"font-medium",children:E==="websocket"?"å…¨éƒ¨ä¸»æœº":"å…¨éƒ¨åŸŸå"})]}),e.jsx("span",{className:y("font-mono text-2xs px-1.5 py-0.5 rounded",H()?"text-bg-darkest font-bold bg-bg-darkest/20":"opacity-60 bg-bg-medium"),children:z.reduce((O,{count:W})=>O+W,0)})]}),z.length>0&&e.jsx("div",{className:"border-t border-border-subtle my-1"}),I.map(({domain:O,count:W})=>{const A=D(O),L=(A==null?void 0:A.action)==="highlight",X=(A==null?void 0:A.action)==="hide",ae=P(O),M=G.has(O);return e.jsxs("div",{onClick:()=>S(O),className:y("flex items-center justify-between px-3 py-2 rounded cursor-pointer text-xs transition-colors group",ae?"bg-accent-blue text-white font-medium":"text-text-secondary hover:bg-bg-light",M&&"animate-domain-highlight"),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[E==="http"&&e.jsx("input",{type:"checkbox",checked:ae,onChange:()=>S(O),onClick:Z=>Z.stopPropagation(),className:"w-4 h-4 min-w-4 min-h-4 flex-shrink-0 rounded border-border cursor-pointer accent-primary"}),L&&e.jsx("span",{className:"text-yellow-500 text-xs",title:"Highlighted",children:"â˜…"}),X&&e.jsx("span",{className:"text-red-400 text-xs",title:"Hidden",children:"â›”"}),e.jsx("span",{className:y("truncate font-mono",X&&"opacity-50 line-through"),children:O})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:y("font-mono text-2xs px-1.5 py-0.5 rounded",M?"text-primary font-bold bg-primary/10":"opacity-60 bg-bg-medium"),children:W}),e.jsx("button",{onClick:Z=>K(Z,O),className:"opacity-0 group-hover:opacity-100 p-1.5 hover:bg-bg-medium rounded transition-colors text-text-muted hover:text-text-primary",title:"Toggle Rule (None -> Highlight -> Hide)",children:"â‹®"})]})]},O)}),I.length===0&&$&&e.jsxs("div",{className:"px-4 py-4 text-center text-xs text-text-muted bg-bg-light/20 rounded border border-dashed border-border",children:[e.jsx("span",{className:"text-lg block mb-1 opacity-50",children:"ðŸ”"}),E==="websocket"?"æœªæ‰¾åˆ°åŒ¹é…çš„ä¸»æœº":"æœªæ‰¾åˆ°åŒ¹é…çš„åŸŸå"]}),z.length===0&&!$&&e.jsxs("div",{className:"px-4 py-4 text-center text-xs text-text-muted bg-bg-light/20 rounded border border-dashed border-border",children:[e.jsx("span",{className:"text-lg block mb-1 opacity-50",children:E==="websocket"?"ðŸ”Œ":"ðŸŒ"}),E==="websocket"?"æš‚æ—  WebSocket ä¸»æœº":"æš‚æ— åŸŸåè®°å½•"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-bg-darker border-t border-border text-xs text-text-muted flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:y("w-2 h-2 rounded-full",r?"bg-green-500":"bg-red-500")}),e.jsx("span",{className:"font-medium",children:r?"Online":"Offline"})]}),e.jsx("span",{className:"text-text-muted/50",children:"v1.0"})]})]})}function jt(){return{name:"æ–°è§„åˆ™",targetType:"httpResponse",condition:{urlPattern:"",method:null,statusCode:null,headerContains:null,bodyContains:null,wsPayloadContains:null,enabled:!0},action:{modifyRequestHeaders:null,modifyRequestBody:null,mockResponseStatusCode:200,mockResponseHeaders:{"Content-Type":"application/json"},mockResponseBody:btoa(JSON.stringify({mock:!0})),mockWebSocketPayload:null,delayMilliseconds:null},priority:0,enabled:!0}}const Or=ne((t,s)=>({rules:[],loading:!1,error:null,editingRule:null,isEditorOpen:!1,fetchRules:async r=>{t({loading:!0,error:null});try{const n=await or(r);t({rules:n,loading:!1})}catch(n){t({loading:!1,error:n instanceof Error?n.message:"åŠ è½½å¤±è´¥"})}},createRule:async(r,n)=>{t({loading:!0,error:null});try{const a=await lr(r,n);t(i=>({rules:[a,...i.rules],loading:!1,isEditorOpen:!1,editingRule:null}))}catch(a){throw t({loading:!1,error:a instanceof Error?a.message:"åˆ›å»ºå¤±è´¥"}),a}},updateRule:async(r,n,a)=>{t({loading:!0,error:null});try{const i=await gt(r,n,a);t(o=>({rules:o.rules.map(l=>l.id===n?i:l),loading:!1,isEditorOpen:!1,editingRule:null}))}catch(i){throw t({loading:!1,error:i instanceof Error?i.message:"æ›´æ–°å¤±è´¥"}),i}},deleteRule:async(r,n)=>{t({loading:!0,error:null});try{await cr(r,n),t(a=>({rules:a.rules.filter(i=>i.id!==n),loading:!1}))}catch(a){t({loading:!1,error:a instanceof Error?a.message:"åˆ é™¤å¤±è´¥"})}},toggleRuleEnabled:async(r,n)=>{const a=s().rules.find(i=>i.id===n);if(a)try{await gt(r,n,{enabled:!a.enabled}),t(i=>({rules:i.rules.map(o=>o.id===n?{...o,enabled:!o.enabled}:o)}))}catch(i){console.error("Failed to toggle rule:",i)}},openEditor:r=>{t({isEditorOpen:!0,editingRule:r||null})},closeEditor:()=>{t({isEditorOpen:!1,editingRule:null})},clearRules:()=>{t({rules:[],editingRule:null,isEditorOpen:!1})}}));function Rr(t,s){let r;try{r=t()}catch{return}return{getItem:a=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=r.getItem(a))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(a,i)=>r.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>r.removeItem(a)}}const Ze=t=>s=>{try{const r=t(s);return r instanceof Promise?r:{then(n){return Ze(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Ze(n)(r)}}}},Ir=(t,s)=>(r,n,a)=>{let i={storage:Rr(()=>localStorage),partialize:b=>b,version:0,merge:(b,D)=>({...D,...b}),...s},o=!1;const l=new Set,c=new Set;let d=i.storage;if(!d)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...b)},n,a);const u=()=>{const b=i.partialize({...n()});return d.setItem(i.name,{state:b,version:i.version})},h=a.setState;a.setState=(b,D)=>(h(b,D),u());const j=t((...b)=>(r(...b),u()),n,a);a.getInitialState=()=>j;let C;const p=()=>{var b,D;if(!d)return;o=!1,l.forEach(w=>{var g;return w((g=n())!=null?g:j)});const k=((D=i.onRehydrateStorage)==null?void 0:D.call(i,(b=n())!=null?b:j))||void 0;return Ze(d.getItem.bind(d))(i.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate){const g=i.migrate(w.state,w.version);return g instanceof Promise?g.then(F=>[!0,F]):[!0,g]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var g;const[F,E]=w;if(C=i.merge(E,(g=n())!=null?g:j),r(C,!0),F)return u()}).then(()=>{k==null||k(C,void 0),C=n(),o=!0,c.forEach(w=>w(C))}).catch(w=>{k==null||k(void 0,w)})};return a.persist={setOptions:b=>{i={...i,...b},b.storage&&(d=b.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:b=>(l.add(b),()=>{l.delete(b)}),onFinishHydration:b=>(c.add(b),()=>{c.delete(b)})},i.skipHydration||p(),C||j},es=Ir;function Pr(){return typeof window>"u"||window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function qe(t){return t==="system"?Pr():t}function Ye(t){const s=document.documentElement;t==="light"?(s.classList.add("light"),s.classList.remove("dark")):(s.classList.add("dark"),s.classList.remove("light"))}const We=ne()(es((t,s)=>({theme:"dark",resolvedTheme:"dark",setTheme:r=>{const n=qe(r);Ye(n),t({theme:r,resolvedTheme:n})},toggleTheme:()=>{const{theme:r}=s(),n=r==="dark"?"light":r==="light"?"system":"dark",a=qe(n);Ye(a),t({theme:n,resolvedTheme:a})}}),{name:"debug-platform-theme",onRehydrateStorage:()=>t=>{if(t){const s=qe(t.theme);Ye(s),t.resolvedTheme=s}}}));typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const{theme:t,setTheme:s}=We.getState();t==="system"&&s("system")});const ts=ne((t,s)=>({activities:[],maxActivities:100,addActivity:r=>t(n=>({activities:[r,...n.activities].slice(0,n.maxActivities)})),clearActivities:()=>t({activities:[]}),getActivitiesForDevice:r=>s().activities.filter(n=>n.deviceId===r)})),Mr=ne((t,s)=>({pendingHits:[],loading:!1,fetchPendingHits:async r=>{t({loading:!0});try{const n=await Gt(r);t({pendingHits:n})}catch(n){console.error("Failed to fetch pending breakpoints:",n)}finally{t({loading:!1})}},addHit:r=>{t(n=>n.pendingHits.some(a=>a.requestId===r.requestId)?n:{pendingHits:[...n.pendingHits,r]})},removeHit:r=>{t(n=>({pendingHits:n.pendingHits.filter(a=>a.requestId!==r)}))},resumeBreakpoint:async(r,n,a)=>{try{await Jt(r,n,a),s().removeHit(n)}catch(i){throw console.error("Failed to resume breakpoint:",i),i}},clear:()=>{t({pendingHits:[]})}}));class Fr{constructor(){me(this,"ws",null);me(this,"messageHandlers",new Set);me(this,"connectionHandlers",new Set);me(this,"reconnectTimer",null);me(this,"currentDeviceId",null);me(this,"shouldReconnect",!1)}connect(s,r="both"){this.disconnect(),this.currentDeviceId=s,this.shouldReconnect=!0;const a=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/live?deviceId=${s}&type=${r}`;this.ws=new WebSocket(a),this.ws.onopen=()=>{console.log("[Realtime] Connected"),this.notifyConnectionHandlers(!0)},this.ws.onclose=()=>{console.log("[Realtime] Disconnected"),this.notifyConnectionHandlers(!1),this.scheduleReconnect()},this.ws.onerror=i=>{console.error("[Realtime] Error:",i)},this.ws.onmessage=i=>{try{const o=JSON.parse(i.data);this.notifyMessageHandlers(o)}catch(o){console.error("[Realtime] Failed to parse message:",o)}}}disconnect(){this.shouldReconnect=!1,this.currentDeviceId=null,this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.close(),this.ws=null)}scheduleReconnect(){!this.shouldReconnect||!this.currentDeviceId||(this.reconnectTimer=window.setTimeout(()=>{this.currentDeviceId&&(console.log("[Realtime] Reconnecting..."),this.connect(this.currentDeviceId))},3e3))}onMessage(s){return this.messageHandlers.add(s),()=>this.messageHandlers.delete(s)}onConnection(s){return this.connectionHandlers.add(s),()=>this.connectionHandlers.delete(s)}notifyMessageHandlers(s){this.messageHandlers.forEach(r=>r(s))}notifyConnectionHandlers(s){this.connectionHandlers.forEach(r=>r(s))}get isConnected(){var s;return((s=this.ws)==null?void 0:s.readyState)===WebSocket.OPEN}}const Oe=new Fr;function Lr(t){var r,n,a;const s=JSON.parse(t);return{id:s.request.id,method:s.request.method,url:s.request.url,statusCode:((r=s.response)==null?void 0:r.statusCode)??null,startTime:s.request.startTime,duration:((n=s.response)==null?void 0:n.duration)??null,isMocked:s.isMocked,errorDescription:((a=s.response)==null?void 0:a.errorDescription)??null,traceId:s.request.traceId??null,isFavorite:s.isFavorite??!1}}function _r(t){return JSON.parse(t)}function Ar(t){const s=JSON.parse(t),r=n=>n&&typeof n=="object"&&"_0"in n?n._0:n;return s.kind.sessionCreated?{type:"sessionCreated",data:r(s.kind.sessionCreated)}:s.kind.sessionClosed?{type:"sessionClosed",data:r(s.kind.sessionClosed)}:s.kind.frame?{type:"frame",data:r(s.kind.frame)}:{type:"unknown",data:s}}function ge(t,s,r){let n=r.initialDeps??[],a;function i(){var o,l,c,d;let u;r.key&&((o=r.debug)!=null&&o.call(r))&&(u=Date.now());const h=t();if(!(h.length!==n.length||h.some((p,b)=>n[b]!==p)))return a;n=h;let C;if(r.key&&((l=r.debug)!=null&&l.call(r))&&(C=Date.now()),a=s(...h),r.key&&((c=r.debug)!=null&&c.call(r))){const p=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-C)*100)/100,D=b/16,k=(w,g)=>{for(w=String(w);w.length<g;)w=" "+w;return w};console.info(`%câ± ${k(b,5)} /${k(p,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*D,120))}deg 100% 31%);`,r==null?void 0:r.key)}return(d=r==null?void 0:r.onChange)==null||d.call(r,a),a}return i.updateDeps=o=>{n=o},i}function Nt(t,s){if(t===void 0)throw new Error("Unexpected undefined");return t}const $r=(t,s)=>Math.abs(t-s)<1.01,Br=(t,s,r)=>{let n;return function(...a){t.clearTimeout(n),n=t.setTimeout(()=>s.apply(this,a),r)}},wt=t=>{const{offsetWidth:s,offsetHeight:r}=t;return{width:s,height:r}},Hr=t=>t,Wr=t=>{const s=Math.max(t.startIndex-t.overscan,0),r=Math.min(t.endIndex+t.overscan,t.count-1),n=[];for(let a=s;a<=r;a++)n.push(a);return n},zr=(t,s)=>{const r=t.scrollElement;if(!r)return;const n=t.targetWindow;if(!n)return;const a=o=>{const{width:l,height:c}=o;s({width:Math.round(l),height:Math.round(c)})};if(a(wt(r)),!n.ResizeObserver)return()=>{};const i=new n.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){a({width:d.inlineSize,height:d.blockSize});return}}a(wt(r))};t.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(r,{box:"border-box"}),()=>{i.unobserve(r)}},kt={passive:!0},St=typeof window>"u"?!0:"onscrollend"in window,Ur=(t,s)=>{const r=t.scrollElement;if(!r)return;const n=t.targetWindow;if(!n)return;let a=0;const i=t.options.useScrollendEvent&&St?()=>{}:Br(n,()=>{s(a,!1)},t.options.isScrollingResetDelay),o=u=>()=>{const{horizontal:h,isRtl:j}=t.options;a=h?r.scrollLeft*(j&&-1||1):r.scrollTop,i(),s(a,u)},l=o(!0),c=o(!1);c(),r.addEventListener("scroll",l,kt);const d=t.options.useScrollendEvent&&St;return d&&r.addEventListener("scrollend",c,kt),()=>{r.removeEventListener("scroll",l),d&&r.removeEventListener("scrollend",c)}},qr=(t,s,r)=>{if(s!=null&&s.borderBoxSize){const n=s.borderBoxSize[0];if(n)return Math.round(n[r.options.horizontal?"inlineSize":"blockSize"])}return t[r.options.horizontal?"offsetWidth":"offsetHeight"]},Yr=(t,{adjustments:s=0,behavior:r},n)=>{var a,i;const o=t+s;(i=(a=n.scrollElement)==null?void 0:a.scrollTo)==null||i.call(a,{[n.options.horizontal?"left":"top"]:o,behavior:r})};class Vr{constructor(s){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let r=null;const n=()=>r||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:r=new this.targetWindow.ResizeObserver(a=>{a.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var a;(a=n())==null||a.disconnect(),r=null},observe:a=>{var i;return(i=n())==null?void 0:i.observe(a,{box:"border-box"})},unobserve:a=>{var i;return(i=n())==null?void 0:i.unobserve(a)}}})(),this.range=null,this.setOptions=r=>{Object.entries(r).forEach(([n,a])=>{typeof a>"u"&&delete r[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Hr,rangeExtractor:Wr,onChange:()=>{},measureElement:qr,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...r}},this.notify=r=>{var n,a;(a=(n=this.options).onChange)==null||a.call(n,this,r)},this.maybeNotify=ge(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),r=>{this.notify(r)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(r=>r()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var r;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((r=this.scrollElement)==null?void 0:r.window)??null,this.elementsCache.forEach(a=>{this.observer.observe(a)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,a=>{this.scrollRect=a,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(a,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<a?"forward":"backward":null,this.scrollOffset=a,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(r,n)=>{const a=new Map,i=new Map;for(let o=n-1;o>=0;o--){const l=r[o];if(a.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&a.set(l.lane,!0),a.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=ge(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(r,n,a,i,o)=>(this.pendingMeasuredCacheIndexes=[],{count:r,paddingStart:n,scrollMargin:a,getItemKey:i,enabled:o}),{key:!1}),this.getMeasurements=ge(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:r,paddingStart:n,scrollMargin:a,getItemKey:i,enabled:o},l)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const d=this.measurementsCache.slice(0,c);for(let u=c;u<r;u++){const h=i(u),j=this.options.lanes===1?d[u-1]:this.getFurthestMeasurement(d,u),C=j?j.end+this.options.gap:n+a,p=l.get(h),b=typeof p=="number"?p:this.options.estimateSize(u),D=C+b,k=j?j.lane:u%this.options.lanes;d[u]={index:u,start:C,size:b,end:D,key:h,lane:k}}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ge(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(r,n,a,i)=>this.range=r.length>0&&n>0?Gr({measurements:r,outerSize:n,scrollOffset:a,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=ge(()=>{let r=null,n=null;const a=this.calculateRange();return a&&(r=a.startIndex,n=a.endIndex),this.maybeNotify.updateDeps([this.isScrolling,r,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,r,n]},(r,n,a,i,o)=>i===null||o===null?[]:r({startIndex:i,endIndex:o,overscan:n,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=r=>{const n=this.options.indexAttribute,a=r.getAttribute(n);return a?parseInt(a,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(r,n)=>{const a=this.indexFromElement(r),i=this.measurementsCache[a];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==r&&(l&&this.observer.unobserve(l),this.observer.observe(r),this.elementsCache.set(o,r)),r.isConnected&&this.resizeItem(a,this.options.measureElement(r,n,this))},this.resizeItem=(r,n)=>{const a=this.measurementsCache[r];if(!a)return;const i=this.itemSizeCache.get(a.key)??a.size,o=n-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(a,o,this):a.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(a.index),this.itemSizeCache=new Map(this.itemSizeCache.set(a.key,n)),this.notify(!1))},this.measureElement=r=>{if(!r){this.elementsCache.forEach((n,a)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(a))});return}this._measureElement(r,void 0)},this.getVirtualItems=ge(()=>[this.getVirtualIndexes(),this.getMeasurements()],(r,n)=>{const a=[];for(let i=0,o=r.length;i<o;i++){const l=r[i],c=n[l];a.push(c)}return a},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=r=>{const n=this.getMeasurements();if(n.length!==0)return Nt(n[ss(0,n.length-1,a=>Nt(n[a]).start,r)])},this.getOffsetForAlignment=(r,n,a=0)=>{const i=this.getSize(),o=this.getScrollOffset();n==="auto"&&(n=r>=o+i?"end":"start"),n==="center"?r+=(a-i)/2:n==="end"&&(r-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,r),0)},this.getOffsetForIndex=(r,n="auto")=>{r=Math.max(0,Math.min(r,this.options.count-1));const a=this.measurementsCache[r];if(!a)return;const i=this.getSize(),o=this.getScrollOffset();if(n==="auto")if(a.end>=o+i-this.options.scrollPaddingEnd)n="end";else if(a.start<=o+this.options.scrollPaddingStart)n="start";else return[o,n];const l=n==="end"?a.end+this.options.scrollPaddingEnd:a.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,n,a.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(r,{align:n="start",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(r,n),{adjustments:void 0,behavior:a})},this.scrollToIndex=(r,{align:n="auto",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r=Math.max(0,Math.min(r,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const u=this.getOffsetForIndex(r,d);if(!u){console.warn("Failed to get offset for index:",r);return}const[h,j]=u;this._scrollToOffset(h,{adjustments:void 0,behavior:a}),this.targetWindow.requestAnimationFrame(()=>{const C=this.getScrollOffset(),p=this.getOffsetForIndex(r,j);if(!p){console.warn("Failed to get offset for index:",r);return}$r(p[0],C)||c(j)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${r} after ${o} attempts.`))};l(n)},this.scrollBy=(r,{behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+r,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var r;const n=this.getMeasurements();let a;if(n.length===0)a=this.options.paddingStart;else if(this.options.lanes===1)a=((r=n[n.length-1])==null?void 0:r.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=n.length-1;for(;o>=0&&i.some(l=>l===null);){const l=n[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}a=Math.max(...i.filter(l=>l!==null))}return Math.max(a-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(r,{adjustments:n,behavior:a})=>{this.options.scrollToFn(r,{behavior:a,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(s)}}const ss=(t,s,r,n)=>{for(;t<=s;){const a=(t+s)/2|0,i=r(a);if(i<n)t=a+1;else if(i>n)s=a-1;else return a}return t>0?t-1:0};function Gr({measurements:t,outerSize:s,scrollOffset:r,lanes:n}){const a=t.length-1,i=c=>t[c].start;if(t.length<=n)return{startIndex:0,endIndex:a};let o=ss(0,a,i,r),l=o;if(n===1)for(;l<a&&t[l].end<r+s;)l++;else if(n>1){const c=Array(n).fill(0);for(;l<a&&c.some(u=>u<r+s);){const u=t[l];c[u.lane]=u.end,l++}const d=Array(n).fill(r+s);for(;o>=0&&d.some(u=>u>=r);){const u=t[o];d[u.lane]=u.start,o--}o=Math.max(0,o-o%n),l=Math.min(a,l+(n-1-l%n))}return{startIndex:o,endIndex:l}}const Et=typeof document<"u"?x.useLayoutEffect:x.useEffect;function Jr(t){const s=x.useReducer(()=>({}),{})[1],r={...t,onChange:(a,i)=>{var o;i?zt.flushSync(s):s(),(o=t.onChange)==null||o.call(t,a,i)}},[n]=x.useState(()=>new Vr(r));return n.setOptions(r),Et(()=>n._didMount(),[]),Et(()=>n._willUpdate()),n}function rs(t){return Jr({observeElementRect:zr,observeElementOffset:Ur,scrollToFn:Yr,...t})}const ns=6048e5,Qr=864e5,at=6e4,it=36e5,Tt=Symbol.for("constructDateFrom");function se(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&Tt in t?t[Tt](s):t instanceof Date?new t.constructor(s):new Date(s)}function te(t,s){return se(s||t,t)}function Kr(t,s,r){const n=te(t,r==null?void 0:r.in);return isNaN(s)?se(t,NaN):(n.setDate(n.getDate()+s),n)}let Xr={};function ze(){return Xr}function Te(t,s){var l,c,d,u;const r=ze(),n=(s==null?void 0:s.weekStartsOn)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=te(t,s==null?void 0:s.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Le(t,s){return Te(t,{...s,weekStartsOn:1})}function as(t,s){const r=te(t,s==null?void 0:s.in),n=r.getFullYear(),a=se(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=Le(a),o=se(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Le(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function Ct(t){const s=te(t),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+t-+r}function ot(t,...s){const r=se.bind(null,s.find(n=>typeof n=="object"));return s.map(r)}function _e(t,s){const r=te(t,s==null?void 0:s.in);return r.setHours(0,0,0,0),r}function Zr(t,s,r){const[n,a]=ot(r==null?void 0:r.in,t,s),i=_e(n),o=_e(a),l=+i-Ct(i),c=+o-Ct(o);return Math.round((l-c)/Qr)}function en(t,s){const r=as(t,s),n=se(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Le(n)}function is(t){return se(t,Date.now())}function os(t,s,r){const[n,a]=ot(r==null?void 0:r.in,t,s);return+_e(n)==+_e(a)}function tn(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function sn(t){return!(!tn(t)&&typeof t!="number"||isNaN(+te(t)))}function lt(t){return s=>{const r=Math.trunc,n=r(s);return n===0?0:n}}function rn(t,s,r){const[n,a]=ot(r==null?void 0:r.in,t,s),i=(+n-+a)/it;return lt()(i)}function ls(t,s){return+te(t)-+te(s)}function cs(t,s,r){const n=ls(t,s)/at;return lt()(n)}function nn(t,s,r){const n=ls(t,s)/1e3;return lt()(n)}function an(t,s){const r=te(t,s==null?void 0:s.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const on={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ln=(t,s,r)=>{let n;const a=on[t];return typeof a=="string"?n=a:s===1?n=a.one:n=a.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Ve(t){return(s={})=>{const r=s.width?String(s.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const cn={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},dn={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},un={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},mn={date:Ve({formats:cn,defaultWidth:"full"}),time:Ve({formats:dn,defaultWidth:"full"}),dateTime:Ve({formats:un,defaultWidth:"full"})},xn={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},hn=(t,s,r,n)=>xn[t];function Ne(t){return(s,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(s):s;return a[i]}}const pn={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},fn={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},gn={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},bn={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},yn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},vn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},jn=(t,s)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Nn={ordinalNumber:jn,era:Ne({values:pn,defaultWidth:"wide"}),quarter:Ne({values:fn,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ne({values:gn,defaultWidth:"wide"}),day:Ne({values:bn,defaultWidth:"wide"}),dayPeriod:Ne({values:yn,defaultWidth:"wide",formattingValues:vn,defaultFormattingWidth:"wide"})};function we(t){return(s,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=s.match(a);if(!i)return null;const o=i[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?kn(l,h=>h.test(o)):wn(l,h=>h.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=s.slice(o.length);return{value:d,rest:u}}}function wn(t,s){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&s(t[r]))return r}function kn(t,s){for(let r=0;r<t.length;r++)if(s(t[r]))return r}function Sn(t){return(s,r={})=>{const n=s.match(t.matchPattern);if(!n)return null;const a=n[0],i=s.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=s.slice(a.length);return{value:o,rest:l}}}const En=/^(\d+)(th|st|nd|rd)?/i,Tn=/\d+/i,Cn={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Dn={any:[/^b/i,/^(a|c)/i]},On={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Rn={any:[/1/i,/2/i,/3/i,/4/i]},In={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Pn={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Mn={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Fn={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ln={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_n={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},An={ordinalNumber:Sn({matchPattern:En,parsePattern:Tn,valueCallback:t=>parseInt(t,10)}),era:we({matchPatterns:Cn,defaultMatchWidth:"wide",parsePatterns:Dn,defaultParseWidth:"any"}),quarter:we({matchPatterns:On,defaultMatchWidth:"wide",parsePatterns:Rn,defaultParseWidth:"any",valueCallback:t=>t+1}),month:we({matchPatterns:In,defaultMatchWidth:"wide",parsePatterns:Pn,defaultParseWidth:"any"}),day:we({matchPatterns:Mn,defaultMatchWidth:"wide",parsePatterns:Fn,defaultParseWidth:"any"}),dayPeriod:we({matchPatterns:Ln,defaultMatchWidth:"any",parsePatterns:_n,defaultParseWidth:"any"})},$n={code:"en-US",formatDistance:ln,formatLong:mn,formatRelative:hn,localize:Nn,match:An,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Bn(t,s){const r=te(t,s==null?void 0:s.in);return Zr(r,an(r))+1}function Hn(t,s){const r=te(t,s==null?void 0:s.in),n=+Le(r)-+en(r);return Math.round(n/ns)+1}function ds(t,s){var u,h,j,C;const r=te(t,s==null?void 0:s.in),n=r.getFullYear(),a=ze(),i=(s==null?void 0:s.firstWeekContainsDate)??((h=(u=s==null?void 0:s.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((C=(j=a.locale)==null?void 0:j.options)==null?void 0:C.firstWeekContainsDate)??1,o=se((s==null?void 0:s.in)||t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=Te(o,s),c=se((s==null?void 0:s.in)||t,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=Te(c,s);return+r>=+l?n+1:+r>=+d?n:n-1}function Wn(t,s){var l,c,d,u;const r=ze(),n=(s==null?void 0:s.firstWeekContainsDate)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,a=ds(t,s),i=se((s==null?void 0:s.in)||t,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),Te(i,s)}function zn(t,s){const r=te(t,s==null?void 0:s.in),n=+Te(r,s)-+Wn(r,s);return Math.round(n/ns)+1}function V(t,s){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(s,"0");return r+n}const le={y(t,s){const r=t.getFullYear(),n=r>0?r:1-r;return V(s==="yy"?n%100:n,s.length)},M(t,s){const r=t.getMonth();return s==="M"?String(r+1):V(r+1,2)},d(t,s){return V(t.getDate(),s.length)},a(t,s){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,s){return V(t.getHours()%12||12,s.length)},H(t,s){return V(t.getHours(),s.length)},m(t,s){return V(t.getMinutes(),s.length)},s(t,s){return V(t.getSeconds(),s.length)},S(t,s){const r=s.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return V(a,s.length)}},be={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Dt={G:function(t,s,r){const n=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,s,r){if(s==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return le.y(t,s)},Y:function(t,s,r,n){const a=ds(t,n),i=a>0?a:1-a;if(s==="YY"){const o=i%100;return V(o,2)}return s==="Yo"?r.ordinalNumber(i,{unit:"year"}):V(i,s.length)},R:function(t,s){const r=as(t);return V(r,s.length)},u:function(t,s){const r=t.getFullYear();return V(r,s.length)},Q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(n);case"QQ":return V(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(n);case"qq":return V(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,s,r){const n=t.getMonth();switch(s){case"M":case"MM":return le.M(t,s);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,s,r){const n=t.getMonth();switch(s){case"L":return String(n+1);case"LL":return V(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,s,r,n){const a=zn(t,n);return s==="wo"?r.ordinalNumber(a,{unit:"week"}):V(a,s.length)},I:function(t,s,r){const n=Hn(t);return s==="Io"?r.ordinalNumber(n,{unit:"week"}):V(n,s.length)},d:function(t,s,r){return s==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):le.d(t,s)},D:function(t,s,r){const n=Bn(t);return s==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):V(n,s.length)},E:function(t,s,r){const n=t.getDay();switch(s){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,s,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return V(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,s,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return V(i,s.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,s,r){const n=t.getDay(),a=n===0?7:n;switch(s){case"i":return String(a);case"ii":return V(a,s.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,s,r){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,s,r){const n=t.getHours();let a;switch(n===12?a=be.noon:n===0?a=be.midnight:a=n/12>=1?"pm":"am",s){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,s,r){const n=t.getHours();let a;switch(n>=17?a=be.evening:n>=12?a=be.afternoon:n>=4?a=be.morning:a=be.night,s){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,s,r){if(s==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return le.h(t,s)},H:function(t,s,r){return s==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):le.H(t,s)},K:function(t,s,r){const n=t.getHours()%12;return s==="Ko"?r.ordinalNumber(n,{unit:"hour"}):V(n,s.length)},k:function(t,s,r){let n=t.getHours();return n===0&&(n=24),s==="ko"?r.ordinalNumber(n,{unit:"hour"}):V(n,s.length)},m:function(t,s,r){return s==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):le.m(t,s)},s:function(t,s,r){return s==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):le.s(t,s)},S:function(t,s){return le.S(t,s)},X:function(t,s,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(s){case"X":return Rt(n);case"XXXX":case"XX":return he(n);case"XXXXX":case"XXX":default:return he(n,":")}},x:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"x":return Rt(n);case"xxxx":case"xx":return he(n);case"xxxxx":case"xxx":default:return he(n,":")}},O:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Ot(n,":");case"OOOO":default:return"GMT"+he(n,":")}},z:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Ot(n,":");case"zzzz":default:return"GMT"+he(n,":")}},t:function(t,s,r){const n=Math.trunc(+t/1e3);return V(n,s.length)},T:function(t,s,r){return V(+t,s.length)}};function Ot(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+s+V(i,2)}function Rt(t,s){return t%60===0?(t>0?"-":"+")+V(Math.abs(t)/60,2):he(t,s)}function he(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=V(Math.trunc(n/60),2),i=V(n%60,2);return r+a+s+i}const It=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},us=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},Un=(t,s)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return It(t,s);let i;switch(n){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",It(n,s)).replace("{{time}}",us(a,s))},qn={p:us,P:Un},Yn=/^D+$/,Vn=/^Y+$/,Gn=["D","DD","YY","YYYY"];function Jn(t){return Yn.test(t)}function Qn(t){return Vn.test(t)}function Kn(t,s,r){const n=Xn(t,s,r);if(console.warn(n),Gn.includes(t))throw new RangeError(n)}function Xn(t,s,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Zn=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ea=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ta=/^'([^]*?)'?$/,sa=/''/g,ra=/[a-zA-Z]/;function ve(t,s,r){var u,h,j,C;const n=ze(),a=n.locale??$n,i=n.firstWeekContainsDate??((h=(u=n.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,o=n.weekStartsOn??((C=(j=n.locale)==null?void 0:j.options)==null?void 0:C.weekStartsOn)??0,l=te(t,r==null?void 0:r.in);if(!sn(l))throw new RangeError("Invalid time value");let c=s.match(ea).map(p=>{const b=p[0];if(b==="p"||b==="P"){const D=qn[b];return D(p,a.formatLong)}return p}).join("").match(Zn).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const b=p[0];if(b==="'")return{isToken:!1,value:na(p)};if(Dt[b])return{isToken:!0,value:p};if(b.match(ra))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(p=>{if(!p.isToken)return p.value;const b=p.value;(Qn(b)||Jn(b))&&Kn(b,s,String(t));const D=Dt[b[0]];return D(l,b,a.localize,d)}).join("")}function na(t){const s=t.match(ta);return s?s[1].replace(sa,"'"):t}function ms(t,s){return os(se(t,t),is(t))}function aa(t,s,r){return Kr(t,-1,r)}function xs(t,s){return os(se(t,t),aa(is(t)))}function hs(t,s){const r=()=>se(s==null?void 0:s.in,NaN),a=ca(t);let i;if(a.date){const d=da(a.date,2);i=ua(d.restDateString,d.year)}if(!i||isNaN(+i))return r();const o=+i;let l=0,c;if(a.time&&(l=ma(a.time),isNaN(l)))return r();if(a.timezone){if(c=xa(a.timezone),isNaN(c))return r()}else{const d=new Date(o+l),u=te(0,s==null?void 0:s.in);return u.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),u.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),u}return te(o+l+c,s==null?void 0:s.in)}const Re={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ia=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,oa=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,la=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ca(t){const s={},r=t.split(Re.dateTimeDelimiter);let n;if(r.length>2)return s;if(/:/.test(r[0])?n=r[0]:(s.date=r[0],n=r[1],Re.timeZoneDelimiter.test(s.date)&&(s.date=t.split(Re.timeZoneDelimiter)[0],n=t.substr(s.date.length,t.length))),n){const a=Re.timezone.exec(n);a?(s.time=n.replace(a[1],""),s.timezone=a[1]):s.time=n}return s}function da(t,s){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),n=t.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((n[1]||n[2]).length)}}function ua(t,s){if(s===null)return new Date(NaN);const r=t.match(ia);if(!r)return new Date(NaN);const n=!!r[4],a=ke(r[1]),i=ke(r[2])-1,o=ke(r[3]),l=ke(r[4]),c=ke(r[5])-1;if(n)return ba(s,l,c)?ha(s,l,c):new Date(NaN);{const d=new Date(0);return!fa(s,i,o)||!ga(s,a)?new Date(NaN):(d.setUTCFullYear(s,i,Math.max(a,o)),d)}}function ke(t){return t?parseInt(t):1}function ma(t){const s=t.match(oa);if(!s)return NaN;const r=Ge(s[1]),n=Ge(s[2]),a=Ge(s[3]);return ya(r,n,a)?r*it+n*at+a*1e3:NaN}function Ge(t){return t&&parseFloat(t.replace(",","."))||0}function xa(t){if(t==="Z")return 0;const s=t.match(la);if(!s)return 0;const r=s[1]==="+"?-1:1,n=parseInt(s[2]),a=s[3]&&parseInt(s[3])||0;return va(n,a)?r*(n*it+a*at):NaN}function ha(t,s,r){const n=new Date(0);n.setUTCFullYear(t,0,4);const a=n.getUTCDay()||7,i=(s-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const pa=[31,null,31,30,31,30,31,31,30,31,30,31];function ps(t){return t%400===0||t%4===0&&t%100!==0}function fa(t,s,r){return s>=0&&s<=11&&r>=1&&r<=(pa[s]||(ps(t)?29:28))}function ga(t,s){return s>=1&&s<=(ps(t)?366:365)}function ba(t,s,r){return s>=1&&s<=53&&r>=0&&r<=6}function ya(t,s,r){return t===24?s===0&&r===0:r>=0&&r<60&&s>=0&&s<60&&t>=0&&t<25}function va(t,s){return s>=0&&s<=59}function fs(t){try{const s=typeof t=="string"?hs(t):new Date(t),r=new Date,n=nn(r,s),a=cs(r,s),i=rn(r,s);return n<5?"åˆšåˆš":n<60?`${n} ç§’å‰`:a<60?`${a} åˆ†é’Ÿå‰`:i<24?`${i} å°æ—¶å‰`:ms(s)?`ä»Šå¤© ${ve(s,"HH:mm")}`:xs(s)?`æ˜¨å¤© ${ve(s,"HH:mm")}`:ve(s,"MM-dd HH:mm")}catch{return t}}function oe(t){try{const s=typeof t=="string"?hs(t):new Date(t);return cs(new Date,s)<5?fs(t):ms(s)?ve(s,"HH:mm:ss"):xs(s)?`æ˜¨å¤© ${ve(s,"HH:mm")}`:ve(s,"MM/dd HH:mm")}catch{return t}}function gs(t){if(t==null)return"text-text-muted";const s=t*1e3;return s<100?"text-green-400":s<500?"text-green-300":s<1e3?"text-yellow-400":s<3e3?"text-orange-400":"text-red-400"}function Ce(t,s){let r;if(t instanceof Date&&s instanceof Date)r=s.getTime()-t.getTime();else if(typeof t=="number"){if(t===null)return"-";r=t*1e3}else return"-";if(r<0)return"-";if(r<1)return`${Math.round(r*1e3)}Âµs`;if(r<1e3)return`${Math.round(r)}ms`;if(r<6e4)return`${(r/1e3).toFixed(1)}s`;if(r<36e5){const i=Math.floor(r/6e4),o=Math.floor(r%6e4/1e3);return`${i}m ${o}s`}const n=Math.floor(r/36e5),a=Math.floor(r%36e5/6e4);return`${n}h ${a}m`}function Ae(t){if(t===0)return"0 B";if(t<0)return"-";const s=1024,r=["B","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,n)).toFixed(2))+" "+r[n]}function ja(t,s=60){try{const r=new URL(t),n=r.pathname+r.search;return n.length>s?n.substring(0,s)+"...":n}catch{return t.length>s?t.substring(0,s)+"...":t}}function ct(t){try{return new URL(t).hostname}catch{return t}}function dt(t){return t?t>=200&&t<300?"bg-green-500/15 text-green-400 border border-green-500/30":t>=300&&t<400?"bg-blue-500/15 text-blue-400 border border-blue-500/30":t>=400&&t<500?"bg-yellow-500/15 text-yellow-400 border border-yellow-500/30":"bg-red-500/15 text-red-400 border border-red-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}function ut(t){return{GET:"bg-method-get/20 text-method-get border border-method-get/30",POST:"bg-method-post/20 text-method-post border border-method-post/30",PUT:"bg-method-put/20 text-method-put border border-method-put/30",DELETE:"bg-method-delete/20 text-method-delete border border-method-delete/30",PATCH:"bg-method-patch/20 text-method-patch border border-method-patch/30"}[t.toUpperCase()]||"bg-gray-500/20 text-gray-400 border border-gray-500/30"}function Pt(t){try{return atob(t)}catch{return t}}function Na(t){const s={verbose:{color:"text-level-verbose",bg:"bg-level-verbose/10",border:"border-l-level-verbose"},debug:{color:"text-level-debug",bg:"bg-level-debug/10",border:"border-l-level-debug"},info:{color:"text-level-info",bg:"bg-level-info/10",border:"border-l-level-info"},warning:{color:"text-level-warning",bg:"bg-level-warning/10",border:"border-l-level-warning"},error:{color:"text-level-error",bg:"bg-level-error/10",border:"border-l-level-error"}};return s[t.toLowerCase()]||s.debug}const wa=56;function ka({items:t,selectedId:s,onSelect:r,autoScroll:n,isSelectMode:a=!1,selectedIds:i=new Set,onToggleSelect:o}){const l=x.useRef(null),c=x.useRef(null),d=t.filter(p=>!rt(p)),u=rs({count:d.length,getScrollElement:()=>l.current,estimateSize:()=>wa,overscan:10}),h=u.getVirtualItems();x.useEffect(()=>{const p=d[0],b=(p==null?void 0:p.id)??null,D=b!==null&&b!==c.current;n&&D&&u.scrollToIndex(0,{align:"start",behavior:"smooth"}),c.current=b},[d,n,u]);const j=x.useCallback((p,b)=>{a&&o?(b.preventDefault(),o(p.id)):r(p.id)},[a,o,r]),C=(p,b)=>{const D=!p.statusCode||p.statusCode>=400,k=p.id===s,w=i.has(p.id);return e.jsxs("div",{style:b,onClick:g=>j(p,g),className:y("flex items-center cursor-pointer transition-all duration-150 group border-b border-border-light",D&&!k&&"bg-red-500/5 hover:bg-red-500/10",k&&"bg-primary text-white shadow-sm shadow-primary/20",w&&!k&&"bg-primary/15",!k&&!w&&!D&&"hover:bg-bg-light/60"),children:[a&&e.jsx("div",{className:"px-3 py-3.5 w-10 flex-shrink-0",onClick:g=>g.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:w,onChange:()=>o==null?void 0:o(p.id),className:"w-4 h-4 rounded border-border cursor-pointer accent-primary"})}),e.jsx("div",{className:y("px-4 py-3.5 w-[100px] flex-shrink-0",k?"text-white/80":"text-text-muted"),children:e.jsx("span",{className:"text-sm font-mono",children:oe(p.startTime)})}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0",children:e.jsx("span",{className:y("inline-flex items-center justify-center px-3 py-1.5 rounded-lg text-xs font-mono font-bold min-w-[60px] shadow-sm",k?"bg-white/20 text-white":ut(p.method)),children:p.method})}),e.jsx("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0",children:e.jsx("span",{className:y("inline-flex items-center justify-center px-3 py-1.5 rounded-lg text-xs font-mono font-semibold min-w-[44px] shadow-sm",k?"bg-white/20 text-white":dt(p.statusCode)),children:p.statusCode??"ERR"})}),e.jsx("div",{className:"px-4 py-3.5 flex-1 min-w-0 overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:y("text-sm truncate transition-colors",k?"text-white":"text-text-primary group-hover:text-primary"),title:p.url,children:ja(p.url)}),e.jsx("span",{className:y("text-xs truncate font-mono",k?"text-white/70":"text-text-muted opacity-70"),children:ct(p.url)})]})}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0",children:e.jsx("span",{className:y("text-sm font-mono font-medium",k?"text-white":gs(p.duration)),children:Ce(p.duration)})}),e.jsxs("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0 flex items-center justify-center gap-2",children:[p.isMocked&&e.jsx("span",{className:"inline-flex items-center justify-center w-7 h-7 rounded-lg bg-purple-500/15 text-purple-400 shadow-sm shadow-purple-500/10",title:"å·² Mock",children:"ðŸŽ­"}),p.isFavorite&&e.jsx("span",{className:"badge-favorite text-base",title:"å·²æ”¶è—",children:"â˜…"}),!p.isMocked&&!p.isFavorite&&e.jsx("span",{className:"w-7 h-7"})]})]},p.id)};return e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center bg-bg-medium border-b border-border text-text-secondary sticky top-0 z-10",children:[a&&e.jsx("div",{className:"px-3 py-3.5 w-10 flex-shrink-0",children:e.jsx("span",{className:"sr-only",children:"é€‰æ‹©"})}),e.jsx("div",{className:"px-4 py-3.5 w-[100px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"æ—¶é—´"}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"æ–¹æ³•"}),e.jsx("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"çŠ¶æ€"}),e.jsx("div",{className:"px-4 py-3.5 flex-1 font-semibold text-xs uppercase tracking-wider",children:"URL / åŸŸå"}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"è€—æ—¶"}),e.jsx("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider text-center",children:"æ ‡è®°"})]}),e.jsx("div",{ref:l,className:"flex-1 overflow-auto",children:d.length>0?e.jsx("div",{style:{height:`${u.getTotalSize()}px`,width:"100%",position:"relative"},children:h.map(p=>{const b=d[p.index];return C(b,{position:"absolute",top:0,left:0,width:"100%",height:`${p.size}px`,transform:`translateY(${p.start}px)`})})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-20",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-bg-light flex items-center justify-center mb-4 border border-border",children:e.jsx("span",{className:"text-3xl opacity-60",children:"ðŸŒ"})}),e.jsx("p",{className:"text-sm font-medium text-text-secondary mb-1",children:"æš‚æ—  HTTP è¯·æ±‚"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç­‰å¾…ç½‘ç»œè¯·æ±‚è¢«æ•èŽ·..."})]})})]})}function Sa(t){const s=new Map;for(const r of t){const n=ct(r.url)||"unknown";s.has(n)||s.set(n,[]),s.get(n).push(r)}return s}function Ea(t){const s=new Map;for(const r of t)try{const n=new URL(r.url),a=n.pathname.split("/").filter(Boolean),i=a.length>0?`${n.hostname}/${a.slice(0,2).join("/")}`:n.hostname;s.has(i)||s.set(i,[]),s.get(i).push(r)}catch{const n="invalid-url";s.has(n)||s.set(n,[]),s.get(n).push(r)}return s}function Ta(t,s,r){if(s==="none")return[];const n=s==="domain"?Sa(t):Ea(t),a=[];for(const[i,o]of n){const l=o.filter(c=>c.duration!==null).map(c=>c.duration);a.push({key:i,label:i,count:o.length,events:o,expanded:r.has(i),avgDuration:l.length>0?l.reduce((c,d)=>c+d,0)/l.length:0,errorCount:o.filter(c=>!c.statusCode||c.statusCode>=400).length,mockedCount:o.filter(c=>c.isMocked).length})}return a.sort((i,o)=>o.count-i.count),a}function Ca(t){const s=[];for(let r=0;r<t.length;r++){const n=t[r];if(s.push({type:"group-header",group:n,index:r}),n.expanded)for(const a of n.events)s.push({type:"event",event:a,groupKey:n.key})}return s}const Da=48,Oa=56;function Ra({events:t,groupMode:s,selectedId:r,onSelect:n,isSelectMode:a=!1,selectedIds:i=new Set,onToggleSelect:o}){const l=x.useRef(null),[c,d]=x.useState(new Set),u=x.useMemo(()=>Ta(t,s,c),[t,s,c]),h=x.useMemo(()=>Ca(u),[u]),j=rs({count:h.length,getScrollElement:()=>l.current,estimateSize:g=>h[g].type==="group-header"?Da:Oa,overscan:10}),C=x.useCallback(g=>{d(F=>{const E=new Set(F);return E.has(g)?E.delete(g):E.add(g),E})},[]),p=x.useCallback(()=>{d(new Set(u.map(g=>g.key)))},[u]),b=x.useCallback(()=>{d(new Set)},[]);if(s==="none")return null;const D=(g,F)=>{a&&o?(F.preventDefault(),o(g.id)):n(g.id)},k=(g,F)=>e.jsxs("div",{style:F,className:"flex items-center px-4 py-2 bg-bg-light border-b border-border cursor-pointer hover:bg-bg-lighter",onClick:()=>C(g.key),children:[e.jsx("span",{className:"text-lg mr-2",children:g.expanded?"â–¼":"â–¶"}),e.jsx("span",{className:"font-medium text-text-primary flex-1 truncate",children:g.label}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:"px-2 py-1 bg-bg-medium rounded text-text-secondary",children:[g.count," è¯·æ±‚"]}),e.jsxs("span",{className:"px-2 py-1 bg-bg-medium rounded text-text-muted",children:["å¹³å‡ ",Ce(g.avgDuration)]}),g.errorCount>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 rounded text-red-400",children:[g.errorCount," é”™è¯¯"]}),g.mockedCount>0&&e.jsxs("span",{className:"px-2 py-1 bg-purple-500/20 rounded text-purple-400",children:[g.mockedCount," Mock"]})]})]},`group-${g.key}`),w=(g,F)=>{const E=!g.statusCode||g.statusCode>=400,$=g.id===r,q=i.has(g.id);return e.jsxs("div",{style:F,onClick:G=>D(g,G),className:y("flex items-center cursor-pointer transition-all duration-150 group border-b border-border-light pl-8",E&&!$&&"bg-red-500/5 hover:bg-red-500/10",$&&"bg-primary text-white shadow-sm shadow-primary/20",q&&!$&&"bg-primary/15",!$&&!q&&!E&&"hover:bg-bg-light/60"),children:[a&&e.jsx("div",{className:"px-3 py-3.5 w-10 flex-shrink-0",onClick:G=>G.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:q,onChange:()=>o==null?void 0:o(g.id),className:"w-4 h-4 rounded border-border cursor-pointer accent-primary"})}),e.jsx("div",{className:y("px-3 py-3.5 w-[90px] flex-shrink-0",$?"text-white/80":"text-text-muted"),children:e.jsx("span",{className:"text-sm font-mono",children:oe(g.startTime)})}),e.jsx("div",{className:"px-3 py-3.5 w-[80px] flex-shrink-0",children:e.jsx("span",{className:y("inline-flex items-center justify-center px-2 py-1 rounded-lg text-xs font-mono font-bold min-w-[50px] shadow-sm",$?"bg-white/20 text-white":ut(g.method)),children:g.method})}),e.jsx("div",{className:"px-3 py-3.5 w-[70px] flex-shrink-0",children:e.jsx("span",{className:y("inline-flex items-center justify-center px-2 py-1 rounded-lg text-xs font-mono font-semibold min-w-[40px] shadow-sm",$?"bg-white/20 text-white":dt(g.statusCode)),children:g.statusCode??"ERR"})}),e.jsx("div",{className:"px-3 py-3.5 flex-1 min-w-0 overflow-hidden",children:e.jsx("span",{className:y("text-sm truncate",$?"text-white":"text-text-primary"),title:g.url,children:(()=>{try{return new URL(g.url).pathname}catch{return g.url}})()})}),e.jsx("div",{className:"px-3 py-3.5 w-[80px] flex-shrink-0",children:e.jsx("span",{className:y("text-sm font-mono font-medium",$?"text-white":gs(g.duration)),children:Ce(g.duration)})}),e.jsxs("div",{className:"px-3 py-3.5 w-[60px] flex-shrink-0 flex items-center justify-center gap-1",children:[g.isMocked&&e.jsx("span",{className:"text-sm",title:"å·² Mock",children:"ðŸŽ­"}),g.isFavorite&&e.jsx("span",{className:"text-sm text-accent-yellow",title:"å·²æ”¶è—",children:"â˜…"})]})]},g.id)};return e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-bg-medium border-b border-border",children:[e.jsxs("span",{className:"text-sm text-text-secondary",children:[u.length," ä¸ªåˆ†ç»„ï¼Œ",t.length," ä¸ªè¯·æ±‚"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:p,className:"px-2 py-1 text-xs text-text-muted hover:text-text-secondary hover:bg-bg-light rounded",children:"å±•å¼€å…¨éƒ¨"}),e.jsx("button",{onClick:b,className:"px-2 py-1 text-xs text-text-muted hover:text-text-secondary hover:bg-bg-light rounded",children:"æ”¶èµ·å…¨éƒ¨"})]})]}),e.jsx("div",{ref:l,className:"flex-1 overflow-auto",children:h.length>0?e.jsx("div",{style:{height:`${j.getTotalSize()}px`,width:"100%",position:"relative"},children:j.getVirtualItems().map(g=>{const F=h[g.index],E={position:"absolute",top:0,left:0,width:"100%",height:`${g.size}px`,transform:`translateY(${g.start}px)`};return F.type==="group-header"?k(F.group,E):w(F.event,E)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-20",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-bg-light flex items-center justify-center mb-4 border border-border",children:e.jsx("span",{className:"text-3xl opacity-60",children:"ðŸŒ"})}),e.jsx("p",{className:"text-sm font-medium text-text-secondary mb-1",children:"æš‚æ—  HTTP è¯·æ±‚"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç­‰å¾…ç½‘ç»œè¯·æ±‚è¢«æ•èŽ·..."})]})})]})}function bs({data:t,initialExpanded:s=!0,maxInitialDepth:r=2}){return e.jsx("div",{className:"font-mono text-xs",children:e.jsx(ys,{value:t,depth:0,initialExpanded:s,maxInitialDepth:r})})}function ys({keyName:t,value:s,depth:r,initialExpanded:n,maxInitialDepth:a,isLast:i=!0}){const o=n&&r<a,[l,c]=x.useState(o),d=x.useMemo(()=>s===null?"null":Array.isArray(s)?"array":typeof s,[s]),u=d==="object"||d==="array",h=u&&(d==="array"?s.length===0:Object.keys(s).length===0),j=()=>{switch(d){case"string":return e.jsxs("span",{className:"text-emerald-400",children:['"',String(s),'"']});case"number":return e.jsx("span",{className:"text-amber-400",children:String(s)});case"boolean":return e.jsx("span",{className:"text-purple-400",children:String(s)});case"null":return e.jsx("span",{className:"text-gray-500",children:"null"});case"undefined":return e.jsx("span",{className:"text-gray-500",children:"undefined"});default:return null}},C=()=>{const p=d==="array"?s.map((k,w)=>[String(w),k]):Object.entries(s),b=d==="array"?["[","]"]:["{","}"],D=d==="array"?`Array(${s.length})`:`Object(${Object.keys(s).length})`;return h?e.jsxs("span",{className:"text-gray-500",children:[b[0],b[1]]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>c(!l),className:"inline-flex items-center hover:bg-bg-light rounded px-0.5 -ml-0.5",children:[e.jsx("span",{className:"w-4 text-center text-gray-500",children:l?"â–¼":"â–¶"}),!l&&e.jsx("span",{className:"text-gray-500 ml-1",children:D})]}),l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:b[0]}),e.jsx("div",{className:"pl-4 border-l border-border ml-1",children:p.map(([k,w],g)=>e.jsx(ys,{keyName:d==="array"?void 0:k,value:w,depth:r+1,initialExpanded:n,maxInitialDepth:a,isLast:g===p.length-1},k))}),e.jsx("span",{className:"text-gray-400",children:b[1]})]}):null]})};return e.jsxs("div",{className:y("leading-relaxed",!i&&"mb-0.5"),children:[t!==void 0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sky-400",children:t}),e.jsx("span",{className:"text-gray-500",children:": "})]}),u?C():j(),!i&&!l&&e.jsx("span",{className:"text-gray-500",children:","})]})}function Mt({content:t,className:s}){const[r,n]=x.useState("tree"),a=x.useMemo(()=>{try{return JSON.parse(t)}catch{return null}},[t]);return a!==null?e.jsxs("div",{className:s,children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("button",{onClick:()=>n("tree"),className:y("px-2 py-1 text-xs rounded",r==="tree"?"bg-primary text-white":"bg-bg-light text-text-muted hover:bg-bg-lighter"),children:"æ ‘å½¢"}),e.jsx("button",{onClick:()=>n("raw"),className:y("px-2 py-1 text-xs rounded",r==="raw"?"bg-primary text-white":"bg-bg-light text-text-muted hover:bg-bg-lighter"),children:"åŽŸå§‹"})]}),r==="tree"?e.jsx("div",{className:"bg-bg-dark p-3 rounded overflow-x-auto max-h-96 overflow-y-auto",children:e.jsx(bs,{data:a})}):e.jsx("pre",{className:"text-xs font-mono bg-bg-dark p-3 rounded overflow-x-auto whitespace-pre-wrap break-all max-h-96 overflow-y-auto",children:JSON.stringify(a,null,2)})]}):e.jsx("pre",{className:y("text-xs font-mono whitespace-pre-wrap break-all",s),children:t})}function Ia({timing:t,totalDuration:s}){const r=[{label:"DNS",value:t.dnsLookup,color:"bg-cyan-500",description:"DNS è§£æž"},{label:"TCP",value:t.tcpConnection,color:"bg-green-500",description:"TCP è¿žæŽ¥"},{label:"TLS",value:t.tlsHandshake,color:"bg-purple-500",description:"TLS æ¡æ‰‹"},{label:"TTFB",value:t.timeToFirstByte,color:"bg-amber-500",description:"é¦–å­—èŠ‚æ—¶é—´"},{label:"Download",value:t.contentDownload,color:"bg-blue-500",description:"å†…å®¹ä¸‹è½½"}],n=r.reduce((l,c)=>l+(c.value||0),0),a=s||n||1,i=l=>{if(l==null)return"-";const c=l*1e3;return c<1?`${Math.round(c*1e3)}Âµs`:c<1e3?`${Math.round(c)}ms`:`${(c/1e3).toFixed(2)}s`},o=l=>l==null?0:l/a*100;return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:r.map(l=>{const c=o(l.value);return l.value===null?null:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-xs text-text-muted shrink-0",children:l.label}),e.jsxs("div",{className:"flex-1 h-5 bg-bg-dark rounded overflow-hidden relative",children:[e.jsx("div",{className:`h-full ${l.color} transition-all duration-300`,style:{width:`${Math.max(c,1)}%`}}),e.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs font-mono",children:i(l.value)})]}),e.jsxs("div",{className:"w-12 text-xs text-text-muted text-right shrink-0",children:[c.toFixed(1),"%"]})]},l.label)})}),e.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-border",children:[e.jsx("div",{className:"w-16 text-xs font-medium shrink-0",children:"Total"}),e.jsx("div",{className:"flex-1 text-xs font-mono text-primary",children:i(a)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t border-border text-xs",children:[t.protocolName&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"åè®®:"})," ",e.jsx("span",{className:"font-mono text-primary",children:t.protocolName})]}),t.connectionReused!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"è¿žæŽ¥å¤ç”¨:"})," ",e.jsx("span",{className:t.connectionReused?"text-green-400":"text-yellow-400",children:t.connectionReused?"æ˜¯":"å¦"})]}),t.localAddress&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"æœ¬åœ°åœ°å€:"})," ",e.jsx("span",{className:"font-mono",children:t.localAddress})]}),t.remoteAddress&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"è¿œç¨‹åœ°å€:"})," ",e.jsx("span",{className:"font-mono",children:t.remoteAddress})]}),t.requestBodyBytesSent!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"å‘é€:"})," ",e.jsx("span",{className:"font-mono",children:Ae(t.requestBodyBytesSent)})]}),t.responseBodyBytesReceived!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"æŽ¥æ”¶:"})," ",e.jsx("span",{className:"font-mono",children:Ae(t.responseBodyBytesReceived)})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3 pt-2 border-t border-border",children:r.map(l=>e.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[e.jsx("div",{className:`w-3 h-3 rounded ${l.color}`}),e.jsx("span",{className:"text-text-muted",children:l.description})]},l.label))})]})}function Pa({base64Data:t,contentType:s,className:r=""}){const[n,a]=x.useState(!1),[i,o]=x.useState(!1),l=x.useMemo(()=>{const c=Fa(s);return c?`data:${c};base64,${t}`:null},[t,s]);return!l||i?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`relative ${r}`,children:[e.jsx("img",{src:l,alt:"Response preview",className:"image-preview cursor-pointer",onClick:()=>a(!0),onError:()=>o(!0)}),e.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[e.jsx("button",{onClick:()=>a(!0),className:"p-1.5 bg-bg-dark/80 rounded-lg hover:bg-bg-dark transition-colors",title:"å…¨å±é¢„è§ˆ",children:e.jsx(La,{className:"w-4 h-4"})}),e.jsx("a",{href:l,download:"response-image",className:"p-1.5 bg-bg-dark/80 rounded-lg hover:bg-bg-dark transition-colors",title:"ä¸‹è½½å›¾ç‰‡",children:e.jsx(_a,{className:"w-4 h-4"})})]})]}),n&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",onClick:()=>a(!1),children:[e.jsx("button",{className:"absolute top-4 right-4 p-2 text-white/70 hover:text-white transition-colors",onClick:()=>a(!1),children:e.jsx(Aa,{className:"w-6 h-6"})}),e.jsx("img",{src:l,alt:"Response preview fullscreen",className:"max-w-[90vw] max-h-[90vh] object-contain",onClick:c=>c.stopPropagation()})]})]})}function Ma(t){if(!t)return!1;const s=t.toLowerCase();return s.startsWith("image/")||s.includes("image/png")||s.includes("image/jpeg")||s.includes("image/gif")||s.includes("image/webp")||s.includes("image/svg+xml")||s.includes("image/bmp")||s.includes("image/ico")}function Fa(t){if(!t)return null;const s=t.split(";")[0].trim().toLowerCase();return["image/png","image/jpeg","image/jpg","image/gif","image/webp","image/svg+xml","image/bmp","image/x-icon","image/ico"].some(n=>s.includes(n)||s===n)||s.startsWith("image/")?s:null}function La({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}function _a({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}function Aa({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function Ft(t){if(!t)return!1;const s=t.toLowerCase();return s.includes("application/x-protobuf")||s.includes("application/protobuf")||s.includes("application/grpc")||s.includes("application/grpc+proto")||s.includes("application/octet-stream")}function Lt(t){const s=atob(t),r=new Uint8Array(s.length);for(let n=0;n<s.length;n++)r[n]=s.charCodeAt(n);return r}function Je(t,s){let r=0n,n=0n,a=0;for(;s+a<t.length;){const i=t[s+a];if(r|=BigInt(i&127)<<n,a++,!(i&128))break;if(n+=7n,a>10)throw new Error("Varint too long")}return{value:r,bytesRead:a}}function vs(t){const s=[],r=[];let n=0;for(;n<t.length;)try{const a=n,{value:i,bytesRead:o}=Je(t,n);n+=o;const l=Number(i>>3n),c=Number(i&0x7n);if(l===0){r.push(`Invalid field number 0 at offset ${a}`);break}let d,u;switch(c){case 0:{const{value:h,bytesRead:j}=Je(t,n);d=h,n+=j,u=n-a;break}case 1:{if(n+8>t.length)throw new Error("Unexpected end of data for Fixed64");d=new DataView(t.buffer,t.byteOffset+n,8).getBigUint64(0,!0),n+=8,u=n-a;break}case 2:{const{value:h,bytesRead:j}=Je(t,n);n+=j;const C=Number(h);if(n+C>t.length)throw new Error(`Length-delimited field extends beyond data: ${C} bytes at offset ${n}`);const p=t.slice(n,n+C);d=$a(p),n+=C,u=n-a;break}case 5:{if(n+4>t.length)throw new Error("Unexpected end of data for Fixed32");d=new DataView(t.buffer,t.byteOffset+n,4).getUint32(0,!0),n+=4,u=n-a;break}case 3:case 4:r.push(`Deprecated wire type ${c} at field ${l}`),n=t.length,u=0;break;default:throw new Error(`Unknown wire type ${c}`)}s.push({fieldNumber:l,wireType:c,value:d,rawBytes:t.slice(a,n),offset:a,length:u})}catch(a){r.push(`Parse error at offset ${n}: ${a instanceof Error?a.message:String(a)}`);break}return{fields:s,errors:r}}function $a(t){try{const r=new TextDecoder("utf-8",{fatal:!0}).decode(t);if(Ba(r))return{type:"string",value:r}}catch{}if(t.length>0)try{const s=vs(t);if(s.fields.length>0&&s.errors.length===0&&s.fields.reduce((n,a)=>n+a.length,0)===t.length)return{type:"nested",value:s.fields}}catch{}return{type:"bytes",value:t}}function Ba(t){if(t.length===0)return!1;let s=0;for(const r of t){const n=r.charCodeAt(0);(n>=32&&n<127||n>127)&&s++}return s/t.length>.9}function Ha(t,s=32){const r=Array.from(t.slice(0,s)).map(n=>n.toString(16).padStart(2,"0")).join(" ");return t.length>s?`${r} ... (${t.length} bytes)`:r}function Wa(t){const s=Number(t),r=[];r.push(`uint: ${t}`);const n=Number(t>>1n^-(t&1n));if(n!==s&&r.push(`sint: ${n}`),(t===0n||t===1n)&&r.push(`bool: ${t===1n}`),s>1e9&&s<2e9){const a=new Date(s*1e3);r.push(`timestamp(s): ${a.toISOString()}`)}else if(s>1e12&&s<2e12){const a=new Date(s);r.push(`timestamp(ms): ${a.toISOString()}`)}return e.jsx("span",{className:"text-xs",children:r.map((a,i)=>e.jsx("span",{className:i===0?"text-green-400":"text-text-muted ml-2",children:a},i))})}function za(t){switch(t){case 0:return"Varint";case 1:return"Fixed64";case 2:return"Length-Delimited";case 5:return"Fixed32";case 3:return"StartGroup (deprecated)";case 4:return"EndGroup (deprecated)";default:return"Unknown"}}function et({base64Data:t,contentType:s,className:r}){const[n,a]=x.useState(new Set),[i,o]=x.useState("parsed"),l=x.useMemo(()=>{try{const u=Lt(t);return vs(u)}catch(u){return{fields:[],errors:[`Failed to decode base64: ${u instanceof Error?u.message:String(u)}`]}}},[t]),c=x.useMemo(()=>{try{return Lt(t)}catch{return new Uint8Array}},[t]),d=u=>{const h=new Set(n);h.has(u)?h.delete(u):h.add(u),a(h)};return e.jsxs("div",{className:y("bg-bg-dark rounded-lg overflow-hidden",r),children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-bg-darker border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-purple-400",children:"ðŸ“¦ Protobuf"}),s&&e.jsx("span",{className:"text-xs text-text-muted",children:s}),e.jsxs("span",{className:"text-xs text-text-muted",children:["(",c.length," bytes)"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>o("parsed"),className:y("px-2 py-1 text-xs rounded transition-colors",i==="parsed"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-primary"),children:"Parsed"}),e.jsx("button",{onClick:()=>o("hex"),className:y("px-2 py-1 text-xs rounded transition-colors",i==="hex"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-primary"),children:"Hex"})]})]}),e.jsxs("div",{className:"p-3 max-h-96 overflow-auto",children:[l.errors.length>0&&e.jsx("div",{className:"mb-3 p-2 bg-red-500/10 border border-red-500/30 rounded text-xs text-red-400",children:l.errors.map((u,h)=>e.jsx("div",{children:u},h))}),i==="parsed"?l.fields.length>0?e.jsx(js,{fields:l.fields,expandedFields:n,toggleField:d}):e.jsx("div",{className:"text-text-muted text-xs",children:"æ— æ³•è§£æžä¸ºæœ‰æ•ˆçš„ Protobuf æ¶ˆæ¯"}):e.jsx(qa,{bytes:c})]})]})}function js({fields:t,expandedFields:s,toggleField:r,prefix:n=""}){return e.jsx("div",{className:"space-y-1 font-mono text-xs",children:t.map((a,i)=>{const o=`${n}${a.fieldNumber}-${i}`,l=s.has(o),c=typeof a.value=="object"&&a.value!==null&&"type"in a.value&&a.value.type==="nested";return e.jsxs("div",{className:"border-l-2 border-border pl-2",children:[e.jsxs("div",{className:y("flex items-start gap-2 py-1",c&&"cursor-pointer hover:bg-bg-lighter rounded"),onClick:c?()=>r(o):void 0,children:[c&&e.jsx("span",{className:"text-text-muted",children:l?"â–¼":"â–¶"}),e.jsxs("span",{className:"text-yellow-400",children:["field ",a.fieldNumber]}),e.jsxs("span",{className:"text-text-muted",children:["(",za(a.wireType),")"]}),e.jsx("span",{className:"text-text-muted",children:"="}),e.jsx(Ua,{field:a,expanded:l})]}),c&&l&&e.jsx("div",{className:"ml-4 mt-1",children:e.jsx(js,{fields:a.value.value,expandedFields:s,toggleField:r,prefix:`${o}-`})})]},o)})})}function Ua({field:t,expanded:s}){const{wireType:r,value:n}=t;if(r===0)return Wa(n);if(r===5){const a=n,i=new DataView(new Uint32Array([a]).buffer).getFloat32(0,!0);return e.jsxs("span",{className:"text-xs",children:[e.jsxs("span",{className:"text-green-400",children:["uint32: ",a]}),!isNaN(i)&&isFinite(i)&&e.jsxs("span",{className:"text-text-muted ml-2",children:["float: ",i.toFixed(4)]})]})}if(r===1){const a=n;return e.jsx("span",{className:"text-xs",children:e.jsxs("span",{className:"text-green-400",children:["uint64: ",a.toString()]})})}if(r===2&&typeof n=="object"&&n!==null&&"type"in n){const a=n;if(a.type==="string"){const i=String(a.value);return e.jsxs("span",{className:"text-green-400",children:['"',i.length>100?i.slice(0,100)+"...":i,'"']})}if(a.type==="nested"){const i=a.value;return s?null:e.jsx("span",{className:"text-blue-400",children:`{ ${i.length} fields }`})}if(a.type==="bytes"){const i=a.value;return e.jsxs("span",{className:"text-text-muted",children:["[",Ha(i),"]"]})}}return e.jsx("span",{className:"text-text-muted",children:"?"})}function qa({bytes:t}){const s=[];for(let n=0;n<t.length;n+=16){const a=t.slice(n,n+16),i=Array.from(a).map(l=>l.toString(16).padStart(2,"0")).join(" "),o=Array.from(a).map(l=>l>=32&&l<127?String.fromCharCode(l):".").join("");s.push(e.jsxs("div",{className:"flex gap-4 font-mono text-xs",children:[e.jsx("span",{className:"text-text-muted w-12",children:n.toString(16).padStart(8,"0")}),e.jsx("span",{className:"text-green-400 flex-1",children:i.padEnd(47," ")}),e.jsx("span",{className:"text-yellow-400",children:o})]},n))}return e.jsx("div",{className:"space-y-0.5",children:s})}function Ya({event:t,deviceId:s,onShowRelatedLogs:r,onFavoriteChange:n}){var Q,I,T,m,N,f;const[a,i]=x.useState("headers"),[o,l]=x.useState(null),[c,d]=x.useState(!1),[u,h]=x.useState(!1),[j,C]=x.useState(null),[p,b]=x.useState((t==null?void 0:t.isFavorite)??!1),[D,k]=x.useState(!1);if(t&&t.isFavorite!==p&&!D&&b(t.isFavorite),!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ðŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:"é€‰æ‹©ä¸€ä¸ªè¯·æ±‚æŸ¥çœ‹è¯¦æƒ…"})]});const w=t.requestBody?Pt(t.requestBody):null,g=t.responseBody?Pt(t.responseBody):null,F=((Q=t.responseHeaders)==null?void 0:Q["Content-Type"])||((I=t.responseHeaders)==null?void 0:I["content-type"]),E=Ma(F),$=Ft(F),q=((T=t.requestHeaders)==null?void 0:T["Content-Type"])||((m=t.requestHeaders)==null?void 0:m["content-type"]),G=Ft(q),Y=async()=>{if(o){await navigator.clipboard.writeText(o),h(!0),setTimeout(()=>h(!1),2e3);return}d(!0);try{const S=await Js(s,t.id);l(S.curl),await navigator.clipboard.writeText(S.curl),h(!0),setTimeout(()=>h(!1),2e3)}catch(S){console.error("Failed to generate cURL:",S)}finally{d(!1)}},_=async()=>{C("sending...");try{const S=await Qs(s,t.id);C(`âœ“ ${S.status}`),setTimeout(()=>C(null),3e3)}catch{C("âœ— failed"),setTimeout(()=>C(null),3e3)}},z=async()=>{k(!0);try{const S=await Ks(s,t.id);b(S.isFavorite),n==null||n(t.id,S.isFavorite)}catch(S){console.error("Failed to toggle favorite:",S)}finally{k(!1)}};return e.jsxs("div",{className:"h-full overflow-auto",children:[e.jsxs("div",{className:"p-4 bg-bg-dark border-b border-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium break-all flex-1",children:t.url}),e.jsx("button",{onClick:z,disabled:D,className:y("ml-2 p-1.5 rounded transition-colors",p?"text-yellow-400 hover:text-yellow-300":"text-text-muted hover:text-yellow-400"),title:p?"å–æ¶ˆæ”¶è—":"æ”¶è—",children:p?e.jsx(Va,{className:"w-5 h-5"}):e.jsx(Ga,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs mb-3",children:[e.jsx("span",{className:y("px-1.5 py-0.5 rounded font-mono",ut(t.method)),children:t.method}),e.jsx("span",{className:y("px-1.5 py-0.5 rounded font-mono",dt(t.statusCode)),children:t.statusCode??"ERR"}),e.jsx("span",{className:"text-text-muted",children:Ce(t.duration)}),t.isMocked&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-400",children:"ðŸŽ­ Mocked"}),((N=t.timing)==null?void 0:N.protocolName)&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-primary/20 text-primary",children:t.timing.protocolName}),((f=t.timing)==null?void 0:f.connectionReused)&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-green-500/20 text-green-400",children:"å¤ç”¨è¿žæŽ¥"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Y,disabled:c,className:"px-3 py-1.5 bg-bg-light border border-border-subtle rounded text-xs hover:bg-bg-lighter transition-colors disabled:opacity-50",children:c?"ç”Ÿæˆä¸­...":u?"âœ“ å·²å¤åˆ¶":"ðŸ“‹ å¤åˆ¶ cURL"}),e.jsx("button",{onClick:_,disabled:j!==null,className:"px-3 py-1.5 bg-bg-light border border-border-subtle rounded text-xs hover:bg-bg-lighter transition-colors disabled:opacity-50",children:j||"ðŸ”„ é‡æ”¾è¯·æ±‚"})]}),t.traceId&&e.jsxs("div",{className:"mt-2 text-xs text-text-muted",children:["TraceId: ",e.jsx("span",{className:"font-mono text-text-primary",children:t.traceId})]})]}),e.jsxs("div",{className:"flex border-b border-border bg-bg-dark",children:[e.jsx(Ie,{active:a==="headers",onClick:()=>i("headers"),children:"Headers"}),e.jsx(Ie,{active:a==="params",onClick:()=>i("params"),children:"Params"}),e.jsx(Ie,{active:a==="body",onClick:()=>i("body"),children:"Body"}),t.timing&&e.jsx(Ie,{active:a==="timing",onClick:()=>i("timing"),children:"Timing"})]}),e.jsxs("div",{className:"p-4",children:[a==="headers"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ce,{title:"è¯·æ±‚å¤´",children:e.jsx(Pe,{headers:t.requestHeaders})}),t.responseHeaders&&e.jsx(ce,{title:"å“åº”å¤´",children:e.jsx(Pe,{headers:t.responseHeaders})})]}),a==="params"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ce,{title:"Query Params",children:e.jsx(Pe,{headers:t.queryItems||{}})}),e.jsxs(ce,{title:"Body Params",children:[e.jsx(Pe,{headers:t.bodyParams||{}}),!t.bodyParams&&e.jsx("div",{className:"text-text-muted text-sm",children:"æ— è§£æžåŽçš„ Body å‚æ•°"})]})]}),a==="body"&&e.jsxs("div",{className:"space-y-6",children:[t.requestBody&&e.jsx(ce,{title:"è¯·æ±‚ä½“",children:G?e.jsx(et,{base64Data:t.requestBody,contentType:q}):e.jsx(Mt,{content:w??""})}),t.responseBody&&e.jsx(ce,{title:"å“åº”ä½“",children:E?e.jsx(Pa,{base64Data:t.responseBody,contentType:F??null}):$?e.jsx(et,{base64Data:t.responseBody,contentType:F}):e.jsx(Mt,{content:g??""})}),!t.requestBody&&!t.responseBody&&e.jsx("div",{className:"text-text-muted text-sm",children:"æ— è¯·æ±‚ä½“æˆ–å“åº”ä½“"}),t.errorDescription&&e.jsx(ce,{title:"é”™è¯¯ä¿¡æ¯",children:e.jsx("pre",{className:"text-xs font-mono bg-bg-dark p-3 rounded text-red-400",children:t.errorDescription})})]}),a==="timing"&&t.timing&&e.jsx(ce,{title:"æ€§èƒ½æ—¶é—´çº¿",children:e.jsx(Ia,{timing:t.timing,totalDuration:t.duration})})]}),t.traceId&&r&&e.jsx("div",{className:"p-4 border-t border-border",children:e.jsx("button",{onClick:()=>r(t.traceId),className:"px-3 py-1.5 bg-bg-light border border-border rounded text-sm hover:bg-bg-lighter transition-colors",children:"æŸ¥çœ‹ TraceId å…³è”æ—¥å¿—"})})]})}function Ie({active:t,onClick:s,children:r}){return e.jsx("button",{onClick:s,className:y("px-4 py-2 text-xs font-medium transition-colors",t?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-primary"),children:r})}function ce({title:t,children:s}){return e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs uppercase text-text-muted mb-2",children:t}),s]})}function Pe({headers:t}){const s=Object.entries(t);return s.length===0?e.jsx("span",{className:"text-text-muted text-sm",children:"æ— "}):e.jsx("table",{className:"w-full text-xs font-mono",children:e.jsx("tbody",{children:s.map(([r,n])=>e.jsxs("tr",{className:"border-b border-border/50 last:border-0",children:[e.jsx("td",{className:"py-1.5 pr-4 text-primary align-top whitespace-nowrap",children:r}),e.jsx("td",{className:"py-1.5 break-all",children:n})]},r))})})}function Va({className:t=""}){return e.jsx("svg",{className:t,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}function Ga({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})}const Ja={verbose:"VERBOSE",debug:"DEBUG",info:"INFO",warning:"WARN",error:"ERROR"};function Qa({events:t,autoScroll:s}){const r=x.useRef(null);return x.useEffect(()=>{s&&r.current&&t.length>0&&(r.current.scrollTop=0)},[t.length,s]),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 bg-bg-medium border-b border-border",children:e.jsxs("div",{className:"flex items-center text-xs font-semibold text-text-secondary uppercase tracking-wider",children:[e.jsx("div",{className:"w-32 px-4 py-3.5",children:"æ—¶é—´"}),e.jsx("div",{className:"w-24 px-4 py-3.5",children:"çº§åˆ«"}),e.jsx("div",{className:"w-36 px-4 py-3.5",children:"åˆ†ç±»"}),e.jsx("div",{className:"flex-1 px-4 py-3.5",children:"æ¶ˆæ¯å†…å®¹"})]})}),e.jsxs("div",{ref:r,className:"flex-1 overflow-auto font-mono text-sm",children:[t.map((n,a)=>{const i=Na(n.level);return e.jsxs("div",{className:y("flex items-start border-l-2 transition-all duration-150 hover:bg-bg-light/60",i.border,a%2===0?"bg-bg-dark/20":"bg-transparent"),style:{animationDelay:`${Math.min(a*10,300)}ms`},children:[e.jsx("div",{className:"w-32 px-4 py-3 text-text-muted whitespace-nowrap flex-shrink-0 text-xs",children:oe(n.timestamp)}),e.jsx("div",{className:"w-24 px-4 py-2.5 flex-shrink-0",children:e.jsx("span",{className:y("inline-flex items-center justify-center px-2.5 py-1 rounded-lg text-2xs font-bold shadow-sm",i.bg,i.color),children:Ja[n.level]})}),e.jsx("div",{className:"w-36 px-4 py-3 text-primary truncate flex-shrink-0 text-xs font-medium",title:n.category||n.subsystem||"-",children:n.category||n.subsystem||"-"}),e.jsx("div",{className:"flex-1 px-4 py-3 text-text-primary break-all whitespace-pre-wrap leading-relaxed text-xs",children:n.message})]},n.id)}),t.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-20",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-bg-light/50 flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-3xl opacity-60",children:"ðŸ“"})}),e.jsx("p",{className:"text-sm font-medium text-text-secondary mb-1",children:"æš‚æ— æ—¥å¿—"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç­‰å¾…æ—¥å¿—äº‹ä»¶åˆ°è¾¾..."})]})]})]})}const Ka=[{level:"error",label:"Error",emoji:"âŒ",bgClass:"bg-level-error",textClass:"text-white"},{level:"warning",label:"Warning",emoji:"âš ï¸",bgClass:"bg-level-warning",textClass:"text-white"},{level:"info",label:"Info",emoji:"â„¹ï¸",bgClass:"bg-level-info",textClass:"text-white"},{level:"debug",label:"Debug",emoji:"ðŸ”",bgClass:"bg-level-debug",textClass:"text-white"},{level:"verbose",label:"Verbose",emoji:"ðŸ“",bgClass:"bg-level-verbose",textClass:"text-white"}],_t={verbose:0,debug:1,info:2,warning:3,error:4};function Xa({minLevel:t,subsystems:s,categories:r,selectedSubsystem:n,selectedCategory:a,searchText:i,searchQuery:o,onMinLevelChange:l,onSubsystemChange:c,onCategoryChange:d,onSearchChange:u,onSearchQueryChange:h}){const[j,C]=x.useState(!1),[p,b]=x.useState(!1),D=x.useRef(null),k=_t[t];return x.useEffect(()=>{function w(g){D.current&&!D.current.contains(g.target)&&b(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx("div",{className:"flex gap-1",children:Ka.map(({level:w,label:g,emoji:F,bgClass:E,textClass:$})=>{const q=w===t,Y=_t[w]>=k;return e.jsxs("button",{onClick:()=>l(w),title:`æ˜¾ç¤º ${g} åŠæ›´é«˜çº§åˆ«æ—¥å¿—`,className:y("flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-medium transition-all",q?`${E} ${$} shadow-sm`:Y?`${E}/30 ${$.replace("text-white","text-"+w.replace("level-",""))}`:"bg-bg-light/50 text-text-muted hover:bg-bg-light border border-transparent opacity-50"),children:[e.jsx("span",{children:F}),e.jsx("span",{children:g})]},w)})}),e.jsx("div",{className:"w-px h-6 bg-border"}),e.jsxs("select",{value:n,onChange:w=>c(w.target.value),className:"select text-sm",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰ Subsystem"}),s.map(w=>e.jsx("option",{value:w,children:w},w))]}),e.jsxs("select",{value:a,onChange:w=>d(w.target.value),className:"select text-sm",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰ Category"}),r.map(w=>e.jsx("option",{value:w,children:w},w))]}),e.jsxs("div",{className:"flex-1 flex items-center gap-2 min-w-[200px] max-w-[600px]",children:[e.jsx("button",{onClick:()=>C(!j),className:y("px-2 py-1.5 rounded-lg text-xs font-medium transition-colors whitespace-nowrap",j?"bg-primary text-white":"bg-bg-light text-text-muted hover:text-text-secondary"),title:"åˆ‡æ¢é«˜çº§æœç´¢",children:j?"é«˜çº§":"ç®€å•"}),j?e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:o,onChange:w=>h(w.target.value),placeholder:"level:error subsystem:Network message:timeout...",className:"input w-full font-mono text-sm"}),e.jsx("button",{onClick:()=>b(!p),className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-secondary",title:"æœç´¢è¯­æ³•å¸®åŠ©",children:"?"}),p&&e.jsxs("div",{ref:D,className:"absolute top-full right-0 mt-2 w-80 p-3 bg-bg-dark border border-border rounded-lg shadow-xl z-50",children:[e.jsx("h4",{className:"text-sm font-semibold text-text-primary mb-2",children:"æœç´¢è¯­æ³•"}),e.jsx("pre",{className:"text-xs text-text-secondary whitespace-pre-wrap font-mono",children:Sr})]})]}):e.jsx("input",{type:"text",value:i,onChange:w=>u(w.target.value),placeholder:"ðŸ” æœç´¢æ—¥å¿—å†…å®¹...",className:"input flex-1"})]})]})}const Za=[{category:"å¯¼èˆª",items:[{keys:["â†‘","â†“"],description:"ä¸Š/ä¸‹é€‰æ‹©è¯·æ±‚"},{keys:["Enter"],description:"æŸ¥çœ‹è¯¦æƒ…"},{keys:["Esc"],description:"å–æ¶ˆé€‰æ‹©/å…³é—­é¢æ¿"}]},{category:"æ“ä½œ",items:[{keys:["âŒ˜/Ctrl","K"],description:"æœç´¢"},{keys:["âŒ˜/Ctrl","R"],description:"åˆ·æ–°åˆ—è¡¨"},{keys:["âŒ˜/Ctrl","L"],description:"æ¸…ç©ºåˆ—è¡¨"},{keys:["âŒ˜/Ctrl","E"],description:"å¯¼å‡ºæ•°æ®"},{keys:["âŒ˜/Ctrl","A"],description:"å…¨é€‰"}]},{category:"æ”¶è—ä¸Žåˆ é™¤",items:[{keys:["F"],description:"æ”¶è—/å–æ¶ˆæ”¶è—é€‰ä¸­é¡¹"},{keys:["Delete","/","Backspace"],description:"åˆ é™¤é€‰ä¸­é¡¹"}]},{category:"ç•Œé¢",items:[{keys:["âŒ˜/Ctrl","T"],description:"åˆ‡æ¢ä¸»é¢˜"},{keys:["âŒ˜/Ctrl","/"],description:"æ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©"}]}];function ei({isOpen:t,onClose:s}){return x.useEffect(()=>{const r=n=>{n.key==="Escape"&&s()};if(t)return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t,s]),t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative bg-bg-dark border border-border rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"é”®ç›˜å¿«æ·é”®"}),e.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-bg-light transition-colors text-text-muted hover:text-text-primary",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6 overflow-auto max-h-[60vh]",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Za.map(r=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted mb-3",children:r.category}),e.jsx("div",{className:"space-y-2",children:r.items.map((n,a)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:n.description}),e.jsx("div",{className:"flex items-center gap-1",children:n.keys.map((i,o)=>e.jsxs("span",{className:"flex items-center",children:[e.jsx("kbd",{className:"kbd",children:i}),o<n.keys.length-1&&e.jsx("span",{className:"mx-1 text-text-muted text-xs",children:"+"})]},o))})]},a))})]},r.category))})}),e.jsx("div",{className:"px-6 py-3 border-t border-border bg-bg-medium/50 text-center",children:e.jsxs("span",{className:"text-xs text-text-muted",children:["æŒ‰ ",e.jsx("kbd",{className:"kbd",children:"Esc"})," å…³é—­"]})})]})]}):null}function ti({sessions:t,selectedId:s,onSelect:r,loading:n,autoScroll:a,isSelectMode:i=!1,selectedIds:o=new Set,onToggleSelect:l}){const c=x.useRef(null),d=x.useRef(null);return x.useEffect(()=>{var h;if(!a||t.length===0)return;const u=(h=t[0])==null?void 0:h.id;u&&u!==d.current&&c.current&&(c.current.scrollTop=0),d.current=u},[t,a]),t.length===0&&!n?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-12",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ðŸ”Œ"}),e.jsx("p",{className:"text-sm",children:"æš‚æ—  WebSocket ä¼šè¯"}),e.jsx("p",{className:"text-xs mt-1 text-text-muted",children:"å½“è®¾å¤‡å»ºç«‹ WebSocket è¿žæŽ¥æ—¶ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ"})]}):e.jsxs("div",{ref:c,className:"overflow-auto h-full",children:[e.jsx("div",{className:"divide-y divide-border/50",children:t.map(u=>e.jsx(si,{session:u,isSelected:s===u.id,isChecked:o.has(u.id),isSelectMode:i,onSelect:r,onToggleSelect:l},u.id))}),n&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-primary border-t-transparent rounded-full"})})]})}const si=x.memo(function({session:s,isSelected:r,isChecked:n,isSelectMode:a,onSelect:i,onToggleSelect:o}){const l=s.disconnectTime?Ce(new Date(s.connectTime),new Date(s.disconnectTime)):null,c=()=>{a&&o?o(s.id):i(s.id)};return e.jsxs("div",{onClick:c,className:y("px-4 py-3 cursor-pointer transition-all","hover:bg-bg-light/50",r&&!a?"bg-primary text-white shadow-sm shadow-primary/20":"",!r&&"border-l-2 border-l-transparent",a&&n&&"bg-primary/15"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a?e.jsx("input",{type:"checkbox",checked:n,onChange:()=>o==null?void 0:o(s.id),onClick:d=>d.stopPropagation(),className:"w-4 h-4 rounded border-border bg-bg-light text-primary focus:ring-primary/50 cursor-pointer"}):e.jsx(ri,{isOpen:s.isOpen,isSelectedRow:r&&!a}),e.jsx("span",{className:y("font-mono text-sm truncate flex-1",r&&!a?"text-inherit":"text-text-primary"),children:ct(s.url)}),e.jsx("span",{className:y("text-xs",r&&!a?"text-white/70":"text-text-muted"),children:oe(s.connectTime)})]}),e.jsx("div",{className:y("text-xs truncate font-mono ml-5",r&&!a?"text-white/70":"text-text-muted"),children:s.url}),e.jsx("div",{className:"flex items-center gap-3 mt-1.5 ml-5",children:s.isOpen?e.jsxs("span",{className:y("inline-flex items-center gap-1 text-xs",r&&!a?"text-green-200":"text-green-400"),children:[e.jsx("span",{className:y("w-1.5 h-1.5 rounded-full animate-pulse",r&&!a?"bg-green-200":"bg-green-400")}),"è¿žæŽ¥ä¸­"]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:y("text-xs",r&&!a?"text-white/70":"text-text-muted"),children:["å·²å…³é—­",s.closeCode?` (${s.closeCode})`:""]}),l&&e.jsxs("span",{className:y("text-xs",r&&!a?"text-white/70":"text-text-muted"),children:["æŒç»­ ",l]})]})})]})});function ri({isOpen:t,isSelectedRow:s}){return e.jsx("span",{className:y("w-3 h-3 rounded-full flex-shrink-0",t?s?"bg-green-300 shadow-green-300/50 shadow-sm":"bg-green-500 shadow-green-500/50 shadow-sm":s?"bg-gray-300":"bg-gray-500")})}function ni({deviceId:t,session:s,frames:r,loading:n,onLoadMore:a,hasMore:i,frameDirection:o,onFrameDirectionChange:l}){const[c,d]=x.useState("frames"),[u,h]=x.useState(null);return s?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/50",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ”Œ"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-mono text-sm text-text-primary truncate",children:s.url}),e.jsxs("p",{className:"text-xs text-text-muted",children:[s.frameCount," å¸§ â€¢ è¿žæŽ¥äºŽ ",oe(s.connectTime)]})]}),e.jsx(ai,{isOpen:!s.disconnectTime,closeCode:s.closeCode})]})}),e.jsxs("div",{className:"px-4 py-2 border-b border-border bg-bg-dark flex gap-2",children:[e.jsxs("button",{onClick:()=>d("frames"),className:y("px-3 py-1.5 text-xs font-medium rounded-lg transition-all",c==="frames"?"bg-primary/20 text-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-light"),children:["ðŸ“¨ æ¶ˆæ¯å¸§ (",s.frameCount,")"]}),e.jsx("button",{onClick:()=>d("info"),className:y("px-3 py-1.5 text-xs font-medium rounded-lg transition-all",c==="info"?"bg-primary/20 text-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-light"),children:"â„¹ï¸ è¿žæŽ¥ä¿¡æ¯"})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[c==="frames"&&e.jsx(ii,{deviceId:t,sessionId:s.id,frames:r,loading:n,onLoadMore:a,hasMore:i,expandedFrameId:u,onToggleExpand:h,direction:o,onDirectionChange:l}),c==="info"&&e.jsx(ci,{session:s})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ðŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:"é€‰æ‹©ä¸€ä¸ª WebSocket ä¼šè¯æŸ¥çœ‹è¯¦æƒ…"})]})}function ai({isOpen:t,closeCode:s}){return t?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded-full bg-green-500/10 text-green-400 border border-green-500/20",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"}),"è¿žæŽ¥ä¸­"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded-full bg-text-muted/10 text-text-muted border border-border",children:["å·²å…³é—­",s?` (${s})`:""]})}function ii({deviceId:t,sessionId:s,frames:r,loading:n,onLoadMore:a,hasMore:i,expandedFrameId:o,onToggleExpand:l,direction:c,onDirectionChange:d}){const u=x.useRef(null),[h,j]=x.useState(!0),C=x.useRef(r.length);x.useEffect(()=>{!h||!u.current||(r.length>C.current&&(u.current.scrollTop=u.current.scrollHeight),C.current=r.length)},[r.length,h]);const p=r.filter(k=>k.direction==="send").length,b=r.filter(k=>k.direction==="receive").length,D=r.reduce((k,w)=>k+(w.payloadSize||0),0);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-border/50 flex items-center justify-between gap-3 bg-bg-dark/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-bg-light/50 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>d(""),className:y("px-2 py-1 text-xs rounded transition-colors",c?"text-text-muted hover:text-text-primary":"bg-bg-dark text-text-primary"),children:"å…¨éƒ¨"}),e.jsxs("button",{onClick:()=>d("send"),className:y("px-2 py-1 text-xs rounded transition-colors flex items-center gap-1",c==="send"?"bg-blue-500/20 text-blue-400":"text-text-muted hover:text-blue-400"),children:[e.jsx("span",{children:"â†‘"})," å‘é€"]}),e.jsxs("button",{onClick:()=>d("receive"),className:y("px-2 py-1 text-xs rounded transition-colors flex items-center gap-1",c==="receive"?"bg-green-500/20 text-green-400":"text-text-muted hover:text-green-400"),children:[e.jsx("span",{children:"â†“"})," æŽ¥æ”¶"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[e.jsxs("span",{className:"text-blue-400",children:["â†‘",p]}),e.jsxs("span",{className:"text-green-400",children:["â†“",b]}),e.jsxs("span",{children:["â€¢ ",Ae(D)]})]})]}),e.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:k=>j(k.target.checked),className:"accent-primary w-3 h-3"}),"è‡ªåŠ¨æ»šåŠ¨"]})]}),e.jsxs("div",{ref:u,className:"flex-1 overflow-auto",children:[r.length===0&&!n?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-8",children:[e.jsx("span",{className:"text-3xl mb-2 opacity-50",children:"ðŸ“­"}),e.jsx("p",{className:"text-sm",children:"æš‚æ— æ¶ˆæ¯å¸§"})]}):e.jsx("div",{className:"divide-y divide-border/30",children:r.map(k=>e.jsx(oi,{deviceId:t,sessionId:s,frame:k,isExpanded:o===k.id,onToggle:()=>l(o===k.id?null:k.id)},k.id))}),i&&e.jsx("div",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:a,disabled:n,className:"btn btn-secondary text-xs",children:n?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"})})]})]})}const oi=x.memo(function({deviceId:s,sessionId:r,frame:n,isExpanded:a,onToggle:i}){const o=n.direction==="send",l=n.opcode==="text",[c,d]=x.useState(null),[u,h]=x.useState(!1),[j,C]=x.useState(null),[p,b]=x.useState("auto"),D=x.useCallback(async()=>{if(!(c||u)){h(!0),C(null);try{const g=await ar(s,r,n.id);d(g)}catch(g){C(g instanceof Error?g.message:"åŠ è½½å¤±è´¥")}finally{h(!1)}}},[s,r,n.id,c,u]),k=()=>{a||D(),i()},w=()=>{if(u)return e.jsx("div",{className:"bg-bg-dark rounded-lg p-4 text-center text-text-muted text-sm",children:e.jsx("span",{className:"animate-pulse",children:"åŠ è½½ä¸­..."})});if(j)return e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4 text-center text-red-400 text-sm",children:j});if(!c)return e.jsx("div",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary",children:n.payloadPreview||"(æ— æ³•é¢„è§ˆ)"});const{payloadText:g,payloadBase64:F}=c;switch(p==="auto"?li(g,F):p){case"json":try{const $=JSON.parse(g||"");return e.jsx("div",{className:"bg-bg-dark rounded-lg p-3 max-h-80 overflow-auto",children:e.jsx(bs,{data:$})})}catch{return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:g||F})}case"text":return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:g||"(binary - cannot display as text)"});case"hex":return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:At(F)});case"base64":return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:F});case"protobuf":return e.jsx("div",{className:"bg-bg-dark rounded-lg max-h-80 overflow-auto",children:e.jsx(et,{base64Data:F})});default:return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:g||At(F)})}};return e.jsxs("div",{className:y("px-4 py-2 cursor-pointer transition-all","hover:bg-bg-light/30",a&&"bg-bg-light/50",o?"border-l-2 border-l-blue-500/50":"border-l-2 border-l-green-500/50"),onClick:k,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:y("w-7 h-7 rounded-lg flex items-center justify-center text-sm font-medium",o?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"),children:o?"â†‘":"â†“"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:y("text-xs font-mono uppercase px-1.5 py-0.5 rounded",n.opcode==="text"?"bg-blue-500/10 text-blue-400":"bg-purple-500/10 text-purple-400"),children:n.opcode}),e.jsx("span",{className:"text-xs text-text-muted",children:Ae(n.payloadSize)}),n.isMocked&&e.jsx("span",{className:"text-2xs px-1.5 py-0.5 bg-purple-500/20 text-purple-400 rounded",children:"MOCK"})]}),!a&&e.jsx("p",{className:"text-xs text-text-secondary truncate font-mono mt-0.5",children:n.payloadPreview||(l?"(empty)":"(binary data)")})]}),e.jsx("span",{className:"text-xs text-text-muted whitespace-nowrap",children:oe(n.timestamp)}),e.jsx("span",{className:y("text-xs text-text-muted transition-transform",a&&"rotate-90"),children:"â–¶"})]}),a&&e.jsxs("div",{className:"mt-3 ml-10",onClick:g=>g.stopPropagation(),children:[c&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:"æ ¼å¼:"}),["auto","text","json","protobuf","hex","base64"].map(g=>e.jsx("button",{onClick:()=>b(g),className:y("px-2 py-0.5 text-xs rounded transition-colors",p===g?"bg-primary/20 text-primary":"text-text-muted hover:text-text-primary hover:bg-bg-light"),children:g.toUpperCase()},g))]}),w()]})]})});function li(t,s){if(!t){if(s)try{const r=atob(s),n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);if(n.length>0&&(n[0]&7)<=5)return"protobuf"}catch{}return"hex"}try{return JSON.parse(t),"json"}catch{return"text"}}function At(t){try{const s=atob(t),r=new Uint8Array(s.length);for(let a=0;a<s.length;a++)r[a]=s.charCodeAt(a);const n=[];for(let a=0;a<r.length;a+=16){const i=r.slice(a,a+16),o=Array.from(i).map(d=>d.toString(16).padStart(2,"0")).join(" "),l=Array.from(i).map(d=>d>=32&&d<=126?String.fromCharCode(d):".").join(""),c=a.toString(16).padStart(8,"0");n.push(`${c}  ${o.padEnd(48)}  ${l}`)}return n.join(`
`)}catch{return t}}function ci({session:t}){return e.jsxs("div",{className:"p-4 space-y-4 overflow-auto h-full",children:[e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("h4",{className:"text-xs font-medium text-text-muted uppercase tracking-wider mb-3",children:"è¿žæŽ¥ä¿¡æ¯"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsx(ye,{label:"URL",value:t.url,mono:!0}),e.jsx(ye,{label:"è¿žæŽ¥æ—¶é—´",value:oe(t.connectTime)}),t.disconnectTime&&e.jsx(ye,{label:"æ–­å¼€æ—¶é—´",value:oe(t.disconnectTime)}),t.closeCode&&e.jsx(ye,{label:"å…³é—­ç ",value:String(t.closeCode)}),t.closeReason&&e.jsx(ye,{label:"å…³é—­åŽŸå› ",value:t.closeReason}),t.subprotocols.length>0&&e.jsx(ye,{label:"å­åè®®",value:t.subprotocols.join(", ")})]})]}),Object.keys(t.requestHeaders).length>0&&e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("h4",{className:"text-xs font-medium text-text-muted uppercase tracking-wider mb-3",children:"è¯·æ±‚å¤´"}),e.jsx("dl",{className:"space-y-1.5",children:Object.entries(t.requestHeaders).map(([s,r])=>e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"text-primary font-medium",children:[s,":"]}),e.jsx("span",{className:"text-text-secondary font-mono break-all",children:r})]},s))})]})]})}function ye({label:t,value:s,mono:r}){return e.jsxs("div",{className:"flex gap-3",children:[e.jsx("dt",{className:"text-text-muted w-20 flex-shrink-0",children:t}),e.jsx("dd",{className:y("text-text-primary break-all",r&&"font-mono text-xs"),children:s})]})}const di={httpRequest:{label:"HTTP è¯·æ±‚",icon:"ðŸ“¤",color:"text-blue-400 bg-blue-500/10 border-blue-500/20"},httpResponse:{label:"HTTP å“åº”",icon:"ðŸ“¥",color:"text-green-400 bg-green-500/10 border-green-500/20"},wsOutgoing:{label:"WS å‘é€",icon:"â†‘",color:"text-purple-400 bg-purple-500/10 border-purple-500/20"},wsIncoming:{label:"WS æŽ¥æ”¶",icon:"â†“",color:"text-orange-400 bg-orange-500/10 border-orange-500/20"}};function ui({rules:t,loading:s,onEdit:r,onDelete:n,onToggleEnabled:a,onCreateNew:i}){return t.length===0&&!s?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-12",children:[e.jsx("span",{className:"text-5xl mb-4 opacity-50",children:"ðŸŽ­"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"æš‚æ—  Mock è§„åˆ™"}),e.jsx("p",{className:"text-sm mb-6",children:"åˆ›å»ºè§„åˆ™æ¥æ¨¡æ‹Ÿ API å“åº”æˆ–ä¿®æ”¹è¯·æ±‚"}),e.jsx("button",{onClick:i,className:"btn bg-primary text-white hover:bg-primary-dark",children:"âœ¨ åˆ›å»ºç¬¬ä¸€æ¡è§„åˆ™"})]}):e.jsxs("div",{className:"divide-y divide-border/50",children:[t.map(o=>e.jsx(mi,{rule:o,onEdit:()=>r(o),onDelete:()=>n(o.id),onToggleEnabled:()=>a(o.id)},o.id)),s&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-primary border-t-transparent rounded-full"})})]})}function mi({rule:t,onEdit:s,onDelete:r,onToggleEnabled:n}){const a=di[t.targetType],i=xi(t),o=hi(t);return e.jsx("div",{className:y("px-4 py-4 transition-all group",t.enabled?"bg-transparent":"bg-bg-medium/30 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{onClick:n,className:y("w-10 h-6 rounded-full relative transition-all flex-shrink-0 mt-1",t.enabled?"bg-primary":"bg-bg-light border border-border"),children:e.jsx("span",{className:y("absolute top-1 w-4 h-4 rounded-full bg-white shadow transition-all",t.enabled?"left-5":"left-1")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:t.name}),e.jsxs("span",{className:y("inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full border",a.color),children:[e.jsx("span",{children:a.icon}),e.jsx("span",{children:a.label})]}),!t.deviceId&&e.jsx("span",{className:"text-2xs px-1.5 py-0.5 bg-yellow-500/10 text-yellow-400 border border-yellow-500/20 rounded",children:"å…¨å±€"})]}),e.jsx("div",{className:"text-xs text-text-muted mb-1.5 space-y-0.5",children:i.map((l,c)=>e.jsxs("p",{children:[e.jsxs("span",{className:"text-text-secondary",children:[l.label,":"]})," ",e.jsx("span",{className:"font-mono",children:l.value})]},c))}),e.jsxs("div",{className:"text-xs text-text-muted",children:[e.jsx("span",{className:"text-primary",children:"â†’"})," ",o]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-2xs text-text-muted",children:[e.jsxs("span",{children:["ä¼˜å…ˆçº§: ",t.priority]}),t.updatedAt&&e.jsxs("span",{children:["æ›´æ–°äºŽ ",oe(t.updatedAt)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-bg-light text-text-muted hover:text-text-primary transition-all",title:"ç¼–è¾‘",children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡è§„åˆ™å—ï¼Ÿ")&&r()},className:"p-2 rounded-lg hover:bg-red-500/10 text-text-muted hover:text-red-400 transition-all",title:"åˆ é™¤",children:"ðŸ—‘ï¸"})]})]})})}function xi(t){const s=[],r=t.condition;return r.urlPattern&&s.push({label:"URL",value:r.urlPattern}),r.method&&s.push({label:"æ–¹æ³•",value:r.method}),r.statusCode&&s.push({label:"çŠ¶æ€ç ",value:String(r.statusCode)}),r.bodyContains&&s.push({label:"åŒ…å«",value:r.bodyContains}),r.wsPayloadContains&&s.push({label:"WSåŒ…å«",value:r.wsPayloadContains}),s.length===0&&s.push({label:"åŒ¹é…",value:"æ‰€æœ‰è¯·æ±‚"}),s}function hi(t){const s=t.action,r=[];return s.mockResponseStatusCode&&r.push(`è¿”å›ž ${s.mockResponseStatusCode}`),s.modifyRequestHeaders&&Object.keys(s.modifyRequestHeaders).length>0&&r.push("ä¿®æ”¹è¯·æ±‚å¤´"),s.modifyRequestBody&&r.push("ä¿®æ”¹è¯·æ±‚ä½“"),s.mockResponseBody&&r.push("è‡ªå®šä¹‰å“åº”ä½“"),s.mockWebSocketPayload&&r.push("æ›¿æ¢ WS æ¶ˆæ¯"),s.delayMilliseconds&&r.push(`å»¶è¿Ÿ ${s.delayMilliseconds}ms`),r.length>0?r.join(", "):"æ— åŠ¨ä½œ"}const pi=[{value:"httpRequest",label:"HTTP è¯·æ±‚",description:"ä¿®æ”¹å‘å‡ºçš„è¯·æ±‚"},{value:"httpResponse",label:"HTTP å“åº”",description:"æ¨¡æ‹Ÿæˆ–ä¿®æ”¹å“åº”"},{value:"wsOutgoing",label:"WebSocket å‘é€",description:"ä¿®æ”¹å‘é€çš„ WS æ¶ˆæ¯"},{value:"wsIncoming",label:"WebSocket æŽ¥æ”¶",description:"ä¿®æ”¹æŽ¥æ”¶çš„ WS æ¶ˆæ¯"}];function fi({rule:t,isOpen:s,onClose:r,onSave:n,loading:a}){var O,W,A;const i=!!t,o=t||jt(),[l,c]=x.useState(o.name),[d,u]=x.useState(o.targetType),[h,j]=x.useState(o.priority),[C,p]=x.useState(o.enabled),[b,D]=x.useState(o.condition.urlPattern||""),[k,w]=x.useState(o.condition.method||""),[g,F]=x.useState(((O=o.condition.statusCode)==null?void 0:O.toString())||""),[E,$]=x.useState(o.condition.bodyContains||""),[q,G]=x.useState(o.condition.wsPayloadContains||""),[Y,_]=x.useState(((W=o.action.mockResponseStatusCode)==null?void 0:W.toString())||"200"),[z,Q]=x.useState(o.action.mockResponseBody?atob(o.action.mockResponseBody):""),[I,T]=x.useState(JSON.stringify(o.action.mockResponseHeaders||{},null,2)),[m,N]=x.useState(o.action.mockWebSocketPayload?atob(o.action.mockWebSocketPayload):""),[f,S]=x.useState(((A=o.action.delayMilliseconds)==null?void 0:A.toString())||"");x.useEffect(()=>{var L,X,ae;if(s){const M=t||jt();c(M.name),u(M.targetType),j(M.priority),p(M.enabled),D(M.condition.urlPattern||""),w(M.condition.method||""),F(((L=M.condition.statusCode)==null?void 0:L.toString())||""),$(M.condition.bodyContains||""),G(M.condition.wsPayloadContains||""),_(((X=M.action.mockResponseStatusCode)==null?void 0:X.toString())||"200"),Q(M.action.mockResponseBody?atob(M.action.mockResponseBody):""),T(JSON.stringify(M.action.mockResponseHeaders||{},null,2)),N(M.action.mockWebSocketPayload?atob(M.action.mockWebSocketPayload):""),S(((ae=M.action.delayMilliseconds)==null?void 0:ae.toString())||"")}},[s,t]);const v=()=>{const L={urlPattern:b||null,method:k||null,statusCode:g?parseInt(g):null,headerContains:null,bodyContains:E||null,wsPayloadContains:q||null,enabled:!0};let X=null;try{X=I?JSON.parse(I):null}catch{}const ae={modifyRequestHeaders:null,modifyRequestBody:null,mockResponseStatusCode:Y?parseInt(Y):null,mockResponseHeaders:X,mockResponseBody:z?btoa(z):null,mockWebSocketPayload:m?btoa(m):null,delayMilliseconds:f?parseInt(f):null};n({name:l,targetType:d,condition:L,action:ae,priority:h,enabled:C})};if(!s)return null;const P=d==="httpRequest"||d==="httpResponse",H=d==="wsOutgoing"||d==="wsIncoming",K=d==="httpResponse";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative w-full max-w-2xl max-h-[90vh] bg-bg-dark border border-border rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:i?"ç¼–è¾‘è§„åˆ™":"åˆ›å»º Mock è§„åˆ™"}),e.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-bg-light text-text-muted hover:text-text-primary transition-all",children:"âœ•"})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted uppercase tracking-wider",children:"åŸºæœ¬ä¿¡æ¯"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"è§„åˆ™åç§° *"}),e.jsx("input",{type:"text",value:l,onChange:L=>c(L.target.value),placeholder:"ä¾‹å¦‚ï¼šMock ç”¨æˆ·ä¿¡æ¯æŽ¥å£",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"ç›®æ ‡ç±»åž‹ *"}),e.jsx("select",{value:d,onChange:L=>u(L.target.value),className:"select w-full",children:pi.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"ä¼˜å…ˆçº§"}),e.jsx("input",{type:"number",value:h,onChange:L=>j(parseInt(L.target.value)||0),className:"input w-full"})]}),e.jsx("div",{className:"flex items-center gap-3 pt-5",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:L=>p(L.target.checked),className:"accent-primary w-4 h-4"}),e.jsx("span",{className:"text-sm text-text-secondary",children:"å¯ç”¨è§„åˆ™"})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted uppercase tracking-wider",children:"åŒ¹é…æ¡ä»¶"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"URL æ¨¡å¼ï¼ˆæ”¯æŒ * é€šé…ç¬¦å’Œæ­£åˆ™ï¼‰"}),e.jsx("input",{type:"text",value:b,onChange:L=>D(L.target.value),placeholder:"ä¾‹å¦‚ï¼š*/api/user/* æˆ– ^https://api\\\\.example\\\\.com",className:"input w-full font-mono text-sm"})]}),P&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"HTTP æ–¹æ³•"}),e.jsxs("select",{value:k,onChange:L=>w(L.target.value),className:"select w-full",children:[e.jsx("option",{value:"",children:"ä»»æ„æ–¹æ³•"}),e.jsx("option",{value:"GET",children:"GET"}),e.jsx("option",{value:"POST",children:"POST"}),e.jsx("option",{value:"PUT",children:"PUT"}),e.jsx("option",{value:"DELETE",children:"DELETE"}),e.jsx("option",{value:"PATCH",children:"PATCH"})]})]}),K&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"åŽŸå§‹çŠ¶æ€ç "}),e.jsx("input",{type:"number",value:g,onChange:L=>F(L.target.value),placeholder:"ä»…åŒ¹é…æŒ‡å®šçŠ¶æ€ç çš„å“åº”",className:"input w-full"})]})]}),P&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"è¯·æ±‚ä½“åŒ…å«"}),e.jsx("input",{type:"text",value:E,onChange:L=>$(L.target.value),placeholder:"åŒ¹é…è¯·æ±‚ä½“ä¸­åŒ…å«çš„å†…å®¹",className:"input w-full font-mono text-sm"})]}),H&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"æ¶ˆæ¯åŒ…å«"}),e.jsx("input",{type:"text",value:q,onChange:L=>G(L.target.value),placeholder:"åŒ¹é… WebSocket æ¶ˆæ¯ä¸­åŒ…å«çš„å†…å®¹",className:"input w-full font-mono text-sm"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted uppercase tracking-wider",children:"å“åº”é…ç½®"}),P&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"Mock çŠ¶æ€ç "}),e.jsx("input",{type:"number",value:Y,onChange:L=>_(L.target.value),placeholder:"200",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:f,onChange:L=>S(L.target.value),placeholder:"0",className:"input w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å“åº”å¤´ (JSON)"}),e.jsx("textarea",{value:I,onChange:L=>T(L.target.value),placeholder:'{"Content-Type": "application/json"}',rows:3,className:"input w-full font-mono text-sm resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å“åº”ä½“"}),e.jsx("textarea",{value:z,onChange:L=>Q(L.target.value),placeholder:'{"success": true, "data": {...}}',rows:6,className:"input w-full font-mono text-sm resize-none"})]})]}),H&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:f,onChange:L=>S(L.target.value),placeholder:"0",className:"input w-32"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"æ›¿æ¢æ¶ˆæ¯å†…å®¹"}),e.jsx("textarea",{value:m,onChange:L=>N(L.target.value),placeholder:'{"type": "mock", "data": {...}}',rows:6,className:"input w-full font-mono text-sm resize-none"})]})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-border flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"btn btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:v,disabled:a||!l.trim(),className:"btn bg-primary text-white hover:bg-primary-dark disabled:opacity-50",children:a?"ä¿å­˜ä¸­...":i?"ä¿å­˜ä¿®æ”¹":"åˆ›å»ºè§„åˆ™"})]})]})]})}function mt({isOpen:t,onClose:s,onConfirm:r,title:n,message:a,confirmText:i="ç¡®è®¤",cancelText:o="å–æ¶ˆ",type:l="danger",loading:c=!1}){if(!t)return null;const u={danger:{icon:"âš ï¸",iconBg:"bg-red-500/20",headerBg:"bg-red-500/5",titleColor:"text-red-400",confirmBg:"bg-red-500 hover:bg-red-600"},warning:{icon:"âš¡",iconBg:"bg-yellow-500/20",headerBg:"bg-yellow-500/5",titleColor:"text-yellow-400",confirmBg:"bg-yellow-500 hover:bg-yellow-600"},info:{icon:"â„¹ï¸",iconBg:"bg-blue-500/20",headerBg:"bg-blue-500/5",titleColor:"text-blue-400",confirmBg:"bg-blue-500 hover:bg-blue-600"}}[l];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl shadow-2xl w-[400px] overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("div",{className:y("px-6 py-4 border-b border-border",u.headerBg),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:y("w-10 h-10 rounded-xl flex items-center justify-center",u.iconBg),children:e.jsx("span",{className:"text-xl",children:u.icon})}),e.jsx("h3",{className:y("text-lg font-bold",u.titleColor),children:n})]})}),e.jsx("div",{className:"px-6 py-5",children:e.jsx("p",{className:"text-text-secondary whitespace-pre-line",children:a})}),e.jsxs("div",{className:"px-6 py-4 border-t border-border bg-bg-medium/30 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,disabled:c,className:"px-4 py-2 rounded-lg text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-bg-light transition-all disabled:opacity-50",children:o}),e.jsx("button",{onClick:r,disabled:c,className:y("px-4 py-2 rounded-lg text-sm font-medium text-white transition-all disabled:opacity-50",u.confirmBg),children:c?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"å¤„ç†ä¸­..."]}):i})]})]})})}function gi({deviceId:t,isExpanded:s=!1,onToggleExpand:r}){const{activities:n}=ts(),a=x.useMemo(()=>n.filter(l=>l.deviceId===t),[n,t]),i=a[0],o=(i==null?void 0:i.type)==="connected";return a.length===0?null:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:r,className:y("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all",o?"bg-green-500/10 text-green-400 border border-green-500/20 hover:bg-green-500/15":"bg-orange-500/10 text-orange-400 border border-orange-500/20 hover:bg-orange-500/15"),children:[e.jsx("span",{className:y("w-2 h-2 rounded-full",o?"bg-green-500":"bg-orange-500")}),e.jsx("span",{children:o?"å·²è¿žæŽ¥":"é‡è¿žä¸­..."}),a.length>1&&e.jsxs("span",{className:"text-2xs opacity-60",children:["(",a.length,")"]}),e.jsx("span",{className:"ml-1",children:s?"â–²":"â–¼"})]}),s&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-bg-dark border border-border rounded-lg shadow-lg z-50 overflow-hidden animate-fadeIn",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-text-primary",children:"è¿žæŽ¥æ´»åŠ¨"}),e.jsxs("span",{className:"text-2xs text-text-muted",children:[a.length," æ¡è®°å½•"]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:a.slice(0,20).map((l,c)=>e.jsx(bi,{activity:l,isFirst:c===0},l.id))})]})]})}function bi({activity:t,isFirst:s}){const r=t.type==="connected";return e.jsxs("div",{className:y("flex items-center gap-3 px-4 py-2.5 border-b border-border-light transition-colors",s&&"bg-bg-light/30"),children:[e.jsx("div",{className:y("w-8 h-8 rounded flex items-center justify-center flex-shrink-0",r?"bg-green-500/15":"bg-red-500/15"),children:e.jsx("span",{className:"text-sm",children:r?"ðŸ“±":"ðŸ“´"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:y("text-xs font-medium",r?"text-green-400":"text-red-400"),children:r?"è®¾å¤‡å·²è¿žæŽ¥":"è®¾å¤‡å·²æ–­å¼€"}),e.jsxs("div",{className:"text-2xs text-text-muted font-mono truncate",children:[oe(t.timestamp),t.sessionId&&e.jsxs("span",{className:"ml-2 opacity-60",children:["#",t.sessionId.slice(0,6)]})]})]})]})}function yi({hits:t,onResume:s,loading:r}){const[n,a]=x.useState(null),i=x.useMemo(()=>t.find(o=>o.requestId===n)||t[0]||null,[t,n]);return t.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"âœ…"}),e.jsx("p",{className:"text-sm",children:"æš‚æ— ç­‰å¾…å¤„ç†çš„æ–­ç‚¹"}),e.jsx("p",{className:"text-xs mt-1",children:"å½“è¯·æ±‚å‘½ä¸­æ–­ç‚¹è§„åˆ™æ—¶ä¼šåœ¨è¿™é‡Œæ˜¾ç¤º"})]}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border bg-orange-500/10 flex items-center gap-3",children:[e.jsx("span",{className:"text-xl animate-pulse",children:"â¸ï¸"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-medium text-orange-400",children:[t.length," ä¸ªæ–­ç‚¹ç­‰å¾…å¤„ç†"]}),e.jsx("p",{className:"text-xs text-text-muted",children:"è¯·æ±‚å·²è¢«æ‹¦æˆªï¼Œç­‰å¾…æ‚¨çš„æ“ä½œ"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"w-1/3 border-r border-border overflow-auto",children:t.map(o=>e.jsxs("div",{onClick:()=>a(o.requestId),className:y("p-3 border-b border-border cursor-pointer transition-colors",(i==null?void 0:i.requestId)===o.requestId?"bg-primary/10 border-l-2 border-l-primary":"hover:bg-bg-light"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:y("px-1.5 py-0.5 text-xs rounded font-medium",o.phase==="request"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"),children:o.phase==="request"?"è¯·æ±‚":"å“åº”"}),e.jsx("span",{className:"text-xs font-mono text-text-secondary",children:o.request.method})]}),e.jsx("div",{className:"text-xs text-text-muted truncate font-mono",children:new URL(o.request.url).pathname})]},o.requestId))}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:i&&e.jsx(vi,{hit:i,onResume:s,loading:r})})]})]})}function vi({hit:t,onResume:s,loading:r}){const[n,a]=x.useState(!1),[i,o]=x.useState(t.request),[l,c]=x.useState(t.response),[d,u]=x.useState("request");x.useState(()=>{o(t.request),c(t.response),a(!1)});const h=()=>{s(t.requestId,{type:"resume"})},j=()=>{s(t.requestId,{type:"abort"})},C=()=>{const D={type:"modify",modification:{request:t.phase==="request"?i:void 0,response:t.phase==="response"?l??void 0:void 0}};s(t.requestId,D)},p=()=>{l&&s(t.requestId,{type:"mockResponse",mockResponse:l})},b=D=>{try{return btoa(D)}catch{return D}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 border-b border-border bg-bg-dark/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:y("px-2 py-1 text-xs rounded font-bold",{"bg-green-500/20 text-green-400":t.request.method==="GET","bg-blue-500/20 text-blue-400":t.request.method==="POST","bg-yellow-500/20 text-yellow-400":t.request.method==="PUT","bg-red-500/20 text-red-400":t.request.method==="DELETE","bg-purple-500/20 text-purple-400":t.request.method==="PATCH"}),children:t.request.method}),e.jsx("span",{className:y("px-2 py-0.5 text-xs rounded",t.phase==="request"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"),children:t.phase==="request"?"è¯·æ±‚é˜¶æ®µ":"å“åº”é˜¶æ®µ"})]}),e.jsx("code",{className:"text-sm text-text-primary break-all",children:t.request.url})]}),e.jsxs("div",{className:"flex border-b border-border",children:[e.jsx("button",{onClick:()=>u("request"),className:y("px-4 py-2 text-sm font-medium transition-colors",d==="request"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-primary"),children:"è¯·æ±‚"}),(t.phase==="response"||n)&&e.jsx("button",{onClick:()=>u("response"),className:y("px-4 py-2 text-sm font-medium transition-colors",d==="response"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-primary"),children:"å“åº”"}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:()=>a(!n),className:y("px-4 py-2 text-sm transition-colors",n?"text-primary":"text-text-muted hover:text-text-primary"),children:n?"âœï¸ ç¼–è¾‘ä¸­":"âœï¸ ç¼–è¾‘"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:d==="request"?e.jsx(ji,{request:i,onChange:o,editable:n&&t.phase==="request"}):e.jsx(Ni,{response:l,onChange:c,editable:n,showCreateButton:!l&&n,onCreateResponse:()=>c({statusCode:200,headers:{"Content-Type":"application/json"},body:b("{}")})})}),e.jsxs("div",{className:"p-4 border-t border-border bg-bg-dark/50 flex items-center gap-3",children:[e.jsx("button",{onClick:h,disabled:r,className:"btn btn-primary flex-1",children:"â–¶ï¸ ç»§ç»­"}),n&&e.jsx("button",{onClick:C,disabled:r,className:"btn bg-blue-500/20 text-blue-400 border border-blue-500/30 hover:bg-blue-500/30 flex-1",children:"âœï¸ ä¿®æ”¹åŽç»§ç»­"}),t.phase==="request"&&n&&l&&e.jsx("button",{onClick:p,disabled:r,className:"btn bg-purple-500/20 text-purple-400 border border-purple-500/30 hover:bg-purple-500/30 flex-1",children:"ðŸŽ­ è¿”å›ž Mock å“åº”"}),e.jsx("button",{onClick:j,disabled:r,className:"btn btn-danger",children:"â›” ä¸­æ­¢"})]})]})}function ji({request:t,onChange:s,editable:r}){const n=x.useMemo(()=>{if(!t.body)return"";try{return atob(t.body)}catch{return t.body}},[t.body]),a=i=>{try{return JSON.stringify(JSON.parse(i),null,2)}catch{return i}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Headers"}),e.jsx("div",{className:"bg-bg-dark rounded-lg border border-border overflow-hidden",children:Object.entries(t.headers).map(([i,o])=>e.jsxs("div",{className:"flex border-b border-border last:border-b-0",children:[e.jsx("div",{className:"w-1/3 px-3 py-2 text-xs font-mono text-text-muted bg-bg-medium/50 border-r border-border",children:i}),e.jsx("div",{className:"flex-1 px-3 py-2 text-xs font-mono text-text-primary break-all",children:r?e.jsx("input",{type:"text",value:o,onChange:l=>s({...t,headers:{...t.headers,[i]:l.target.value}}),className:"w-full bg-transparent border-none outline-none"}):o})]},i))})]}),t.body&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Body"}),r?e.jsx("textarea",{value:n,onChange:i=>s({...t,body:btoa(i.target.value)}),className:"w-full h-64 bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary resize-none",spellCheck:!1}):e.jsx("pre",{className:"bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary overflow-auto max-h-64",children:a(n)})]})]})}function Ni({response:t,onChange:s,editable:r,showCreateButton:n,onCreateResponse:a}){if(!t)return n&&a?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("p",{className:"text-sm mb-3",children:"å°šæ— å“åº”æ•°æ®"}),e.jsx("button",{onClick:a,className:"btn btn-primary",children:"åˆ›å»º Mock å“åº”"})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:e.jsx("p",{className:"text-sm",children:"è¯·æ±‚é˜¶æ®µæ–­ç‚¹ï¼Œæš‚æ— å“åº”æ•°æ®"})});const i=x.useMemo(()=>{if(!t.body)return"";try{return atob(t.body)}catch{return t.body}},[t.body]),o=l=>{try{return JSON.stringify(JSON.parse(l),null,2)}catch{return l}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Status Code"}),r?e.jsx("input",{type:"number",value:t.statusCode,onChange:l=>s({...t,statusCode:parseInt(l.target.value)||200}),className:"input w-32"}):e.jsx("span",{className:y("px-2 py-1 rounded text-sm font-medium",t.statusCode>=200&&t.statusCode<300?"bg-green-500/20 text-green-400":t.statusCode>=400?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"),children:t.statusCode})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Headers"}),e.jsx("div",{className:"bg-bg-dark rounded-lg border border-border overflow-hidden",children:Object.entries(t.headers).map(([l,c])=>e.jsxs("div",{className:"flex border-b border-border last:border-b-0",children:[e.jsx("div",{className:"w-1/3 px-3 py-2 text-xs font-mono text-text-muted bg-bg-medium/50 border-r border-border",children:l}),e.jsx("div",{className:"flex-1 px-3 py-2 text-xs font-mono text-text-primary break-all",children:r?e.jsx("input",{type:"text",value:c,onChange:d=>s({...t,headers:{...t.headers,[l]:d.target.value}}),className:"w-full bg-transparent border-none outline-none"}):c})]},l))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Body"}),r?e.jsx("textarea",{value:i,onChange:l=>s({...t,body:btoa(l.target.value)}),className:"w-full h-64 bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary resize-none",spellCheck:!1}):e.jsx("pre",{className:"bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary overflow-auto max-h-64",children:o(i)||"(empty)"})]})]})}function wi({deviceId:t,pendingHits:s,onResumeBreakpoint:r}){const[n,a]=x.useState([]),[i,o]=x.useState(!1),[l,c]=x.useState(null),[d,u]=x.useState(!1),[h,j]=x.useState("rules"),[C,p]=x.useState([]),[b,D]=x.useState(!1),k=s??C,w=x.useCallback(async()=>{o(!0);try{const _=await xr(t);a(_)}catch(_){console.error("Failed to fetch breakpoint rules:",_)}finally{o(!1)}},[t]),g=x.useCallback(async()=>{if(s===void 0)try{const _=await Gt(t);p(_)}catch(_){console.error("Failed to fetch pending breakpoints:",_)}},[t,s]);x.useEffect(()=>{w(),g();const _=setInterval(g,2e3);return()=>clearInterval(_)},[w,g]),x.useEffect(()=>{k.length>0&&j("pending")},[k.length]);const F=()=>{c({name:"",urlPattern:"",method:"",phase:"request",enabled:!0,priority:0}),u(!0)},E=_=>{c({..._}),u(!0)},$=async()=>{if(l)try{l.id?await bt(t,l.id,l):await hr(t,l),u(!1),c(null),w()}catch(_){console.error("Failed to save breakpoint rule:",_)}},q=async _=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡æ–­ç‚¹è§„åˆ™å—ï¼Ÿ"))try{await pr(t,_),w()}catch(z){console.error("Failed to delete breakpoint rule:",z)}},G=async _=>{try{await bt(t,_.id,{enabled:!_.enabled}),w()}catch(z){console.error("Failed to toggle breakpoint rule:",z)}},Y=async(_,z)=>{D(!0);try{r?r(_,z):(await Jt(t,_,z),p(Q=>Q.filter(I=>I.requestId!==_)))}catch(Q){console.error("Failed to resume breakpoint:",Q)}finally{D(!1)}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"â¸ï¸"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:"æ–­ç‚¹ç®¡ç†"}),e.jsx("p",{className:"text-xs text-text-muted",children:"æ‹¦æˆªè¯·æ±‚/å“åº”å¹¶ç­‰å¾…æ‰‹åŠ¨æ“ä½œ"})]})]}),h==="rules"&&e.jsx("button",{onClick:F,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:()=>j("rules"),className:y("px-4 py-2 rounded-lg text-sm font-medium transition-colors",h==="rules"?"bg-bg-light text-text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light/50"),children:["è§„åˆ™åˆ—è¡¨ (",n.length,")"]}),e.jsxs("button",{onClick:()=>j("pending"),className:y("px-4 py-2 rounded-lg text-sm font-medium transition-colors relative",h==="pending"?"bg-bg-light text-text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light/50"),children:["ç­‰å¾…å¤„ç†",k.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-orange-500 text-white text-xs rounded-full flex items-center justify-center animate-pulse",children:k.length})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:h==="rules"?e.jsx("div",{className:"h-full overflow-auto p-4",children:i?e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"åŠ è½½ä¸­..."}):n.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"â¸ï¸"}),e.jsx("p",{className:"text-sm mb-3",children:"æš‚æ— æ–­ç‚¹è§„åˆ™"}),e.jsx("button",{onClick:F,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}):e.jsx("div",{className:"space-y-3",children:n.map(_=>e.jsx(ki,{rule:_,onEdit:()=>E(_),onDelete:()=>q(_.id),onToggle:()=>G(_)},_.id))})}):e.jsx(yi,{hits:k,onResume:Y,loading:b})}),d&&l&&e.jsx(Si,{rule:l,onChange:c,onSave:$,onCancel:()=>{u(!1),c(null)}})]})}function ki({rule:t,onEdit:s,onDelete:r,onToggle:n}){const a={request:"è¯·æ±‚é˜¶æ®µ",response:"å“åº”é˜¶æ®µ",both:"åŒå‘æ‹¦æˆª"};return e.jsx("div",{className:y("p-4 bg-bg-dark border border-border rounded-xl transition-all",!t.enabled&&"opacity-50"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:y("w-10 h-6 rounded-full transition-colors relative",t.enabled?"bg-primary":"bg-bg-light"),children:e.jsx("span",{className:y("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",t.enabled?"left-5":"left-1")})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:t.name||"æœªå‘½åè§„åˆ™"}),e.jsxs("div",{className:"text-xs text-text-muted flex items-center gap-2",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-orange-500/20 text-orange-400 rounded text-2xs",children:a[t.phase]}),t.method&&e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-500/20 text-blue-400 rounded text-2xs",children:t.method}),t.urlPattern&&e.jsx("code",{className:"text-text-secondary truncate max-w-[200px]",children:t.urlPattern})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:s,className:"p-2 text-text-muted hover:text-text-primary hover:bg-bg-light rounded-lg transition-colors",children:"âœï¸"}),e.jsx("button",{onClick:r,className:"p-2 text-text-muted hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:"ðŸ—‘ï¸"})]})]})})}function Si({rule:t,onChange:s,onSave:r,onCancel:n}){return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl w-full max-w-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:t.id?"ç¼–è¾‘æ–­ç‚¹è§„åˆ™":"æ–°å»ºæ–­ç‚¹è§„åˆ™"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"è§„åˆ™åç§°"}),e.jsx("input",{type:"text",value:t.name||"",onChange:a=>s({...t,name:a.target.value}),placeholder:"ä¾‹å¦‚ï¼šæ‹¦æˆªç™»å½•æŽ¥å£",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"URL åŒ¹é…æ¨¡å¼"}),e.jsx("input",{type:"text",value:t.urlPattern||"",onChange:a=>s({...t,urlPattern:a.target.value}),placeholder:"ä¾‹å¦‚ï¼š*/api/login* æˆ–ç•™ç©ºåŒ¹é…æ‰€æœ‰",className:"input w-full font-mono"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"HTTP æ–¹æ³•"}),e.jsxs("select",{value:t.method||"",onChange:a=>s({...t,method:a.target.value||null}),className:"select w-full",children:[e.jsx("option",{value:"",children:"å…¨éƒ¨æ–¹æ³•"}),e.jsx("option",{value:"GET",children:"GET"}),e.jsx("option",{value:"POST",children:"POST"}),e.jsx("option",{value:"PUT",children:"PUT"}),e.jsx("option",{value:"DELETE",children:"DELETE"}),e.jsx("option",{value:"PATCH",children:"PATCH"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"æ‹¦æˆªé˜¶æ®µ"}),e.jsxs("select",{value:t.phase||"request",onChange:a=>s({...t,phase:a.target.value}),className:"select w-full",children:[e.jsx("option",{value:"request",children:"è¯·æ±‚é˜¶æ®µ"}),e.jsx("option",{value:"response",children:"å“åº”é˜¶æ®µ"}),e.jsx("option",{value:"both",children:"åŒå‘æ‹¦æˆª"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"ä¼˜å…ˆçº§"}),e.jsx("input",{type:"number",value:t.priority||0,onChange:a=>s({...t,priority:parseInt(a.target.value)||0}),className:"input w-full"}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"æ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:n,className:"btn btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:r,className:"btn btn-primary",children:"ä¿å­˜"})]})]})})}function Ei({deviceId:t}){const[s,r]=x.useState([]),[n,a]=x.useState(!1),[i,o]=x.useState(null),[l,c]=x.useState(!1),d=x.useCallback(async()=>{a(!0);try{const b=await fr(t);r(b)}catch(b){console.error("Failed to fetch chaos rules:",b)}finally{a(!1)}},[t]);x.useEffect(()=>{d()},[d]);const u=()=>{o({name:"",urlPattern:"",chaos:{type:"latency",minLatency:500,maxLatency:2e3},enabled:!0,priority:0,probability:1}),c(!0)},h=b=>{o({...b}),c(!0)},j=async()=>{if(i)try{i.id?await yt(t,i.id,i):await gr(t,i),c(!1),o(null),d()}catch(b){console.error("Failed to save chaos rule:",b)}},C=async b=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡æ•…éšœæ³¨å…¥è§„åˆ™å—ï¼Ÿ"))try{await br(t,b),d()}catch(D){console.error("Failed to delete chaos rule:",D)}},p=async b=>{try{await yt(t,b.id,{enabled:!b.enabled}),d()}catch(D){console.error("Failed to toggle chaos rule:",D)}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"ðŸŽ²"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:"æ•…éšœæ³¨å…¥è§„åˆ™"}),e.jsx("p",{className:"text-xs text-text-muted",children:"æ³¨å…¥ç½‘ç»œæ•…éšœæ¥æµ‹è¯•åº”ç”¨çš„å¥å£®æ€§"})]})]}),e.jsx("button",{onClick:u,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:n?e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"åŠ è½½ä¸­..."}):s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ðŸŽ²"}),e.jsx("p",{className:"text-sm mb-3",children:"æš‚æ— æ•…éšœæ³¨å…¥è§„åˆ™"}),e.jsx("button",{onClick:u,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}):e.jsx("div",{className:"space-y-3",children:s.map(b=>e.jsx(Ti,{rule:b,onEdit:()=>h(b),onDelete:()=>C(b.id),onToggle:()=>p(b)},b.id))})}),l&&i&&e.jsx(Ci,{rule:i,onChange:o,onSave:j,onCancel:()=>{c(!1),o(null)}})]})}const Ns={latency:{label:"å»¶è¿Ÿ",color:"bg-yellow-500/20 text-yellow-400",icon:"â±ï¸",description:"å¢žåŠ ç½‘ç»œå»¶è¿Ÿ"},timeout:{label:"è¶…æ—¶",color:"bg-orange-500/20 text-orange-400",icon:"â°",description:"è¯·æ±‚è¶…æ—¶"},connectionReset:{label:"è¿žæŽ¥é‡ç½®",color:"bg-red-500/20 text-red-400",icon:"ðŸ”Œ",description:"æ¨¡æ‹Ÿè¿žæŽ¥é‡ç½®"},randomError:{label:"éšæœºé”™è¯¯",color:"bg-pink-500/20 text-pink-400",icon:"ðŸŽ°",description:"è¿”å›žéšæœºé”™è¯¯ç "},corruptResponse:{label:"æ•°æ®æŸå",color:"bg-purple-500/20 text-purple-400",icon:"ðŸ’¥",description:"æŸåå“åº”æ•°æ®"},slowNetwork:{label:"æ…¢é€Ÿç½‘ç»œ",color:"bg-blue-500/20 text-blue-400",icon:"ðŸŒ",description:"é™åˆ¶ç½‘ç»œå¸¦å®½"},dropRequest:{label:"ä¸¢å¼ƒè¯·æ±‚",color:"bg-gray-500/20 text-gray-400",icon:"ðŸ—‘ï¸",description:"ç›´æŽ¥ä¸¢å¼ƒè¯·æ±‚"}};function Ti({rule:t,onEdit:s,onDelete:r,onToggle:n}){const a=Ns[t.chaos.type],o=(()=>{const l=t.chaos;switch(l.type){case"latency":return`å»¶è¿Ÿ: ${l.minLatency}-${l.maxLatency}ms`;case"slowNetwork":return`å¸¦å®½: ${l.bytesPerSecond} B/s`;case"randomError":return`é”™è¯¯ç : ${l.errorCodes.join(", ")}`;default:return null}})();return e.jsxs("div",{className:y("p-4 bg-bg-dark border border-border rounded-xl transition-all",!t.enabled&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:y("w-10 h-6 rounded-full transition-colors relative",t.enabled?"bg-primary":"bg-bg-light"),children:e.jsx("span",{className:y("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",t.enabled?"left-5":"left-1")})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-text-primary flex items-center gap-2",children:[e.jsx("span",{children:a.icon}),t.name||"æœªå‘½åè§„åˆ™"]}),e.jsxs("div",{className:"text-xs text-text-muted flex items-center gap-2 mt-1",children:[e.jsx("span",{className:y("px-1.5 py-0.5 rounded text-2xs",a.color),children:a.label}),t.probability<1&&e.jsxs("span",{className:"px-1.5 py-0.5 bg-purple-500/20 text-purple-400 rounded text-2xs",children:[Math.round(t.probability*100),"% æ¦‚çŽ‡"]}),t.urlPattern&&e.jsx("code",{className:"text-text-secondary truncate max-w-[200px]",children:t.urlPattern})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:s,className:"p-2 text-text-muted hover:text-text-primary hover:bg-bg-light rounded-lg transition-colors",children:"âœï¸"}),e.jsx("button",{onClick:r,className:"p-2 text-text-muted hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:"ðŸ—‘ï¸"})]})]}),o&&e.jsx("div",{className:"mt-2 text-xs text-text-muted",children:o})]})}function Ci({rule:t,onChange:s,onSave:r,onCancel:n}){var l,c,d,u;const a=((l=t.chaos)==null?void 0:l.type)||"latency",i=h=>{let j;switch(h){case"latency":j={type:"latency",minLatency:500,maxLatency:2e3};break;case"timeout":j={type:"timeout"};break;case"connectionReset":j={type:"connectionReset"};break;case"randomError":j={type:"randomError",errorCodes:[500,502,503]};break;case"corruptResponse":j={type:"corruptResponse"};break;case"slowNetwork":j={type:"slowNetwork",bytesPerSecond:1024};break;case"dropRequest":j={type:"dropRequest"};break;default:j={type:"latency",minLatency:500,maxLatency:2e3}}s({...t,chaos:j})},o=h=>{t.chaos&&s({...t,chaos:{...t.chaos,...h}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:t.id?"ç¼–è¾‘æ•…éšœæ³¨å…¥è§„åˆ™":"æ–°å»ºæ•…éšœæ³¨å…¥è§„åˆ™"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"è§„åˆ™åç§°"}),e.jsx("input",{type:"text",value:t.name||"",onChange:h=>s({...t,name:h.target.value}),placeholder:"ä¾‹å¦‚ï¼šç™»å½•æŽ¥å£å»¶è¿Ÿ",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"URL åŒ¹é…æ¨¡å¼"}),e.jsx("input",{type:"text",value:t.urlPattern||"",onChange:h=>s({...t,urlPattern:h.target.value}),placeholder:"ä¾‹å¦‚ï¼š*/api/login* æˆ–ç•™ç©ºåŒ¹é…æ‰€æœ‰",className:"input w-full font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-2",children:"æ•…éšœæ³¨å…¥ç±»åž‹"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Ns).map(([h,j])=>e.jsxs("button",{onClick:()=>i(h),className:y("p-3 rounded-lg border text-left transition-all",a===h?"border-primary bg-primary/10":"border-border hover:border-border-hover"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:j.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:j.label})]}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:j.description})]},h))})]}),((c=t.chaos)==null?void 0:c.type)==="latency"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"æœ€å°å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:t.chaos.minLatency,onChange:h=>o({minLatency:parseInt(h.target.value)||0}),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"æœ€å¤§å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:t.chaos.maxLatency,onChange:h=>o({maxLatency:parseInt(h.target.value)||0}),className:"input w-full"})]})]}),((d=t.chaos)==null?void 0:d.type)==="slowNetwork"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"å¸¦å®½é™åˆ¶ (B/s)"}),e.jsx("input",{type:"number",value:t.chaos.bytesPerSecond,onChange:h=>o({bytesPerSecond:parseInt(h.target.value)||1024}),className:"input w-full"}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"1024 = 1KB/s, 10240 = 10KB/s"})]}),((u=t.chaos)==null?void 0:u.type)==="randomError"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"é”™è¯¯çŠ¶æ€ç  (é€—å·åˆ†éš”)"}),e.jsx("input",{type:"text",value:t.chaos.errorCodes.join(", "),onChange:h=>{const j=h.target.value.split(",").map(C=>parseInt(C.trim())).filter(C=>!isNaN(C));o({errorCodes:j.length>0?j:[500]})},placeholder:"500, 502, 503",className:"input w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"è§¦å‘æ¦‚çŽ‡"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:(t.probability||1)*100,onChange:h=>s({...t,probability:parseInt(h.target.value)/100}),className:"flex-1"}),e.jsxs("span",{className:"text-text-primary w-12 text-right",children:[Math.round((t.probability||1)*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"ä¼˜å…ˆçº§"}),e.jsx("input",{type:"number",value:t.priority||0,onChange:h=>s({...t,priority:parseInt(h.target.value)||0}),className:"input w-full"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:n,className:"btn btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:r,className:"btn btn-primary",children:"ä¿å­˜"})]})]})})}const $t={databases:[],dbLoading:!1,dbError:null,dbSortOrder:"name",dbSortAscending:!0,selectedDb:null,selectedTable:null,tables:[],tablesLoading:!1,schema:[],showSchema:!1,tableData:null,dataLoading:!1,dataError:null,page:1,pageSize:100,orderBy:null,ascending:!0,queryMode:!1,queryInput:"",queryResult:null,queryLoading:!1,queryError:null},Di=ne((t,s)=>({...$t,loadDatabases:async r=>{t({dbLoading:!0,dbError:null});try{const n=await yr(r);t({databases:n.databases,dbLoading:!1})}catch(n){t({dbError:n instanceof Error?n.message:"Failed to load databases",dbLoading:!1})}},loadTables:async(r,n)=>{t({tablesLoading:!0,tables:[]});try{const a=await vr(r,n);t({tables:a.tables,tablesLoading:!1})}catch(a){console.error("Failed to load tables:",a),t({tablesLoading:!1})}},loadSchema:async(r,n,a)=>{try{const i=await jr(r,n,a);t({schema:i.columns})}catch(i){console.error("Failed to load schema:",i),t({schema:[]})}},loadTableData:async(r,n,a)=>{const{page:i,pageSize:o,orderBy:l,ascending:c}=s();t({dataLoading:!0,dataError:null});try{const d=await Ue(r,n,a,{page:i,pageSize:o,orderBy:l??void 0,ascending:c});t({tableData:d,dataLoading:!1})}catch(d){const u=d instanceof Error?d.message:"Failed to load table data";console.error("Failed to load table data:",d),t({tableData:null,dataLoading:!1,dataError:u})}},selectDb:r=>{s().selectedDb!==r&&t({selectedDb:r,selectedTable:null,tables:[],schema:[],tableData:null,page:1,orderBy:null})},selectTable:r=>{s().selectedTable!==r&&t({selectedTable:r,schema:[],tableData:null,page:1,orderBy:null})},setShowSchema:r=>{t({showSchema:r})},setPage:r=>{t({page:r})},setSort:r=>{const{orderBy:n,ascending:a}=s();t(n===r?{ascending:!a,page:1}:{orderBy:r,ascending:!0,page:1})},setSortAndReload:async(r,n)=>{const{orderBy:a,ascending:i,selectedDb:o,selectedTable:l}=s(),c=a===n?!i:!0;if(t({orderBy:n,ascending:c,page:1,dataLoading:!0}),o&&l)try{const d=await Ue(r,o,l,{page:1,pageSize:s().pageSize,orderBy:n,ascending:c});t({tableData:d,dataLoading:!1})}catch(d){console.error("Failed to load table data:",d),t({dataLoading:!1})}},setPageAndReload:async(r,n)=>{const{selectedDb:a,selectedTable:i,pageSize:o,orderBy:l,ascending:c}=s();if(t({page:n,dataLoading:!0}),a&&i)try{const d=await Ue(r,a,i,{page:n,pageSize:o,orderBy:l??void 0,ascending:c});t({tableData:d,dataLoading:!1})}catch(d){console.error("Failed to load table data:",d),t({dataLoading:!1})}},setQueryMode:r=>{t({queryMode:r,queryError:null}),r||t({queryResult:null})},setQueryInput:r=>{t({queryInput:r})},executeQuery:async r=>{const{selectedDb:n,queryInput:a}=s();if(!n||!a.trim()){t({queryError:"è¯·é€‰æ‹©æ•°æ®åº“å¹¶è¾“å…¥ SQL æŸ¥è¯¢è¯­å¥"});return}t({queryLoading:!0,queryError:null,queryResult:null});try{const i=await Nr(r,n,a);t({queryResult:i,queryLoading:!1})}catch(i){t({queryError:i instanceof Error?i.message:"Query execution failed",queryLoading:!1})}},clearQueryResult:()=>{t({queryResult:null,queryError:null})},setDbSortOrder:r=>{t({dbSortOrder:r})},toggleDbSortDirection:()=>{t(r=>({dbSortAscending:!r.dbSortAscending}))},getSortedDatabases:()=>{const{databases:r,dbSortOrder:n,dbSortAscending:a}=s();return[...r].sort((o,l)=>{let c=0;switch(n){case"name":c=o.descriptor.name.localeCompare(l.descriptor.name);break;case"size":c=(o.fileSizeBytes??0)-(l.fileSizeBytes??0);break;case"tableCount":c=(o.tableCount??0)-(l.tableCount??0);break}return a?c:-c})},reset:()=>{t($t)}}));var Bt={exports:{}};const Oi={google:{nested:{protobuf:{options:{go_package:"google.golang.org/protobuf/types/descriptorpb",java_package:"com.google.protobuf",java_outer_classname:"DescriptorProtos",csharp_namespace:"Google.Protobuf.Reflection",objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{FileDescriptorSet:{edition:"proto2",fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}},extensions:[[536e6,536e6]]},Edition:{edition:"proto2",values:{EDITION_UNKNOWN:0,EDITION_LEGACY:900,EDITION_PROTO2:998,EDITION_PROTO3:999,EDITION_2023:1e3,EDITION_2024:1001,EDITION_1_TEST_ONLY:1,EDITION_2_TEST_ONLY:2,EDITION_99997_TEST_ONLY:99997,EDITION_99998_TEST_ONLY:99998,EDITION_99999_TEST_ONLY:99999,EDITION_MAX:2147483647}},FileDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10},weakDependency:{rule:"repeated",type:"int32",id:11},optionDependency:{rule:"repeated",type:"string",id:15},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12},edition:{type:"Edition",id:14}}},DescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10},visibility:{type:"SymbolVisibility",id:11}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2},options:{type:"ExtensionRangeOptions",id:3}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},ExtensionRangeOptions:{edition:"proto2",fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999},declaration:{rule:"repeated",type:"Declaration",id:2,options:{retention:"RETENTION_SOURCE"}},features:{type:"FeatureSet",id:50},verification:{type:"VerificationState",id:3,options:{default:"UNVERIFIED",retention:"RETENTION_SOURCE"}}},extensions:[[1e3,536870911]],nested:{Declaration:{fields:{number:{type:"int32",id:1},fullName:{type:"string",id:2},type:{type:"string",id:3},reserved:{type:"bool",id:5},repeated:{type:"bool",id:6}},reserved:[[4,4]]},VerificationState:{values:{DECLARATION:0,UNVERIFIED:1}}}},FieldDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8},proto3Optional:{type:"bool",id:17}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REPEATED:3,LABEL_REQUIRED:2}}}},OneofDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3},reservedRange:{rule:"repeated",type:"EnumReservedRange",id:4},reservedName:{rule:"repeated",type:"string",id:5},visibility:{type:"SymbolVisibility",id:6}},nested:{EnumReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},EnumValueDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{edition:"proto2",fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31,options:{default:!0}},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},swiftPrefix:{type:"string",id:39},phpClassPrefix:{type:"string",id:40},phpNamespace:{type:"string",id:41},phpMetadataNamespace:{type:"string",id:44},rubyPackage:{type:"string",id:45},features:{type:"FeatureSet",id:50},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[42,42],[38,38],"php_generic_services"],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{edition:"proto2",fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:11,options:{deprecated:!0}},features:{type:"FeatureSet",id:12},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[5,5],[6,6],[8,8],[9,9]]},FieldOptions:{edition:"proto2",fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},unverifiedLazy:{type:"bool",id:15},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10,options:{deprecated:!0}},debugRedact:{type:"bool",id:16},retention:{type:"OptionRetention",id:17},targets:{rule:"repeated",type:"OptionTargetType",id:19},editionDefaults:{rule:"repeated",type:"EditionDefault",id:20},features:{type:"FeatureSet",id:21},featureSupport:{type:"FeatureSupport",id:22},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[18,18]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}},OptionRetention:{values:{RETENTION_UNKNOWN:0,RETENTION_RUNTIME:1,RETENTION_SOURCE:2}},OptionTargetType:{values:{TARGET_TYPE_UNKNOWN:0,TARGET_TYPE_FILE:1,TARGET_TYPE_EXTENSION_RANGE:2,TARGET_TYPE_MESSAGE:3,TARGET_TYPE_FIELD:4,TARGET_TYPE_ONEOF:5,TARGET_TYPE_ENUM:6,TARGET_TYPE_ENUM_ENTRY:7,TARGET_TYPE_SERVICE:8,TARGET_TYPE_METHOD:9}},EditionDefault:{fields:{edition:{type:"Edition",id:3},value:{type:"string",id:2}}},FeatureSupport:{fields:{editionIntroduced:{type:"Edition",id:1},editionDeprecated:{type:"Edition",id:2},deprecationWarning:{type:"string",id:3},editionRemoved:{type:"Edition",id:4}}}}},OneofOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{edition:"proto2",fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:6,options:{deprecated:!0}},features:{type:"FeatureSet",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[5,5]]},EnumValueOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:1},features:{type:"FeatureSet",id:2},debugRedact:{type:"bool",id:3},featureSupport:{type:"FieldOptions.FeatureSupport",id:4},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:34},deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:33},idempotencyLevel:{type:"IdempotencyLevel",id:34,options:{default:"IDEMPOTENCY_UNKNOWN"}},features:{type:"FeatureSet",id:35},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],nested:{IdempotencyLevel:{values:{IDEMPOTENCY_UNKNOWN:0,NO_SIDE_EFFECTS:1,IDEMPOTENT:2}}}},UninterpretedOption:{edition:"proto2",fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},FeatureSet:{edition:"proto2",fields:{fieldPresence:{type:"FieldPresence",id:1,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},enumType:{type:"EnumType",id:2,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},repeatedFieldEncoding:{type:"RepeatedFieldEncoding",id:3,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},utf8Validation:{type:"Utf8Validation",id:4,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},messageEncoding:{type:"MessageEncoding",id:5,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},jsonFormat:{type:"JsonFormat",id:6,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},enforceNamingStyle:{type:"EnforceNamingStyle",id:7,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},defaultSymbolVisibility:{type:"VisibilityFeature.DefaultSymbolVisibility",id:8,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},extensions:[[1e3,9994],[9995,9999],[1e4,1e4]],reserved:[[999,999]],nested:{FieldPresence:{values:{FIELD_PRESENCE_UNKNOWN:0,EXPLICIT:1,IMPLICIT:2,LEGACY_REQUIRED:3}},EnumType:{values:{ENUM_TYPE_UNKNOWN:0,OPEN:1,CLOSED:2}},RepeatedFieldEncoding:{values:{REPEATED_FIELD_ENCODING_UNKNOWN:0,PACKED:1,EXPANDED:2}},Utf8Validation:{values:{UTF8_VALIDATION_UNKNOWN:0,VERIFY:2,NONE:3}},MessageEncoding:{values:{MESSAGE_ENCODING_UNKNOWN:0,LENGTH_PREFIXED:1,DELIMITED:2}},JsonFormat:{values:{JSON_FORMAT_UNKNOWN:0,ALLOW:1,LEGACY_BEST_EFFORT:2}},EnforceNamingStyle:{values:{ENFORCE_NAMING_STYLE_UNKNOWN:0,STYLE2024:1,STYLE_LEGACY:2}},VisibilityFeature:{fields:{},reserved:[[1,536870911]],nested:{DefaultSymbolVisibility:{values:{DEFAULT_SYMBOL_VISIBILITY_UNKNOWN:0,EXPORT_ALL:1,EXPORT_TOP_LEVEL:2,LOCAL_ALL:3,STRICT:4}}}}}},FeatureSetDefaults:{edition:"proto2",fields:{defaults:{rule:"repeated",type:"FeatureSetEditionDefault",id:1},minimumEdition:{type:"Edition",id:4},maximumEdition:{type:"Edition",id:5}},nested:{FeatureSetEditionDefault:{fields:{edition:{type:"Edition",id:3},overridableFeatures:{type:"FeatureSet",id:4},fixedFeatures:{type:"FeatureSet",id:5}},reserved:[[1,1],[2,2],"features"]}}},SourceCodeInfo:{edition:"proto2",fields:{location:{rule:"repeated",type:"Location",id:1}},extensions:[[536e6,536e6]],nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},span:{rule:"repeated",type:"int32",id:2,options:{packed:!0}},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{edition:"proto2",fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4},semantic:{type:"Semantic",id:5}},nested:{Semantic:{values:{NONE:0,SET:1,ALIAS:2}}}}}},SymbolVisibility:{edition:"proto2",values:{VISIBILITY_UNSET:0,VISIBILITY_LOCAL:1,VISIBILITY_EXPORT:2}}}}}}},Ri={nested:Oi};(function(t,s){var r=Ms;t.exports=s=r.descriptor=r.Root.fromJSON(Ri).lookup(".google.protobuf");var n=r.Namespace,a=r.Root,i=r.Enum,o=r.Type,l=r.Field,c=r.MapField,d=r.OneOf,u=r.Service,h=r.Method;a.fromDescriptor=function(m){typeof m.length=="number"&&(m=s.FileDescriptorSet.decode(m));var N=new a;if(m.file)for(var f,S,v=0,P;v<m.file.length;++v){S=N,(f=m.file[v]).package&&f.package.length&&(S=N.define(f.package));var H=Q(f);if(f.name&&f.name.length&&N.files.push(S.filename=f.name),f.messageType)for(P=0;P<f.messageType.length;++P)S.add(o.fromDescriptor(f.messageType[P],H));if(f.enumType)for(P=0;P<f.enumType.length;++P)S.add(i.fromDescriptor(f.enumType[P],H));if(f.extension)for(P=0;P<f.extension.length;++P)S.add(l.fromDescriptor(f.extension[P],H));if(f.service)for(P=0;P<f.service.length;++P)S.add(u.fromDescriptor(f.service[P],H));var K=q(f.options,s.FileOptions);if(K){var O=Object.keys(K);for(P=0;P<O.length;++P)S.setOption(O[P],K[O[P]])}}return N.resolveAll()},a.prototype.toDescriptor=function(m){var N=s.FileDescriptorSet.create();return j(this,N.file,m),N};function j(T,m,N){var f=s.FileDescriptorProto.create({name:T.filename||(T.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});I(N,f),T instanceof a||(f.package=T.fullName.substring(1));for(var S=0,v;S<T.nestedArray.length;++S)(v=T._nestedArray[S])instanceof o?f.messageType.push(v.toDescriptor(N)):v instanceof i?f.enumType.push(v.toDescriptor()):v instanceof l?f.extension.push(v.toDescriptor(N)):v instanceof u?f.service.push(v.toDescriptor()):v instanceof n&&j(v,m,N);f.options=Y(T.options,s.FileOptions),f.messageType.length+f.enumType.length+f.extension.length+f.service.length&&m.push(f)}var C=0;o.fromDescriptor=function(m,N,f){typeof m.length=="number"&&(m=s.DescriptorProto.decode(m));var S=new o(m.name.length?m.name:"Type"+C++,q(m.options,s.MessageOptions)),v;if(f||(S._edition=N),m.oneofDecl)for(v=0;v<m.oneofDecl.length;++v)S.add(d.fromDescriptor(m.oneofDecl[v]));if(m.field)for(v=0;v<m.field.length;++v){var P=l.fromDescriptor(m.field[v],N,!0);S.add(P),m.field[v].hasOwnProperty("oneofIndex")&&S.oneofsArray[m.field[v].oneofIndex].add(P)}if(m.extension)for(v=0;v<m.extension.length;++v)S.add(l.fromDescriptor(m.extension[v],N,!0));if(m.nestedType)for(v=0;v<m.nestedType.length;++v)S.add(o.fromDescriptor(m.nestedType[v],N,!0)),m.nestedType[v].options&&m.nestedType[v].options.mapEntry&&S.setOption("map_entry",!0);if(m.enumType)for(v=0;v<m.enumType.length;++v)S.add(i.fromDescriptor(m.enumType[v],N,!0));if(m.extensionRange&&m.extensionRange.length)for(S.extensions=[],v=0;v<m.extensionRange.length;++v)S.extensions.push([m.extensionRange[v].start,m.extensionRange[v].end]);if(m.reservedRange&&m.reservedRange.length||m.reservedName&&m.reservedName.length){if(S.reserved=[],m.reservedRange)for(v=0;v<m.reservedRange.length;++v)S.reserved.push([m.reservedRange[v].start,m.reservedRange[v].end]);if(m.reservedName)for(v=0;v<m.reservedName.length;++v)S.reserved.push(m.reservedName[v])}return S},o.prototype.toDescriptor=function(m){var N=s.DescriptorProto.create({name:this.name}),f;for(f=0;f<this.fieldsArray.length;++f){var S;if(N.field.push(S=this._fieldsArray[f].toDescriptor(m)),this._fieldsArray[f]instanceof c){var v=E(this._fieldsArray[f].keyType,this._fieldsArray[f].resolvedKeyType,!1),P=E(this._fieldsArray[f].type,this._fieldsArray[f].resolvedType,!1),H=P===11||P===14?this._fieldsArray[f].resolvedType&&_(this.parent,this._fieldsArray[f].resolvedType)||this._fieldsArray[f].type:void 0;N.nestedType.push(s.DescriptorProto.create({name:S.typeName,field:[s.FieldDescriptorProto.create({name:"key",number:1,label:1,type:v}),s.FieldDescriptorProto.create({name:"value",number:2,label:1,type:P,typeName:H})],options:s.MessageOptions.create({mapEntry:!0})}))}}for(f=0;f<this.oneofsArray.length;++f)N.oneofDecl.push(this._oneofsArray[f].toDescriptor());for(f=0;f<this.nestedArray.length;++f)this._nestedArray[f]instanceof l?N.field.push(this._nestedArray[f].toDescriptor(m)):this._nestedArray[f]instanceof o?N.nestedType.push(this._nestedArray[f].toDescriptor(m)):this._nestedArray[f]instanceof i&&N.enumType.push(this._nestedArray[f].toDescriptor());if(this.extensions)for(f=0;f<this.extensions.length;++f)N.extensionRange.push(s.DescriptorProto.ExtensionRange.create({start:this.extensions[f][0],end:this.extensions[f][1]}));if(this.reserved)for(f=0;f<this.reserved.length;++f)typeof this.reserved[f]=="string"?N.reservedName.push(this.reserved[f]):N.reservedRange.push(s.DescriptorProto.ReservedRange.create({start:this.reserved[f][0],end:this.reserved[f][1]}));return N.options=Y(this.options,s.MessageOptions),N};var p=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function(m,N,f){if(typeof m.length=="number"&&(m=s.DescriptorProto.decode(m)),typeof m.number!="number")throw Error("missing field id");var S;m.typeName&&m.typeName.length?S=m.typeName:S=g(m.type);var v;switch(m.label){case 1:v=void 0;break;case 2:v="required";break;case 3:v="repeated";break;default:throw Error("illegal label: "+m.label)}var P=m.extendee;m.extendee!==void 0&&(P=P.length?P:void 0);var H=new l(m.name.length?m.name:"field"+m.number,m.number,S,v,P);if(f||(H._edition=N),H.options=q(m.options,s.FieldOptions),m.proto3_optional&&(H.options.proto3_optional=!0),m.defaultValue&&m.defaultValue.length){var K=m.defaultValue;switch(K){case"true":case"TRUE":K=!0;break;case"false":case"FALSE":K=!1;break;default:var O=p.exec(K);O&&(K=parseInt(K));break}H.setOption("default",K)}return F(m.type)&&(N==="proto3"?m.options&&!m.options.packed&&H.setOption("packed",!1):(!N||N==="proto2")&&m.options&&m.options.packed&&H.setOption("packed",!0)),H},l.prototype.toDescriptor=function(m){var N=s.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)N.type=11,N.typeName=r.util.ucFirst(this.name),N.label=3;else{switch(N.type=E(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:N.typeName=this.resolvedType?_(this.parent,this.resolvedType):this.type;break}this.rule==="repeated"?N.label=3:this.required&&m==="proto2"?N.label=2:N.label=1}if(N.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(N.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(N.options=Y(this.options,s.FieldOptions),this.options.default!=null&&(N.defaultValue=String(this.options.default)),this.options.proto3_optional&&(N.proto3_optional=!0)),m==="proto3"?this.packed||((N.options||(N.options=s.FieldOptions.create())).packed=!1):(!m||m==="proto2")&&this.packed&&((N.options||(N.options=s.FieldOptions.create())).packed=!0),N};var b=0;i.fromDescriptor=function(m,N,f){typeof m.length=="number"&&(m=s.EnumDescriptorProto.decode(m));var S={};if(m.value)for(var v=0;v<m.value.length;++v){var P=m.value[v].name,H=m.value[v].number||0;S[P&&P.length?P:"NAME"+H]=H}var K=new i(m.name&&m.name.length?m.name:"Enum"+b++,S,q(m.options,s.EnumOptions));return f||(K._edition=N),K},i.prototype.toDescriptor=function(){for(var m=[],N=0,f=Object.keys(this.values);N<f.length;++N)m.push(s.EnumValueDescriptorProto.create({name:f[N],number:this.values[f[N]]}));return s.EnumDescriptorProto.create({name:this.name,value:m,options:Y(this.options,s.EnumOptions)})};var D=0;d.fromDescriptor=function(m){return typeof m.length=="number"&&(m=s.OneofDescriptorProto.decode(m)),new d(m.name&&m.name.length?m.name:"oneof"+D++)},d.prototype.toDescriptor=function(){return s.OneofDescriptorProto.create({name:this.name})};var k=0;u.fromDescriptor=function(m,N,f){typeof m.length=="number"&&(m=s.ServiceDescriptorProto.decode(m));var S=new u(m.name&&m.name.length?m.name:"Service"+k++,q(m.options,s.ServiceOptions));if(f||(S._edition=N),m.method)for(var v=0;v<m.method.length;++v)S.add(h.fromDescriptor(m.method[v]));return S},u.prototype.toDescriptor=function(){for(var m=[],N=0;N<this.methodsArray.length;++N)m.push(this._methodsArray[N].toDescriptor());return s.ServiceDescriptorProto.create({name:this.name,method:m,options:Y(this.options,s.ServiceOptions)})};var w=0;h.fromDescriptor=function(m){return typeof m.length=="number"&&(m=s.MethodDescriptorProto.decode(m)),new h(m.name&&m.name.length?m.name:"Method"+w++,"rpc",m.inputType,m.outputType,!!m.clientStreaming,!!m.serverStreaming,q(m.options,s.MethodOptions))},h.prototype.toDescriptor=function(){return s.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Y(this.options,s.MethodOptions)})};function g(T){switch(T){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+T)}function F(T){switch(T){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function E(T,m,N){switch(T){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(m instanceof i)return 14;if(m instanceof o)return N?10:11;throw Error("illegal type: "+T)}function $(T,m){for(var N={},f=0,S,v;f<m.fieldsArray.length;++f)if((v=(S=m._fieldsArray[f]).name)!=="uninterpretedOption"&&Object.prototype.hasOwnProperty.call(T,v)){var P=z(v);S.resolvedType instanceof o?N[P]=$(T[v],S.resolvedType):S.resolvedType instanceof i?N[P]=S.resolvedType.valuesById[T[v]]:N[P]=T[v]}return N}function q(T,m){if(T)return $(m.toObject(T),m)}function G(T,m){for(var N={},f=Object.keys(T),S=0;S<f.length;++S){var v=f[S],P=r.util.camelCase(v);if(Object.prototype.hasOwnProperty.call(m.fields,P)){var H=m.fields[P];H.resolvedType instanceof o?N[P]=G(T[v],H.resolvedType):N[P]=T[v],H.repeated&&!Array.isArray(N[P])&&(N[P]=[N[P]])}}return N}function Y(T,m){if(T)return m.fromObject(G(T,m))}function _(T,m){var N=T.fullName.split("."),f=m.fullName.split("."),S=0,v=0,P=f.length-1;if(!(T instanceof a)&&m instanceof n)for(;S<N.length&&v<P&&N[S]===f[v];){var H=m.lookup(N[S++],!0);if(H!==null&&H!==m)break;++v}else for(;S<N.length&&v<P&&N[S]===f[v];++S,++v);return f.slice(v).join(".")}function z(T){return T.substring(0,1)+T.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(m,N){return"_"+N.toLowerCase()})}function Q(T){if(T.syntax==="editions")switch(T.edition){case s.Edition.EDITION_2023:return"2023";default:throw new Error("Unsupported edition "+T.edition)}return T.syntax==="proto3"?"proto3":"proto2"}function I(T,m){if(T)if(T==="proto2"||T==="proto3")m.syntax=T;else switch(m.syntax="editions",T){case"2023":m.edition=s.Edition.EDITION_2023;break;default:throw new Error("Unsupported edition "+T)}}})(Bt,Bt.exports);async function Ii(t){return new Promise((s,r)=>{const n=new FileReader;n.onload=async()=>{try{const a=n.result,i=new Uint8Array(a),o=Ee.Root.fromDescriptor(i),l=ws(o);s({name:t.name,messageTypes:l,root:o,uploadedAt:new Date})}catch(a){r(new Error(`è§£æžæè¿°ç¬¦æ–‡ä»¶å¤±è´¥: ${a instanceof Error?a.message:String(a)}`))}},n.onerror=()=>{r(new Error("è¯»å–æ–‡ä»¶å¤±è´¥"))},n.readAsArrayBuffer(t)})}async function Pi(t,s){const r=atob(t),n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);const a=Ee.Root.fromDescriptor(n),i=ws(a);return{name:s,messageTypes:i,root:a,uploadedAt:new Date}}function ws(t){const s=[];function r(n,a){for(const i of n.nestedArray){const o=a?`${a}.${i.name}`:i.name;i instanceof Ee.Type?(s.push(o),r(i,o)):i instanceof Ee.Namespace&&r(i,o)}}return r(t,""),s.sort()}function Mi(t,s,r){try{const n=t.root.lookupType(s);let a;if(typeof r=="string"){const l=atob(r);a=new Uint8Array(l.length);for(let c=0;c<l.length;c++)a[c]=l.charCodeAt(c)}else a=r;const i=n.decode(a);return{success:!0,data:n.toObject(i,{longs:String,enums:String,bytes:String,defaults:!1,arrays:!0,objects:!0})}}catch(n){return{success:!1,error:n instanceof Error?n.message:String(n)}}}function Ht(t){try{let s;if(typeof t=="string"){const a=atob(t);s=new Uint8Array(a.length);for(let i=0;i<a.length;i++)s[i]=a.charCodeAt(i)}else s=t;const r=new Ee.Reader(s),n={};for(;r.pos<r.len;){const a=r.uint32(),i=a>>>3,o=a&7;let l;switch(o){case 0:l=r.int64().toString();break;case 1:l=r.fixed64().toString();break;case 2:const d=r.bytes();try{const u=new TextDecoder("utf-8",{fatal:!0}).decode(d);Fi(u)?l=u:l=`[${d.length} bytes]`}catch{l=`[${d.length} bytes]`}break;case 5:l=r.fixed32();break;default:r.skipType(o);continue}const c=`field_${i}`;c in n?Array.isArray(n[c])?n[c].push(l):n[c]=[n[c],l]:n[c]=l}return Object.keys(n).length>0?n:null}catch{return null}}function Fi(t){return/^[\x20-\x7E\u4E00-\u9FFF\u3000-\u303F\s]+$/.test(t)}function $e(t,s=0){const r="  ".repeat(s),n=[];for(const[a,i]of Object.entries(t))if(i!=null)if(Array.isArray(i)){if(i.length===0)continue;n.push(`${r}${a}: [`);for(const o of i)typeof o=="object"&&o!==null?(n.push(`${r}  {`),n.push($e(o,s+2)),n.push(`${r}  }`)):n.push(`${r}  ${Wt(o)}`);n.push(`${r}]`)}else typeof i=="object"?(n.push(`${r}${a}: {`),n.push($e(i,s+1)),n.push(`${r}}`)):n.push(`${r}${a}: ${Wt(i)}`);return n.join(`
`)}function Wt(t){if(typeof t=="string"){const s=Number(t);if(!isNaN(s)){if(s>1e12&&s<2e12)return`${t} (${new Date(s).toISOString()})`;if(s>1e9&&s<2e9)return`${t} (${new Date(s*1e3).toISOString()})`}return`"${t}"`}return String(t)}async function Li(t){return new Promise((s,r)=>{const n=new FileReader;n.onload=()=>{const a=n.result,i=a.split(",")[1]||a;s(i)},n.onerror=r,n.readAsDataURL(t)})}const xt=ne()(es((t,s)=>({descriptorMeta:[],activeDescriptors:new Map,columnConfigs:[],loading:!1,error:null,uploadDescriptor:async r=>{t({loading:!0,error:null});try{const n=await Ii(r),a=await Li(r),i=s().descriptorMeta.findIndex(o=>o.name===n.name);t(o=>{const l=[...o.descriptorMeta],c={name:n.name,messageTypes:n.messageTypes,uploadedAt:n.uploadedAt.toISOString(),rawData:a};i>=0?l[i]=c:l.push(c);const d=new Map(o.activeDescriptors);return d.set(n.name,n),{descriptorMeta:l,activeDescriptors:d,loading:!1}})}catch(n){t({error:n instanceof Error?n.message:String(n),loading:!1})}},restoreDescriptor:async r=>{const{activeDescriptors:n,descriptorMeta:a}=s();if(n.has(r))return n.get(r);const i=a.find(o=>o.name===r);if(!i)return null;try{const o=await Pi(i.rawData,i.name);return t(l=>{const c=new Map(l.activeDescriptors);return c.set(r,o),{activeDescriptors:c}}),o}catch(o){return console.error("Failed to restore descriptor:",o),null}},removeDescriptor:r=>{t(n=>({descriptorMeta:n.descriptorMeta.filter(a=>a.name!==r),activeDescriptors:new Map([...n.activeDescriptors].filter(([a])=>a!==r)),columnConfigs:n.columnConfigs.filter(a=>a.descriptorName!==r)}))},addColumnConfig:r=>{t(n=>{const a=n.columnConfigs.findIndex(o=>o.dbId===r.dbId&&o.tableName===r.tableName&&o.columnName===r.columnName),i=[...n.columnConfigs];return a>=0?i[a]=r:i.push(r),{columnConfigs:i}})},removeColumnConfig:(r,n,a)=>{t(i=>({columnConfigs:i.columnConfigs.filter(o=>!(o.dbId===r&&o.tableName===n&&o.columnName===a))}))},getColumnConfig:(r,n,a)=>s().columnConfigs.find(i=>i.dbId===r&&i.tableName===n&&i.columnName===a)||null,decodeBlobData:async(r,n,a,i)=>{const o=s().getColumnConfig(r,n,a);if(!o)return{success:!1,error:"æœªé…ç½® Protobuf è§£æž"};const l=await s().restoreDescriptor(o.descriptorName);return l?Mi(l,o.messageType,i):{success:!1,error:`æè¿°ç¬¦ "${o.descriptorName}" æœªæ‰¾åˆ°`}},getAvailableMessageTypes:()=>{const{descriptorMeta:r}=s(),n=[];for(const a of r)n.push(...a.messageTypes);return[...new Set(n)].sort()},clearAll:()=>{t({descriptorMeta:[],activeDescriptors:new Map,columnConfigs:[],error:null})}}),{name:"protobuf-store",partialize:t=>({descriptorMeta:t.descriptorMeta,columnConfigs:t.columnConfigs})}));function _i({className:t,dbId:s,tableName:r,columns:n,onClose:a}){const{descriptorMeta:i,columnConfigs:o,loading:l,error:c,uploadDescriptor:d,removeDescriptor:u,addColumnConfig:h,removeColumnConfig:j,getColumnConfig:C}=xt(),p=x.useRef(null),[b,D]=x.useState("descriptors"),[k,w]=x.useState(null),[g,F]=x.useState(""),[E,$]=x.useState(""),q=n.filter(I=>{var m;const T=(m=I.type)==null?void 0:m.toLowerCase();return T==="blob"||T===null||T===""}),G=x.useCallback(async I=>{var m;const T=(m=I.target.files)==null?void 0:m[0];T&&(await d(T),p.current&&(p.current.value=""))},[d]),Y=x.useCallback(()=>{if(!s||!r||!k||!g||!E)return;h({dbId:s,tableName:r,columnName:k,messageType:E,descriptorName:g}),w(null),$("")},[s,r,k,g,E,h]),_=i.find(I=>I.name===g),z=(_==null?void 0:_.messageTypes)||[],Q=o.filter(I=>I.dbId===s&&I.tableName===r);return e.jsxs("div",{className:y("bg-bg-dark rounded-lg border border-border shadow-lg",t),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-400",children:"ðŸ“¦"}),e.jsx("h3",{className:"font-medium text-text-primary text-sm",children:"Protobuf é…ç½®"})]}),e.jsx("button",{onClick:a,className:"p-1 rounded hover:bg-bg-light text-text-muted hover:text-text-secondary transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"flex border-b border-border",children:[e.jsxs("button",{onClick:()=>D("descriptors"),className:y("flex-1 px-4 py-2 text-xs font-medium transition-colors",b==="descriptors"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-secondary"),children:["æè¿°ç¬¦ (",i.length,")"]}),e.jsxs("button",{onClick:()=>D("columns"),className:y("flex-1 px-4 py-2 text-xs font-medium transition-colors",b==="columns"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-secondary"),children:["åˆ—æ˜ å°„ (",Q.length,")"]})]}),e.jsx("div",{className:"p-4",children:b==="descriptors"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{ref:p,type:"file",accept:".desc,.bin",onChange:G,className:"hidden"}),e.jsx("button",{onClick:()=>{var I;return(I=p.current)==null?void 0:I.click()},disabled:l,className:"w-full px-4 py-2 bg-primary/20 text-primary rounded-lg text-sm font-medium hover:bg-primary/30 disabled:opacity-50 transition-colors",children:l?"åŠ è½½ä¸­...":"ðŸ“ ä¸Šä¼  .desc æ–‡ä»¶"}),e.jsxs("p",{className:"text-xs text-text-muted mt-2",children:["ä½¿ç”¨ ",e.jsx("code",{className:"bg-bg-light px-1 rounded",children:"protoc --descriptor_set_out"})," ç”Ÿæˆ"]})]}),c&&e.jsx("div",{className:"px-3 py-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400",children:c}),i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(I=>e.jsxs("div",{className:"p-3 bg-bg-light rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono text-sm text-text-primary truncate",children:I.name}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:[I.messageTypes.length," ä¸ªæ¶ˆæ¯ç±»åž‹"]}),e.jsx("div",{className:"text-2xs text-text-muted/50 mt-0.5",children:new Date(I.uploadedAt).toLocaleString()})]}),e.jsx("button",{onClick:()=>u(I.name),className:"p-1 rounded text-red-400 hover:bg-red-500/10 transition-colors",title:"åˆ é™¤",children:"ðŸ—‘ï¸"})]}),e.jsx("div",{className:"mt-2 max-h-24 overflow-auto",children:e.jsxs("div",{className:"text-2xs font-mono text-text-muted space-y-0.5",children:[I.messageTypes.slice(0,10).map(T=>e.jsx("div",{className:"truncate",children:T},T)),I.messageTypes.length>10&&e.jsxs("div",{className:"text-text-muted/50",children:["... è¿˜æœ‰ ",I.messageTypes.length-10," ä¸ª"]})]})})]},I.name))}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx("div",{className:"text-3xl mb-2 opacity-50",children:"ðŸ“­"}),e.jsx("p",{className:"text-sm",children:"å°šæœªä¸Šä¼ æè¿°ç¬¦æ–‡ä»¶"})]})]}):e.jsx("div",{className:"space-y-4",children:s&&r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-text-muted",children:["å½“å‰è¡¨: ",e.jsx("span",{className:"font-mono text-text-secondary",children:r})]}),Q.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"å·²é…ç½®çš„åˆ—:"}),Q.map(I=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-bg-light rounded border border-border",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono text-sm text-primary",children:I.columnName}),e.jsxs("div",{className:"text-xs text-text-muted truncate",children:["â†’ ",I.messageType]})]}),e.jsx("button",{onClick:()=>j(I.dbId,I.tableName,I.columnName),className:"p-1 rounded text-red-400 hover:bg-red-500/10 transition-colors",children:"âœ•"})]},I.columnName))]}),i.length>0&&q.length>0?e.jsxs("div",{className:"space-y-3 p-3 bg-bg-lighter rounded-lg border border-border",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"æ·»åŠ é…ç½®:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-2xs text-text-muted mb-1",children:"BLOB åˆ—"}),e.jsxs("select",{value:k||"",onChange:I=>w(I.target.value||null),className:"w-full px-2 py-1.5 bg-bg-dark border border-border rounded text-sm text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"é€‰æ‹©åˆ—..."}),q.map(I=>{const T=C(s,r,I.name);return e.jsxs("option",{value:I.name,disabled:!!T,children:[I.name," ",T?"(å·²é…ç½®)":""]},I.name)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-2xs text-text-muted mb-1",children:"æè¿°ç¬¦"}),e.jsxs("select",{value:g,onChange:I=>{F(I.target.value),$("")},className:"w-full px-2 py-1.5 bg-bg-dark border border-border rounded text-sm text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"é€‰æ‹©æè¿°ç¬¦..."}),i.map(I=>e.jsx("option",{value:I.name,children:I.name},I.name))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-2xs text-text-muted mb-1",children:"æ¶ˆæ¯ç±»åž‹"}),e.jsxs("select",{value:E,onChange:I=>$(I.target.value),disabled:!g,className:"w-full px-2 py-1.5 bg-bg-dark border border-border rounded text-sm text-text-primary focus:outline-none focus:border-primary disabled:opacity-50",children:[e.jsx("option",{value:"",children:"é€‰æ‹©æ¶ˆæ¯ç±»åž‹..."}),z.map(I=>e.jsx("option",{value:I,children:I},I))]})]}),e.jsx("button",{onClick:Y,disabled:!k||!g||!E,className:"w-full px-3 py-1.5 bg-primary text-white rounded text-sm font-medium hover:bg-primary/90 disabled:opacity-50 transition-colors",children:"æ·»åŠ æ˜ å°„"})]}):i.length===0?e.jsx("div",{className:"text-center py-4 text-text-muted text-xs",children:"è¯·å…ˆä¸Šä¼ æè¿°ç¬¦æ–‡ä»¶"}):e.jsx("div",{className:"text-center py-4 text-text-muted text-xs",children:"å½“å‰è¡¨æ²¡æœ‰ BLOB ç±»åž‹çš„åˆ—"})]}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx("div",{className:"text-3xl mb-2 opacity-50",children:"ðŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:"è¯·å…ˆé€‰æ‹©ä¸€ä¸ªè¡¨"})]})})})]})}function Ai({value:t,dbId:s,tableName:r,columnName:n,maxWidth:a=300}){const{getColumnConfig:i,decodeBlobData:o}=xt(),[l,c]=x.useState(!1),[d,u]=x.useState("decoded"),[h,j]=x.useState(null),[C,p]=x.useState(null),[b,D]=x.useState(!1),k=i(s,r,n);x.useEffect(()=>{if(!(!t||!l))if(D(!0),p(null),k)o(s,r,n,t).then(E=>{D(!1),E.success?(j(E.data),p(null)):(j(null),p(E.error))});else{const E=Ht(t);j(E),p(E?null:"æ— æ³•è‡ªåŠ¨è§£æž"),D(!1)}},[t,l,k,s,r,n,o]);const w=x.useMemo(()=>{try{return atob(t).length}catch{return 0}},[t]),g=x.useMemo(()=>{try{const E=atob(t),$=[];for(let q=0;q<Math.min(E.length,256);q++)$.push(E.charCodeAt(q).toString(16).padStart(2,"0"));return $}catch{return[]}},[t]),F=x.useMemo(()=>d!=="wire"||!l?null:Ht(t),[t,d,l]);return l?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>c(!1),children:e.jsxs("div",{className:"bg-bg-dark rounded-lg border border-border shadow-2xl max-w-2xl w-full max-h-[80vh] flex flex-col",style:{maxWidth:a},onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-400",children:"ðŸ“¦"}),e.jsx("span",{className:"font-mono text-sm text-text-primary",children:n}),e.jsxs("span",{className:"text-xs text-text-muted",children:["(",w," bytes)"]}),k&&e.jsx("span",{className:"text-xs text-green-400 bg-green-400/10 px-2 py-0.5 rounded",children:k.messageType})]}),e.jsx("button",{onClick:()=>c(!1),className:"p-1 rounded hover:bg-bg-light text-text-muted hover:text-text-secondary transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"flex gap-1 px-4 py-2 border-b border-border",children:[e.jsx("button",{onClick:()=>u("decoded"),className:y("px-3 py-1 text-xs rounded transition-colors",d==="decoded"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),children:k?"Schema è§£ç ":"è‡ªåŠ¨è§£æž"}),e.jsx("button",{onClick:()=>u("wire"),className:y("px-3 py-1 text-xs rounded transition-colors",d==="wire"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),children:"Wire Format"}),e.jsx("button",{onClick:()=>u("hex"),className:y("px-3 py-1 text-xs rounded transition-colors",d==="hex"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),children:"Hex"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:b?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"})}):d==="decoded"?h?e.jsx("pre",{className:"text-xs font-mono text-text-secondary whitespace-pre-wrap",children:$e(h)}):C?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-yellow-400 mb-2",children:"âš ï¸"}),e.jsx("p",{className:"text-sm text-text-muted",children:C}),!k&&e.jsx("p",{className:"text-xs text-text-muted/50 mt-2",children:"é…ç½® Protobuf Schema ä»¥èŽ·å¾—æ›´å¥½çš„è§£æžç»“æžœ"})]}):null:d==="wire"?F?e.jsx("pre",{className:"text-xs font-mono text-text-secondary whitespace-pre-wrap",children:$e(F)}):e.jsx("div",{className:"text-center py-8 text-text-muted",children:"æ— æ³•è§£æž Wire Format"}):e.jsxs("div",{className:"font-mono text-xs",children:[e.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.map((E,$)=>e.jsx("span",{className:y("px-1 py-0.5 rounded",$%16<8?"bg-bg-light":"bg-bg-lighter"),children:E},$)),w>256&&e.jsxs("span",{className:"text-text-muted px-2",children:["... è¿˜æœ‰ ",w-256," bytes"]})]}),e.jsxs("div",{className:"mt-4 text-text-muted",children:["å…± ",w," bytes"]})]})}),!k&&d==="decoded"&&e.jsx("div",{className:"px-4 py-2 border-t border-border text-xs text-text-muted bg-bg-darker",children:"ðŸ’¡ æç¤ºï¼šä¸Šä¼  .desc æ–‡ä»¶å¹¶é…ç½®åˆ—æ˜ å°„å¯èŽ·å¾—ç²¾ç¡®çš„è§£æžç»“æžœ"})]})}):e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-1 text-xs text-purple-400 hover:text-purple-300 transition-colors",title:"ç‚¹å‡»å±•å¼€",children:[e.jsx("span",{className:"opacity-70",children:"ðŸ“¦"}),e.jsx("span",{className:"font-mono",children:k?`[${k.messageType.split(".").pop()}]`:`[BLOB ${w}B]`}),k&&e.jsx("span",{className:"text-green-400 text-2xs",children:"âœ“"})]})}function $i(t){if(!t||typeof t!="string"||t.length<4||t.length%4!==0||!/^[A-Za-z0-9+/]+=*$/.test(t))return!1;try{const r=atob(t);let n=0;for(let a=0;a<Math.min(r.length,100);a++){const i=r.charCodeAt(a);(i<32||i>126)&&n++}return n/Math.min(r.length,100)>.3}catch{return!1}}function Bi({deviceId:t}){var J;const{databases:s,dbLoading:r,dbError:n,selectedDb:a,selectedTable:i,tables:o,tablesLoading:l,schema:c,showSchema:d,tableData:u,dataLoading:h,dataError:j,page:C,pageSize:p,orderBy:b,ascending:D,queryMode:k,queryInput:w,queryResult:g,queryLoading:F,queryError:E,dbSortOrder:$,dbSortAscending:q,loadDatabases:G,loadTables:Y,loadSchema:_,loadTableData:z,selectDb:Q,selectTable:I,setShowSchema:T,setSortAndReload:m,setPageAndReload:N,setQueryMode:f,setQueryInput:S,executeQuery:v,setDbSortOrder:P,toggleDbSortDirection:H,getSortedDatabases:K}=Di(),{descriptorMeta:O,getColumnConfig:W}=xt(),[A,L]=x.useState(!1);x.useEffect(()=>{s.length===0&&G(t)},[t,s.length,G]),x.useEffect(()=>{a&&o.length===0&&Y(t,a)},[t,a,o.length,Y]),x.useEffect(()=>{a&&i&&!u&&(_(t,a,i),z(t,a,i))},[t,a,i,u,_,z]);const X=x.useCallback(R=>{Q(R),Y(t,R)},[Q,Y,t]),ae=x.useCallback(R=>{I(R),a&&(_(t,a,R),z(t,a,R))},[I,a,t,_,z]),M=x.useCallback(R=>{m(t,R)},[m,t]),Z=x.useCallback(R=>{N(t,R)},[N,t]),re=R=>R===null?"-":R<1024?`${R} B`:R<1024*1024?`${(R/1024).toFixed(1)} KB`:`${(R/(1024*1024)).toFixed(1)} MB`,ee=R=>{switch(R){case"log":return"ðŸ“‹";case"cache":return"âš¡";default:return"ðŸ“"}};return r?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full"})}):n?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"âš ï¸"}),e.jsx("p",{className:"text-sm mb-3",children:n}),e.jsx("button",{onClick:()=>G(t),className:"px-4 py-2 bg-primary/20 text-primary rounded-lg hover:bg-primary/30 transition-colors",children:"é‡è¯•"})]}):s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ðŸ—ƒï¸"}),e.jsx("p",{className:"text-sm",children:"æ²¡æœ‰æ³¨å†Œçš„æ•°æ®åº“"}),e.jsx("p",{className:"text-xs mt-2 text-text-muted",children:"åœ¨ iOS App ä¸­ä½¿ç”¨ DatabaseRegistry.shared.register() æ³¨å†Œæ•°æ®åº“"})]}):e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-64 flex-shrink-0 border-r border-border bg-bg-dark flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-medium text-text-muted uppercase tracking-wider",children:"æ•°æ®åº“"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("select",{value:$,onChange:R=>P(R.target.value),className:"text-2xs bg-bg-light border border-border rounded px-1.5 py-0.5 text-text-secondary focus:outline-none focus:border-primary",title:"æŽ’åºæ–¹å¼",children:[e.jsx("option",{value:"name",children:"åç§°"}),e.jsx("option",{value:"size",children:"å¤§å°"}),e.jsx("option",{value:"tableCount",children:"è¡¨æ•°"})]}),e.jsx("button",{onClick:H,className:"p-1 rounded hover:bg-bg-light text-text-muted hover:text-text-secondary transition-colors",title:q?"å‡åº":"é™åº",children:e.jsx("span",{className:"text-xs",children:q?"â†‘":"â†“"})})]})]}),e.jsx("div",{className:"space-y-1",children:K().map(R=>e.jsx("button",{onClick:()=>X(R.descriptor.id),className:y("w-full px-3 py-2 rounded-lg text-left text-xs transition-all",a===R.descriptor.id?"bg-primary text-white shadow-sm shadow-primary/30":"text-text-secondary hover:bg-bg-light"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:ee(R.descriptor.kind)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:R.descriptor.name}),e.jsxs("div",{className:y("text-2xs",a===R.descriptor.id?"text-white/70":"text-text-muted"),children:[R.tableCount," è¡¨ â€¢ ",re(R.fileSizeBytes)]})]}),R.descriptor.isSensitive&&e.jsx("span",{className:"text-yellow-500",title:"æ•æ„Ÿæ•°æ®",children:"ðŸ”’"})]})},R.descriptor.id))})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-xs font-medium text-text-muted uppercase tracking-wider",children:["è¡¨ ",o.length>0&&`(${o.length})`]}),a&&e.jsx("button",{onClick:()=>f(!k),className:y("px-2 py-1 rounded text-xs transition-colors",k?"bg-accent-blue/20 text-accent-blue":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),title:"SQL æŸ¥è¯¢",children:"</>"})]}),l?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-primary border-t-transparent rounded-full"})}):a?e.jsx("div",{className:"space-y-1",children:o.map(R=>e.jsx("button",{onClick:()=>ae(R.name),className:y("w-full px-3 py-2 rounded-lg text-left text-xs transition-all",i===R.name?"bg-accent-blue text-white shadow-sm shadow-accent-blue/30":"text-text-secondary hover:bg-bg-light"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-mono truncate",children:R.name}),e.jsx("span",{className:y("tabular-nums",i===R.name?"text-white/70":"text-text-muted"),children:R.rowCount!==null?R.rowCount.toLocaleString():"?"})]})},R.name))}):e.jsx("p",{className:"text-xs text-text-muted text-center py-4",children:"è¯·å…ˆé€‰æ‹©æ•°æ®åº“"})]})]}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:k?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-border bg-bg-dark/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:"SQL æŸ¥è¯¢"}),e.jsx("span",{className:"text-xs text-text-muted/50",children:"ï¼ˆä»…æ”¯æŒ SELECTï¼‰"})]}),e.jsx("textarea",{value:w,onChange:R=>S(R.target.value),placeholder:"SELECT * FROM table_name LIMIT 100",className:"w-full h-24 px-3 py-2 bg-bg-light border border-border rounded-lg text-sm font-mono text-text-primary placeholder:text-text-muted resize-none focus:outline-none focus:border-primary/50",onKeyDown:R=>{(R.metaKey||R.ctrlKey)&&R.key==="Enter"&&v(t)}}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:g&&e.jsxs(e.Fragment,{children:[g.rowCount," è¡Œ â€¢ ",g.executionTimeMs.toFixed(2)," ms"]})}),e.jsx("button",{onClick:()=>v(t),disabled:F||!w.trim(),className:"px-4 py-1.5 bg-primary text-white rounded text-xs font-medium hover:bg-primary/90 disabled:opacity-50 transition-colors",children:F?"æ‰§è¡Œä¸­...":"æ‰§è¡Œ (âŒ˜â†µ)"})]}),E&&e.jsx("div",{className:"mt-2 px-3 py-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400",children:E})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:F?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"})}):g?e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"sticky top-0 bg-bg-dark",children:e.jsx("tr",{children:g.columns.map(R=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-text-muted border-b border-border",children:R.name},R.name))})}),e.jsx("tbody",{className:"font-mono",children:g.rows.map((R,ue)=>e.jsx("tr",{className:"border-b border-border/30 hover:bg-bg-light/30 transition-colors",children:g.columns.map(ie=>e.jsx("td",{className:"px-3 py-2 text-text-secondary max-w-xs truncate",title:R.values[ie.name]??"",children:R.values[ie.name]===null?e.jsx("span",{className:"text-text-muted italic",children:"NULL"}):R.values[ie.name]},ie.name))},ue))})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-3 block opacity-50",children:"ðŸ“"}),e.jsx("p",{className:"text-sm",children:"è¾“å…¥ SQL æŸ¥è¯¢è¯­å¥å¹¶æ‰§è¡Œ"})]})})})]}):i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 border-b border-border bg-bg-dark/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-mono text-sm text-text-primary",children:i}),u&&e.jsxs("span",{className:"text-xs text-text-muted",children:[((J=u.totalRows)==null?void 0:J.toLocaleString())??"?"," è¡Œ"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>L(!A),className:y("px-3 py-1.5 rounded text-xs transition-colors",A?"bg-purple-500/20 text-purple-400":O.length>0?"bg-purple-500/10 text-purple-400 hover:bg-purple-500/20":"bg-bg-light text-text-secondary hover:bg-bg-lighter"),title:"Protobuf é…ç½®",children:["ðŸ“¦ Protobuf ",O.length>0&&`(${O.length})`]}),e.jsx("button",{onClick:()=>T(!d),className:y("px-3 py-1.5 rounded text-xs transition-colors",d?"bg-primary/20 text-primary":"bg-bg-light text-text-secondary hover:bg-bg-lighter"),children:"ðŸ“‹ Schema"}),e.jsx("button",{onClick:()=>a&&i&&z(t,a,i),disabled:h,className:"px-3 py-1.5 bg-bg-light text-text-secondary rounded text-xs hover:bg-bg-lighter transition-colors disabled:opacity-50",children:"ðŸ”„ åˆ·æ–°"})]})]}),A&&e.jsx("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/30",children:e.jsx(_i,{dbId:a,tableName:i,columns:c.map(R=>({name:R.name,type:R.type})),onClose:()=>L(!1)})}),d&&c.length>0&&e.jsx("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/30",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-text-muted",children:[e.jsx("th",{className:"pb-2 font-medium",children:"åˆ—å"}),e.jsx("th",{className:"pb-2 font-medium",children:"ç±»åž‹"}),e.jsx("th",{className:"pb-2 font-medium",children:"ä¸»é”®"}),e.jsx("th",{className:"pb-2 font-medium",children:"éžç©º"}),e.jsx("th",{className:"pb-2 font-medium",children:"é»˜è®¤å€¼"})]})}),e.jsx("tbody",{className:"font-mono",children:c.map(R=>e.jsxs("tr",{className:"border-t border-border/30",children:[e.jsx("td",{className:"py-1.5 text-primary",children:R.name}),e.jsx("td",{className:"py-1.5 text-text-secondary",children:R.type||"-"}),e.jsx("td",{className:"py-1.5",children:R.primaryKey?"âœ“":""}),e.jsx("td",{className:"py-1.5",children:R.notNull?"âœ“":""}),e.jsx("td",{className:"py-1.5 text-text-muted",children:R.defaultValue||"-"})]},R.name))})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:h?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"})}):u?e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"sticky top-0 bg-bg-dark",children:e.jsx("tr",{children:u.columns.map(R=>e.jsx("th",{onClick:()=>M(R.name),className:"px-3 py-2 text-left font-medium text-text-muted border-b border-border cursor-pointer hover:bg-bg-light/50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:R.primaryKey?"text-primary":"",children:R.name}),b===R.name&&e.jsx("span",{className:"text-primary",children:D?"â†‘":"â†“"})]})},R.name))})}),e.jsx("tbody",{className:"font-mono",children:u.rows.map((R,ue)=>e.jsx("tr",{className:"border-b border-border/30 hover:bg-bg-light/30 transition-colors",children:u.columns.map(ie=>{var ht;const pe=R.values[ie.name],ks=((ht=ie.type)==null?void 0:ht.toLowerCase())==="blob",Ss=a&&i&&W(a,i,ie.name),Es=ks||pe&&$i(pe)&&Ss;return e.jsx("td",{className:"px-3 py-2 text-text-secondary max-w-xs",children:pe===null?e.jsx("span",{className:"text-text-muted italic",children:"NULL"}):Es&&a&&i?e.jsx(Ai,{value:pe,dbId:a,tableName:i,columnName:ie.name}):e.jsx("span",{className:"truncate block",title:pe??"",children:pe})},ie.name)})},ue))})]}):j?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"âš ï¸"}),e.jsx("p",{className:"text-sm text-red-400 mb-2",children:j}),e.jsx("button",{onClick:()=>a&&i&&z(t,a,i),className:"px-4 py-2 bg-primary/20 text-primary rounded-lg hover:bg-primary/30 transition-colors text-xs",children:"é‡è¯•"})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"æ— æ•°æ®"})}),u&&u.totalRows!==null&&u.totalRows>p&&e.jsxs("div",{className:"px-4 py-2 border-t border-border bg-bg-dark/50 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-text-muted",children:["ç¬¬ ",C," é¡µ / å…± ",Math.ceil(u.totalRows/p)," é¡µ"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Z(Math.max(1,C-1)),disabled:C<=1,className:"px-3 py-1 bg-bg-light text-text-secondary rounded text-xs hover:bg-bg-lighter disabled:opacity-50 transition-colors",children:"ä¸Šä¸€é¡µ"}),e.jsx("button",{onClick:()=>Z(C+1),disabled:C>=Math.ceil(u.totalRows/p),className:"px-3 py-1 bg-bg-light text-text-secondary rounded text-xs hover:bg-bg-lighter disabled:opacity-50 transition-colors",children:"ä¸‹ä¸€é¡µ"})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-3 block opacity-50",children:"ðŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:a?"é€‰æ‹©ä¸€ä¸ªè¡¨æŸ¥çœ‹æ•°æ®":"é€‰æ‹©ä¸€ä¸ªæ•°æ®åº“"})]})})})]})}function Hi(t){const s=x.useCallback(r=>{const n=r.target,a=n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.isContentEditable;for(const i of t){const o=r.key.toLowerCase()===i.key.toLowerCase(),l=i.shift?r.shiftKey:!r.shiftKey,c=i.alt?r.altKey:!r.altKey,d=i.ctrl?r.ctrlKey||r.metaKey:!r.ctrlKey&&!r.metaKey;if(o&&d&&l&&c){if(a&&!i.allowInInput)continue;r.preventDefault(),i.action();return}}},[t]);x.useEffect(()=>(window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)),[s])}const Qe=[{id:"http",label:"HTTP",icon:"ðŸŒ",description:"HTTP/HTTPS è¯·æ±‚",group:"monitor"},{id:"websocket",label:"WebSocket",icon:"ðŸ”Œ",description:"WS è¿žæŽ¥",group:"monitor"},{id:"logs",label:"æ—¥å¿—",icon:"ðŸ“",description:"åº”ç”¨æ—¥å¿—",group:"monitor"},{id:"breakpoint",label:"æ–­ç‚¹",icon:"â¸ï¸",description:"è¯·æ±‚æ–­ç‚¹",group:"debug"},{id:"mock",label:"Mock",icon:"ðŸŽ­",description:"æŽ¥å£æ¨¡æ‹Ÿ",group:"debug"},{id:"chaos",label:"æ•…éšœæ³¨å…¥",icon:"ðŸŽ²",description:"æ•…éšœæ³¨å…¥",group:"debug"},{id:"database",label:"æ•°æ®åº“",icon:"ðŸ—ƒï¸",description:"SQLite æµè§ˆ",group:"data"}];function Wi(){const{deviceId:t}=Ds(),s=tt(),[r,n]=Os(),a=r.get("tab"),i=(a==="network"?"http":a)||"http",[o,l]=x.useState(i),[c,d]=x.useState(!0),[u,h]=x.useState(!0),[j,C]=x.useState(!1),[p,b]=x.useState(!1),[D,k]=x.useState(!1),[w,g]=x.useState(!1),F=x.useCallback(M=>{l(M),n({tab:M},{replace:!0})},[n]),{currentDevice:E,selectDevice:$,clearSelection:q,toggleCapture:G,clearDeviceData:Y,toggleFavorite:_,isFavorite:z}=He(),{setConnected:Q,setInDeviceDetail:I}=Fe(),T=We(M=>M.toggleTheme),{addActivity:m,clearActivities:N}=ts(),f=nt(),S=Qt(),v=Xt(),P=Or(),H=Mr();Hi([...Qe.map((M,Z)=>({key:String(Z+1),ctrl:!0,description:`åˆ‡æ¢åˆ°${M.label}`,action:()=>F(M.id)})),{key:"k",ctrl:!0,description:"æœç´¢",action:()=>{const M=document.querySelector("[data-search-input]");M==null||M.focus()}},{key:"r",ctrl:!0,description:"åˆ·æ–°",action:()=>{t&&(o==="http"?f.fetchEvents(t):o==="logs"?S.fetchEvents(t):o==="websocket"?v.fetchSessions(t):o==="mock"&&P.fetchRules(t))}},{key:"l",ctrl:!0,description:"æ¸…ç©ºåˆ—è¡¨",action:()=>{o==="http"?f.clearEvents():o==="logs"&&S.clearEvents()}},{key:"t",ctrl:!0,description:"åˆ‡æ¢ä¸»é¢˜",action:T},{key:"/",ctrl:!0,description:"æ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©",action:()=>C(!0)},{key:"Escape",description:"å–æ¶ˆé€‰æ‹©",action:()=>{j?C(!1):P.isEditorOpen?P.closeEditor():f.isSelectMode?f.toggleSelectMode():f.clearSelection()}},{key:"a",ctrl:!0,description:"å…¨é€‰",action:()=>{o==="http"&&f.isSelectMode&&f.selectAll()}},{key:"Backspace",description:"åˆ é™¤é€‰ä¸­",action:()=>{o==="http"&&f.isSelectMode&&f.selectedIds.size>0&&t&&f.batchDelete(t)}},{key:"f",description:"æ”¶è—",action:()=>{o==="http"&&f.isSelectMode&&f.selectedIds.size>0&&t&&f.batchFavorite(t,!0)}}]),x.useEffect(()=>{if(!t)return;I(!0),$(t),f.fetchEvents(t),S.fetchEvents(t),S.fetchFilterOptions(t),v.fetchSessions(t),P.fetchRules(t),Oe.connect(t);const M=Oe.onMessage(re=>{if(re.deviceId===t)switch(re.type){case"httpEvent":f.addRealtimeEvent(Lr(re.payload));break;case"logEvent":S.addRealtimeEvent(_r(re.payload));break;case"wsEvent":{const ee=Ar(re.payload);if(ee.type==="sessionCreated"){const J=ee.data;v.addRealtimeSession({id:J.id,url:J.url,connectTime:J.connectTime,disconnectTime:null,closeCode:null,closeReason:null,isOpen:!0})}else if(ee.type==="sessionClosed"){const J=ee.data;v.updateSessionStatus(J.id,!1,J.closeCode,J.closeReason)}else if(ee.type==="frame"){const J=ee.data;v.sessions.some(ue=>ue.id===J.sessionId)||(v.addRealtimeSession({id:J.sessionId,url:"(loading...)",connectTime:J.timestamp,disconnectTime:null,closeCode:null,closeReason:null,isOpen:!0}),Vt(t,J.sessionId).then(ue=>{v.updateSessionUrl(J.sessionId,ue.url)}).catch(()=>{v.updateSessionUrl(J.sessionId,"(unknown)")}));const R=J.payload?Math.floor(J.payload.length*3/4):0;v.addRealtimeFrame({id:J.id,sessionId:J.sessionId,direction:J.direction,opcode:J.opcode,payloadPreview:J.payloadPreview??null,payloadSize:R,timestamp:J.timestamp,isMocked:J.isMocked})}break}case"deviceConnected":{const ee=JSON.parse(re.payload);m({id:`${ee.sessionId}-connected`,deviceId:t,sessionId:ee.sessionId,timestamp:new Date().toISOString(),type:"connected",deviceName:ee.deviceName});break}case"deviceDisconnected":{m({id:`${Date.now()}-disconnected`,deviceId:t,sessionId:"",timestamp:new Date().toISOString(),type:"disconnected"});break}case"breakpointHit":{const ee=JSON.parse(re.payload);H.addHit(ee),F("breakpoint");break}}}),Z=Oe.onConnection(Q);return()=>{M(),Z(),Oe.disconnect(),q(),f.clearEvents(),S.clearEvents(),v.clearSessions(),P.clearRules(),H.clear(),N(),I(!1)}},[t]);const K=()=>{s("/")},O=x.useCallback(M=>{d(M),G(M,u)},[G,u]),W=x.useCallback(M=>{h(M),G(c,M)},[G,c]),A=x.useCallback(async()=>{await Y(),f.clearEvents(),S.clearEvents(),v.clearSessions(),b(!1)},[Y]),L=x.useCallback(M=>{t&&f.selectEvent(t,M)},[t]),X=x.useCallback(M=>{S.setFilter("traceId",M),F("logs")},[]),ae=x.useCallback((M,Z)=>{f.updateEventFavorite(M,Z)},[]);return t?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("header",{className:"px-6 py-5 bg-bg-dark border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("button",{onClick:K,className:"flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors group px-3 py-2 rounded hover:bg-bg-light",children:[e.jsx("span",{className:"group-hover:-translate-x-1 transition-transform text-lg",children:"â†"}),e.jsx("span",{className:"font-medium",children:"è¿”å›ž"})]}),e.jsx("div",{className:"h-8 w-px bg-border"}),e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center border border-border",children:e.jsx("span",{className:"text-2xl",children:"ðŸ“±"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-text-primary flex items-center gap-2",children:[(E==null?void 0:E.deviceInfo.deviceName)||"åŠ è½½ä¸­...",t&&e.jsx("button",{onClick:()=>_(t),className:y("p-1 rounded transition-colors",z(t)?"text-yellow-400 hover:text-yellow-300":"text-text-muted hover:text-yellow-400"),title:z(t)?"å–æ¶ˆæ”¶è—":"æ”¶è—è®¾å¤‡",children:z(t)?"â­":"â˜†"})]}),E&&e.jsxs("p",{className:"text-sm text-text-muted mt-0.5",children:[E.deviceInfo.platform," ",E.deviceInfo.systemVersion," â€¢ ",e.jsx("span",{className:"text-text-secondary",children:E.deviceInfo.appName})]})]}),E&&e.jsxs("span",{className:y("badge ml-3 px-3 py-1",E.isOnline?"badge-success":"badge-danger"),children:[e.jsx("span",{className:y("w-2 h-2 rounded-full mr-2",E.isOnline?"bg-green-400":"bg-red-400")}),E.isOnline?"åœ¨çº¿":"ç¦»çº¿"]}),t&&e.jsx(gi,{deviceId:t,isExpanded:w,onToggleExpand:()=>g(!w)})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-5 px-5 py-2.5 bg-bg-medium rounded-lg border border-border",children:[e.jsxs("label",{className:"flex items-center gap-2.5 text-sm cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:M=>O(M.target.checked),className:"accent-primary w-4 h-4"}),e.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors font-medium",children:"ðŸŒ ç½‘ç»œ"})]}),e.jsx("div",{className:"w-px h-5 bg-border"}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:M=>W(M.target.checked),className:"accent-primary w-4 h-4"}),e.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors font-medium",children:"ðŸ“ æ—¥å¿—"})]})]}),e.jsx("button",{onClick:()=>C(!0),className:"btn btn-ghost px-3.5 py-2.5 rounded",title:"å¿«æ·é”® (Ctrl+/)",children:"âŒ¨ï¸"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>k(!D),className:"btn btn-ghost px-3.5 py-2.5 rounded",title:"æ›´å¤šæ“ä½œ",children:"â‹®"}),D&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>k(!1)}),e.jsx("div",{className:"absolute right-0 top-full mt-2 w-52 bg-bg-dark border border-border rounded-lg shadow-lg z-50 overflow-hidden",children:e.jsxs("button",{onClick:()=>{k(!1),b(!0)},className:"w-full px-4 py-3.5 text-left text-sm text-red-400 hover:bg-red-500/10 flex items-center gap-3 transition-colors font-medium",children:[e.jsx("span",{children:"ðŸ—‘ï¸"}),e.jsx("span",{children:"æ¸…ç©ºè®¾å¤‡æ•°æ®"})]})})]})]})]})]})}),e.jsx("div",{className:"px-6 py-4 bg-bg-dark border-b border-border",children:e.jsx("div",{className:"flex items-center gap-1 p-1 bg-bg-medium rounded-lg border border-border w-fit",children:Qe.map((M,Z)=>{const re=Qe[Z-1],ee=re&&re.group!==M.group;return e.jsxs("div",{className:"flex items-center",children:[ee&&e.jsx("div",{className:"w-px h-6 bg-border mx-1"}),e.jsxs("button",{onClick:()=>F(M.id),title:`${M.description} (âŒ˜${Z+1})`,className:y("flex items-center gap-2 px-5 py-2.5 rounded text-sm font-medium transition-colors relative",o===M.id?"bg-primary text-bg-darkest":"text-text-secondary hover:text-text-primary hover:bg-bg-light"),children:[e.jsx("span",{className:"text-base",children:M.icon}),e.jsx("span",{children:M.label}),M.id==="breakpoint"&&H.pendingHits.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-orange-500 text-white text-xs rounded-full flex items-center justify-center animate-pulse",children:H.pendingHits.length})]})]},M.id)})})}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="http"&&e.jsx(zi,{deviceId:t,httpStore:f,onSelectEvent:L,onShowRelatedLogs:X,onFavoriteChange:ae,onRefresh:()=>f.fetchEvents(t)}),o==="websocket"&&e.jsx(qi,{deviceId:t,wsStore:v}),o==="logs"&&e.jsx(Ui,{deviceId:t,logStore:S,onRefresh:()=>S.fetchEvents(t)}),o==="mock"&&e.jsx(Yi,{deviceId:t,mockStore:P}),o==="breakpoint"&&e.jsx(wi,{deviceId:t,pendingHits:H.pendingHits,onResumeBreakpoint:(M,Z)=>H.resumeBreakpoint(t,M,Z)}),o==="chaos"&&e.jsx(Ei,{deviceId:t}),o==="database"&&e.jsx(Bi,{deviceId:t})]}),e.jsx(ei,{isOpen:j,onClose:()=>C(!1)}),e.jsx(mt,{isOpen:p,onClose:()=>b(!1),onConfirm:A,title:"æ¸…ç©ºè®¾å¤‡æ•°æ®",message:`ç¡®å®šè¦æ¸…ç©º "${(E==null?void 0:E.deviceInfo.deviceName)||"è¯¥è®¾å¤‡"}" çš„æ‰€æœ‰æ•°æ®å—ï¼Ÿ

è¿™å°†åˆ é™¤ï¼š
â€¢ æ‰€æœ‰ HTTP è¯·æ±‚è®°å½•
â€¢ æ‰€æœ‰æ—¥å¿—äº‹ä»¶
â€¢ æ‰€æœ‰ WebSocket ä¼šè¯

æ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,confirmText:"ç¡®è®¤æ¸…ç©º",cancelText:"å–æ¶ˆ",type:"danger"})]}):null}function zi({deviceId:t,httpStore:s,onSelectEvent:r,onShowRelatedLogs:n,onFavoriteChange:a,onRefresh:i}){const[o,l]=x.useState(!1),c=()=>{const h=Array.from(s.selectedIds);h.length>0&&window.open(mr(t,h),"_blank")},d=x.useCallback(async()=>{await s.batchDelete(t),l(!1)},[t,s]),u=s.filteredItems.filter(h=>!("type"in h&&h.type==="session-divider")).length;return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-5 py-4 bg-bg-medium border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:i,className:"btn btn-secondary",title:"åˆ·æ–°åˆ—è¡¨ (Ctrl+R)",children:"åˆ·æ–°"}),e.jsx("div",{className:"h-7 w-px bg-border"}),e.jsx("button",{onClick:()=>s.toggleSelectMode(),className:y("btn",s.isSelectMode?"btn-primary":"btn-secondary"),title:s.isSelectMode?"é€€å‡ºé€‰æ‹©æ¨¡å¼":"è¿›å…¥é€‰æ‹©æ¨¡å¼",children:s.isSelectMode?"å–æ¶ˆé€‰æ‹©":"æ‰¹é‡é€‰æ‹©"}),s.isSelectMode&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>s.selectAll(),className:"btn btn-secondary",title:"å…¨é€‰/å–æ¶ˆå…¨é€‰",children:s.selectedIds.size===s.events.length?"å–æ¶ˆå…¨é€‰":"å…¨é€‰"}),e.jsxs("button",{onClick:()=>s.batchFavorite(t,!0),disabled:s.selectedIds.size===0,className:"btn bg-yellow-500/10 text-yellow-400 border border-yellow-500/20 hover:bg-yellow-500/20",title:"æ”¶è—é€‰ä¸­çš„è¯·æ±‚",children:["â­ æ”¶è— (",s.selectedIds.size,")"]}),e.jsxs("button",{onClick:c,disabled:s.selectedIds.size===0,className:"btn btn-secondary",title:"å¯¼å‡ºé€‰ä¸­çš„è¯·æ±‚ä¸º HAR",children:["å¯¼å‡º (",s.selectedIds.size,")"]}),e.jsxs("button",{onClick:()=>l(!0),disabled:s.selectedIds.size===0,className:"btn btn-danger",title:"åˆ é™¤é€‰ä¸­çš„è¯·æ±‚",children:["åˆ é™¤ (",s.selectedIds.size,")"]})]}),e.jsx("div",{className:"h-7 w-px bg-border"}),e.jsxs("select",{value:s.filters.method,onChange:h=>s.setFilter("method",h.target.value),className:"select",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰æ–¹æ³•"}),e.jsx("option",{value:"GET",children:"GET"}),e.jsx("option",{value:"POST",children:"POST"}),e.jsx("option",{value:"PUT",children:"PUT"}),e.jsx("option",{value:"DELETE",children:"DELETE"}),e.jsx("option",{value:"PATCH",children:"PATCH"})]}),e.jsx("input",{type:"text",value:s.filters.urlContains,onChange:h=>s.setFilter("urlContains",h.target.value),placeholder:"ðŸ” æœç´¢ URL...",className:"input w-60","data-search-input":!0}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors px-2",children:[e.jsx("input",{type:"checkbox",checked:s.filters.mockedOnly,onChange:h=>s.setFilter("mockedOnly",h.target.checked),className:"accent-primary w-4 h-4"}),"ä»… Mock"]}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors px-2",children:[e.jsx("input",{type:"checkbox",checked:s.filters.favoritesOnly,onChange:h=>s.setFilter("favoritesOnly",h.target.checked),className:"accent-primary w-4 h-4"}),"ä»…æ”¶è—"]}),e.jsx("div",{className:"h-6 w-px bg-border/50"}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors px-2",title:"æ˜¾ç¤ºè¢«é»‘åå•ç­–ç•¥éšè—çš„åŸŸå",children:[e.jsx("input",{type:"checkbox",checked:s.filters.showBlacklisted,onChange:h=>s.setFilter("showBlacklisted",h.target.checked),className:"accent-primary w-4 h-4"}),"æ˜¾ç¤ºé»‘åå•"]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("button",{onClick:()=>s.setFilter("statusRange",s.filters.statusRange==="400-599"?"":"400-599"),className:y("px-3 py-1.5 rounded-lg text-xs font-semibold border transition-all shadow-sm",s.filters.statusRange==="400-599"?"bg-red-500/20 text-red-400 border-red-500/10 shadow-red-500/10":"bg-bg-light text-text-secondary border-border-subtle hover:bg-bg-lighter hover:border-border-light"),children:"âš ï¸ Errors"})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light/70 px-3 py-1.5 rounded-lg border border-border-subtle font-medium",children:[u!==s.events.length?`${u} / ${s.events.length}`:`${s.events.length}`," ","æ¡è®°å½•"]}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.autoScroll,onChange:h=>s.setAutoScroll(h.target.checked),className:"accent-primary w-4 h-4"}),"è‡ªåŠ¨æ»šåŠ¨"]}),e.jsx("div",{className:"h-6 w-px bg-border/50"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-text-muted mr-1",children:"åˆ†ç»„:"}),["none","domain","path"].map(h=>e.jsx("button",{onClick:()=>s.setGroupMode(h),className:y("px-2 py-1 text-xs rounded transition-colors",s.groupMode===h?"bg-primary text-white":"bg-bg-light text-text-muted hover:text-text-secondary"),children:h==="none"?"æ— ":h==="domain"?"åŸŸå":"è·¯å¾„"},h))]}),e.jsx("div",{className:"h-6 w-px bg-border/50"}),e.jsx("a",{href:ur(t),target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary",children:"å¯¼å‡ºå…¨éƒ¨"}),e.jsx("button",{onClick:()=>s.clearEvents(),className:"btn btn-ghost text-text-muted hover:text-text-secondary",title:"æ¸…ç©ºå½“å‰åˆ—è¡¨ï¼ˆä¸åˆ é™¤æ•°æ®åº“ï¼‰",children:"æ¸…å±"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 min-w-[400px] border-r border-border flex flex-col",children:s.groupMode==="none"?e.jsx(ka,{items:s.filteredItems,selectedId:s.selectedEventId,onSelect:r,autoScroll:s.autoScroll,isSelectMode:s.isSelectMode,selectedIds:s.selectedIds,onToggleSelect:s.toggleSelectId}):e.jsx(Ra,{events:s.filteredItems.filter(h=>!("type"in h&&h.type==="session-divider")),groupMode:s.groupMode,selectedId:s.selectedEventId,onSelect:r,isSelectMode:s.isSelectMode,selectedIds:s.selectedIds,onToggleSelect:s.toggleSelectId})}),e.jsx("div",{className:"w-[45%] min-w-[400px] bg-bg-dark/50",children:e.jsx(Ya,{event:s.selectedEvent,deviceId:t,onShowRelatedLogs:n,onFavoriteChange:a})})]}),e.jsx(mt,{isOpen:o,onClose:()=>l(!1),onConfirm:d,title:"åˆ é™¤ HTTP è¯·æ±‚",message:`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${s.selectedIds.size} ä¸ª HTTP è¯·æ±‚å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,confirmText:"ç¡®è®¤åˆ é™¤",cancelText:"å–æ¶ˆ",type:"danger"})]})}function Ui({deviceId:t,logStore:s,onRefresh:r}){const n=s.filteredEvents.length,a=s.events.length;return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 bg-bg-medium/50 border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"btn btn-secondary",title:"åˆ·æ–°åˆ—è¡¨ (Ctrl+R)",children:"åˆ·æ–°"}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx(Xa,{minLevel:s.filters.minLevel,subsystems:s.subsystems,categories:s.categories,selectedSubsystem:s.filters.subsystem,selectedCategory:s.filters.category,searchText:s.filters.text,searchQuery:s.filters.searchQuery,onMinLevelChange:s.setMinLevel,onSubsystemChange:i=>s.setFilter("subsystem",i),onCategoryChange:i=>s.setFilter("category",i),onSearchChange:i=>s.setFilter("text",i),onSearchQueryChange:s.setSearchQuery})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light px-2 py-1 rounded-lg",children:[n!==a?`${n} / ${a}`:`${a}`," æ¡è®°å½•"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.autoScroll,onChange:i=>s.setAutoScroll(i.target.checked),className:"accent-primary"}),"è‡ªåŠ¨æ»šåŠ¨"]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("a",{href:dr(t),target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary",children:"å¯¼å‡º"}),e.jsx("button",{onClick:()=>s.clearEvents(),className:"btn btn-ghost text-text-muted hover:text-text-secondary",title:"æ¸…ç©ºå½“å‰åˆ—è¡¨ï¼ˆä¸åˆ é™¤æ•°æ®åº“ï¼‰",children:"æ¸…å±"})]})]}),e.jsx(Qa,{events:s.filteredEvents,autoScroll:s.autoScroll})]})}function qi({deviceId:t,wsStore:s}){const r=x.useRef(null),[n,a]=x.useState(!1),i=x.useCallback(async()=>{await s.batchDelete(t),a(!1)},[t,s]),o=x.useCallback(h=>{s.selectSession(t,h)},[t]),l=x.useCallback(()=>{s.selectedSessionId&&s.loadMoreFrames(t,s.selectedSessionId)},[t,s.selectedSessionId]),c=x.useCallback(h=>{s.setFrameDirection(h),s.selectedSessionId&&s.fetchFrames(t,s.selectedSessionId)},[t,s.selectedSessionId]),d=x.useCallback(h=>{s.setFilter("urlContains",h),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{s.fetchSessions(t)},300)},[t]),u=x.useCallback(h=>{s.setFilter("isOpen",h===""?void 0:h==="true"),s.fetchSessions(t)},[t]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 bg-bg-medium/50 border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>s.fetchSessions(t),className:"btn btn-secondary",title:"åˆ·æ–°åˆ—è¡¨",children:"åˆ·æ–°"}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("button",{onClick:()=>s.toggleSelectMode(),className:y("btn",s.isSelectMode?"btn-primary":"btn-secondary"),title:s.isSelectMode?"é€€å‡ºé€‰æ‹©æ¨¡å¼":"è¿›å…¥é€‰æ‹©æ¨¡å¼",children:s.isSelectMode?"å–æ¶ˆé€‰æ‹©":"æ‰¹é‡é€‰æ‹©"}),s.isSelectMode&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>s.selectAll(),className:"btn btn-secondary",title:"å…¨é€‰/å–æ¶ˆå…¨é€‰",children:s.selectedIds.size===s.sessions.length?"å–æ¶ˆå…¨é€‰":"å…¨é€‰"}),e.jsxs("button",{onClick:()=>a(!0),disabled:s.selectedIds.size===0,className:"btn btn-danger",title:"åˆ é™¤é€‰ä¸­çš„ä¼šè¯",children:["åˆ é™¤ (",s.selectedIds.size,")"]})]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("input",{type:"text",value:s.filters.urlContains||"",onChange:h=>d(h.target.value),placeholder:"æœç´¢ URL...",className:"input w-56"}),e.jsxs("select",{value:s.filters.isOpen===void 0?"":String(s.filters.isOpen),onChange:h=>u(h.target.value),className:"select",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰çŠ¶æ€"}),e.jsx("option",{value:"true",children:"è¿žæŽ¥ä¸­"}),e.jsx("option",{value:"false",children:"å·²å…³é—­"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light px-2 py-1 rounded-lg",children:[s.totalSessions," ä¸ªä¼šè¯"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.autoScroll,onChange:h=>s.setAutoScroll(h.target.checked),className:"accent-primary"}),"è‡ªåŠ¨æ»šåŠ¨"]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("button",{onClick:()=>s.clearSessions(),className:"btn btn-ghost text-text-muted hover:text-text-secondary",title:"æ¸…ç©ºå½“å‰åˆ—è¡¨ï¼ˆä¸åˆ é™¤æ•°æ®åº“ï¼‰",children:"æ¸…å±"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"w-[40%] min-w-[300px] border-r border-border",children:e.jsx(ti,{sessions:s.sessions,selectedId:s.selectedSessionId,onSelect:o,loading:s.sessionsLoading,autoScroll:s.autoScroll,isSelectMode:s.isSelectMode,selectedIds:s.selectedIds,onToggleSelect:s.toggleSelectId})}),e.jsx("div",{className:"flex-1 min-w-[400px] bg-bg-dark/50",children:e.jsx(ni,{deviceId:t,session:s.selectedSession,frames:s.frames,loading:s.framesLoading,onLoadMore:l,hasMore:s.frames.length<s.totalFrames,frameDirection:s.frameDirection,onFrameDirectionChange:c})})]}),e.jsx(mt,{isOpen:n,onClose:()=>a(!1),onConfirm:i,title:"åˆ é™¤ WebSocket ä¼šè¯",message:`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${s.selectedIds.size} ä¸ª WebSocket ä¼šè¯å—ï¼Ÿ

æ­¤æ“ä½œå°†åŒæ—¶åˆ é™¤è¿™äº›ä¼šè¯çš„æ‰€æœ‰å¸§æ•°æ®ï¼Œä¸å¯æ¢å¤ã€‚`,confirmText:"ç¡®è®¤åˆ é™¤",cancelText:"å–æ¶ˆ",type:"danger"})]})}function Yi({deviceId:t,mockStore:s}){const r=x.useCallback(()=>{s.openEditor()},[]),n=x.useCallback(l=>{s.openEditor(l)},[]),a=x.useCallback(l=>{s.deleteRule(t,l)},[t]),i=x.useCallback(l=>{s.toggleRuleEnabled(t,l)},[t]),o=x.useCallback(async l=>{s.editingRule?await s.updateRule(t,s.editingRule.id,l):await s.createRule(t,l)},[t,s.editingRule]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 bg-bg-medium/50 border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>s.fetchRules(t),className:"btn btn-secondary",children:"åˆ·æ–°"}),e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light px-2 py-1 rounded-lg",children:[s.rules.length," æ¡è§„åˆ™"]})]}),e.jsx("button",{onClick:r,className:"btn bg-primary text-white hover:bg-primary-dark",children:"+ åˆ›å»ºè§„åˆ™"})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(ui,{rules:s.rules,loading:s.loading,onEdit:n,onDelete:a,onToggleEnabled:i,onCreateNew:r})}),e.jsx(fi,{rule:s.editingRule,isOpen:s.isEditorOpen,onClose:s.closeEditor,onSave:o,loading:s.loading})]})}const Vi={iOS:"ðŸŽ",iPadOS:"ðŸ“±",macOS:"ðŸ’»",watchOS:"âŒš",tvOS:"ðŸ“º"};function Gi({device:t,style:s}){const r=tt(),{favoriteDeviceIds:n,toggleFavorite:a}=He(),i=n.has(t.deviceId),o=l=>{l.stopPropagation(),a(t.deviceId)};return e.jsxs("div",{onClick:()=>r(`/device/${t.deviceId}`),className:y("glass-card p-5 cursor-pointer transition-all group animate-fadeIn card-interactive",t.isOnline?"hover:border-primary":"opacity-75"),style:s,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:y("w-12 h-12 rounded-xl flex items-center justify-center text-2xl","bg-gradient-to-br",t.isOnline?"from-primary/20 to-accent-blue/20 border border-primary/20":"from-bg-light to-bg-medium border border-border"),children:Vi[t.platform]||"ðŸ“±"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-text-primary group-hover:text-primary transition-colors line-clamp-1",children:t.deviceName}),e.jsxs("p",{className:"text-xs text-text-muted line-clamp-1",children:[t.platform," ",t.systemVersion]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:o,className:y("p-1.5 rounded transition-all",i?"text-yellow-400 hover:text-yellow-300":"text-text-muted opacity-0 group-hover:opacity-100 hover:text-yellow-400"),title:i?"å–æ¶ˆæ”¶è—":"æ”¶è—è®¾å¤‡",children:i?"â­":"â˜†"}),e.jsxs("span",{className:y("badge",t.isOnline?"badge-success":"badge-danger"),children:[e.jsx("span",{className:y("w-1.5 h-1.5 rounded-full mr-1.5",t.isOnline?"bg-green-400 status-dot-online":"bg-red-400")}),t.isOnline?"åœ¨çº¿":"ç¦»çº¿"]})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-bg-medium/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:"ðŸ“¦"}),e.jsx("span",{className:"text-sm font-medium text-text-primary line-clamp-1",children:t.appName})]}),e.jsxs("p",{className:"text-xs text-text-muted pl-6",children:["ç‰ˆæœ¬ ",t.appVersion," (",t.buildNumber,")"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-text-muted",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"â±ï¸"}),e.jsxs("span",{children:["æœ€åŽæ´»åŠ¨: ",fs(t.lastSeenAt)]})]}),e.jsx("span",{className:"text-primary opacity-0 group-hover:opacity-100 transition-opacity",children:"æŸ¥çœ‹è¯¦æƒ… â†’"})]})]})}function Ji(){const{devices:t,isLoading:s,fetchDevices:r}=He(),n=t.filter(a=>a.isOnline).length;return x.useEffect(()=>{r();const a=setInterval(r,5e3);return()=>clearInterval(a)},[r]),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("header",{className:"px-6 py-5 bg-bg-dark border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"è®¾å¤‡åˆ—è¡¨"}),e.jsxs("p",{className:"text-sm text-text-muted mt-1",children:["ç®¡ç†å·²è¿žæŽ¥çš„è°ƒè¯•è®¾å¤‡ Â· ",n," åœ¨çº¿ / ",t.length," æ€»è®¡"]})]}),e.jsxs("button",{onClick:r,disabled:s,className:"btn btn-primary disabled:opacity-50",children:[e.jsx("span",{className:s?"animate-spin":"",children:"ðŸ”„"}),e.jsx("span",{children:"åˆ·æ–°"})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:t.map((a,i)=>e.jsx(Gi,{device:a,style:{animationDelay:`${i*50}ms`}},a.deviceId))}):e.jsx(Qi,{isLoading:s})})]})}function Qi({isLoading:t}){return e.jsx("div",{className:"flex flex-col items-center justify-center h-full",children:e.jsx("div",{className:"glass-card p-12 text-center max-w-md",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-bg-light animate-pulse"}),e.jsx("div",{className:"h-6 bg-bg-light rounded w-48 mx-auto mb-3 animate-pulse"}),e.jsx("div",{className:"h-4 bg-bg-light rounded w-64 mx-auto animate-pulse"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-bg-light flex items-center justify-center",children:e.jsx("span",{className:"text-4xl opacity-50",children:"ðŸ“±"})}),e.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-2",children:"æš‚æ— åœ¨çº¿è®¾å¤‡"}),e.jsx("p",{className:"text-sm text-text-muted mb-6",children:"è¯·ç¡®ä¿ iOS App å·²é›†æˆ DebugProbe å¹¶è¿žæŽ¥åˆ° Debug Hub"}),e.jsxs("div",{className:"text-left bg-bg-medium rounded-xl p-4 text-xs font-mono text-text-secondary overflow-x-auto",children:[e.jsx("p",{className:"text-text-muted mb-2",children:"// åœ¨ AppDelegate ä¸­åˆå§‹åŒ–"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-purple-400",children:"let"})," config = ",e.jsx("span",{className:"text-primary",children:"DebugProbe.Configuration"}),"("]}),e.jsxs("p",{className:"pl-4",children:["hubURL: ",e.jsxs("span",{className:"text-green-400",children:['"ws://',"<","host",">",':8081/debug-bridge"']})]}),e.jsx("p",{children:")"}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"text-primary",children:"DebugProbe"}),".shared.start(configuration: config)"]})]})]})})})}const Ki=[{icon:"ðŸ“±",title:"è®¾å¤‡ç®¡ç†",endpoints:[{method:"GET",path:"/api/devices",description:"èŽ·å–åœ¨çº¿è®¾å¤‡åˆ—è¡¨"},{method:"GET",path:"/api/devices/:deviceId",description:"èŽ·å–è®¾å¤‡è¯¦æƒ…"},{method:"POST",path:"/api/devices/:deviceId/control/toggle-capture",description:"åˆ‡æ¢æ•èŽ·çŠ¶æ€"},{method:"DELETE",path:"/api/devices/:deviceId/data",description:"æ¸…ç©ºè®¾å¤‡æ•°æ®"}]},{icon:"ðŸŒ",title:"HTTP äº‹ä»¶",endpoints:[{method:"GET",path:"/api/devices/:deviceId/http-events",description:"èŽ·å– HTTP äº‹ä»¶åˆ—è¡¨"},{method:"GET",path:"/api/devices/:deviceId/http-events/:eventId",description:"èŽ·å– HTTP äº‹ä»¶è¯¦æƒ…"},{method:"POST",path:"/api/devices/:deviceId/http-events/:eventId/replay",description:"é‡æ”¾ HTTP è¯·æ±‚"},{method:"PUT",path:"/api/devices/:deviceId/http-events/:eventId/favorite",description:"æ”¶è—/å–æ¶ˆæ”¶è—"}]},{icon:"ðŸ“",title:"æ—¥å¿—äº‹ä»¶",endpoints:[{method:"GET",path:"/api/devices/:deviceId/log-events",description:"èŽ·å–æ—¥å¿—äº‹ä»¶åˆ—è¡¨"}]},{icon:"ðŸ”Œ",title:"WebSocket ä¼šè¯",endpoints:[{method:"GET",path:"/api/devices/:deviceId/ws-sessions",description:"èŽ·å– WebSocket ä¼šè¯åˆ—è¡¨"},{method:"GET",path:"/api/devices/:deviceId/ws-sessions/:sessionId/frames",description:"èŽ·å– WebSocket å¸§æ•°æ®"}]},{icon:"ðŸŽ­",title:"Mock è§„åˆ™",endpoints:[{method:"GET",path:"/api/devices/:deviceId/mock-rules",description:"èŽ·å– Mock è§„åˆ™åˆ—è¡¨"},{method:"POST",path:"/api/devices/:deviceId/mock-rules",description:"åˆ›å»º Mock è§„åˆ™"},{method:"PUT",path:"/api/devices/:deviceId/mock-rules/:ruleId",description:"æ›´æ–° Mock è§„åˆ™"},{method:"DELETE",path:"/api/devices/:deviceId/mock-rules/:ruleId",description:"åˆ é™¤ Mock è§„åˆ™"}]},{icon:"â¸ï¸",title:"æ–­ç‚¹è°ƒè¯•",endpoints:[{method:"GET",path:"/api/devices/:deviceId/breakpoints",description:"èŽ·å–æ–­ç‚¹è§„åˆ™åˆ—è¡¨"},{method:"POST",path:"/api/devices/:deviceId/breakpoints",description:"åˆ›å»ºæ–­ç‚¹è§„åˆ™"}]},{icon:"ðŸ’¥",title:"æ•…éšœæ³¨å…¥",endpoints:[{method:"GET",path:"/api/devices/:deviceId/chaos-rules",description:"èŽ·å–æ•…éšœæ³¨å…¥è§„åˆ™"},{method:"POST",path:"/api/devices/:deviceId/chaos-rules",description:"åˆ›å»ºæ•…éšœæ³¨å…¥è§„åˆ™"}]},{icon:"ðŸ“¤",title:"æ•°æ®å¯¼å‡º",endpoints:[{method:"GET",path:"/api/export/har/:deviceId",description:"å¯¼å‡º HAR æ–‡ä»¶"},{method:"GET",path:"/api/devices/:deviceId/http-events/:eventId/curl",description:"å¯¼å‡º cURL å‘½ä»¤"}]},{icon:"ðŸ”—",title:"WebSocket è¿žæŽ¥",endpoints:[{method:"WS",path:"/debug-bridge",description:"iOS è®¾å¤‡è¿žæŽ¥ç«¯ç‚¹"},{method:"WS",path:"/ws/live",description:"å®žæ—¶äº‹ä»¶æµè®¢é˜…"}]},{icon:"ðŸ§¹",title:"æ•°æ®ç®¡ç†",endpoints:[{method:"GET",path:"/api/cleanup/config",description:"èŽ·å–æ¸…ç†é…ç½®"},{method:"PUT",path:"/api/cleanup/config",description:"æ›´æ–°æ¸…ç†é…ç½®"},{method:"POST",path:"/api/cleanup/run",description:"æ‰§è¡Œè¿‡æœŸæ•°æ®æ¸…ç†"},{method:"POST",path:"/api/cleanup/truncate",description:"æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼ˆå±é™©ï¼‰"}]},{icon:"ðŸ’š",title:"ç³»ç»ŸçŠ¶æ€",endpoints:[{method:"GET",path:"/api/health",description:"å¥åº·æ£€æŸ¥"}]}],Xi={GET:"bg-green-500/20 text-green-400",POST:"bg-blue-500/20 text-blue-400",PUT:"bg-yellow-500/20 text-yellow-400",DELETE:"bg-red-500/20 text-red-400",WS:"bg-purple-500/20 text-purple-400"};function Zi(){return e.jsx("div",{className:"h-full overflow-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-12",children:[e.jsxs("header",{className:"text-center mb-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”"}),e.jsx("h1",{className:"text-4xl font-bold mb-2 text-text-primary",children:"Debug Hub API"}),e.jsx("p",{className:"text-text-secondary text-lg mb-4",children:"ç½‘ç»œå’Œæ—¥å¿—ä¸€ä½“åŒ–è°ƒè¯•å¹³å°"}),e.jsx("span",{className:"inline-block px-4 py-1 bg-bg-light rounded text-sm text-primary border border-border",children:"v1.0.0"}),e.jsxs("nav",{className:"flex justify-center gap-4 mt-6",children:[e.jsx(de,{to:"/",className:"text-text-secondary hover:text-primary transition-colors px-4 py-2 rounded hover:bg-bg-light",children:"ðŸ“± è®¾å¤‡åˆ—è¡¨"}),e.jsx(de,{to:"/health",className:"text-text-secondary hover:text-primary transition-colors px-4 py-2 rounded hover:bg-bg-light",children:"ðŸ’š å¥åº·æ£€æŸ¥"})]})]}),e.jsx("div",{className:"space-y-6",children:Ki.map(t=>e.jsxs("section",{className:"bg-bg-dark border border-border rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-bg-medium border-b border-border flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsx("h2",{className:"text-lg font-semibold",children:t.title})]}),e.jsx("div",{className:"p-2",children:t.endpoints.map(s=>e.jsxs("div",{className:"flex items-center gap-4 px-4 py-3 rounded-lg hover:bg-bg-medium transition-colors",children:[e.jsx("span",{className:`font-mono text-xs font-bold px-2 py-1 rounded min-w-[60px] text-center ${Xi[s.method]}`,children:s.method}),e.jsx("code",{className:"font-mono text-sm text-text-primary flex-1",children:s.path}),e.jsx("span",{className:"text-text-secondary text-sm",children:s.description})]},`${s.method}-${s.path}`))})]},t.title))}),e.jsxs("section",{className:"mt-8 bg-bg-dark border border-border rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-bg-medium border-b border-border flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ðŸš€"}),e.jsx("h2",{className:"text-lg font-semibold",children:"å¿«é€Ÿå¼€å§‹"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-sm mb-2",children:"èŽ·å–è®¾å¤‡åˆ—è¡¨ï¼š"}),e.jsx("pre",{className:"bg-bg-darkest border border-border rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsxs("code",{children:[e.jsx("span",{className:"text-info",children:"curl"})," ",e.jsx("span",{className:"text-green-400",children:"http://localhost:8081/api/devices"})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-sm mb-2",children:"è¿žæŽ¥å®žæ—¶äº‹ä»¶æµï¼š"}),e.jsx("pre",{className:"bg-bg-darkest border border-border rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsxs("code",{children:[e.jsx("span",{className:"text-info",children:"websocat"})," ",e.jsx("span",{className:"text-green-400",children:"ws://localhost:8081/ws/live"})]})})]})]})]}),e.jsx("footer",{className:"text-center mt-12 py-8 text-text-secondary text-sm",children:e.jsx("p",{children:"Debug Hub Â© 2025 Sun. All rights reserved."})})]})})}function eo({isOpen:t,onClose:s,onConfirm:r,title:n,message:a,confirmWord:i="DELETE",confirmText:o="ç¡®è®¤åˆ é™¤",cancelText:l="å–æ¶ˆ",loading:c=!1}){const[d,u]=x.useState(""),h=d===i;if(x.useEffect(()=>{t||u("")},[t]),!t)return null;const j=()=>{h&&!c&&r()},C=p=>{p.key==="Enter"&&h&&j(),p.key==="Escape"&&s()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-lg shadow-lg w-[440px] overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border bg-red-500/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-red-500/15",children:e.jsx("span",{className:"text-xl",children:"âš ï¸"})}),e.jsx("h3",{className:"text-lg font-bold text-red-400",children:n})]})}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("p",{className:"text-text-secondary whitespace-pre-line mb-4",children:a}),e.jsxs("div",{className:"bg-bg-medium rounded-lg p-4 border border-border",children:[e.jsxs("p",{className:"text-sm text-text-muted mb-2",children:["è¯·è¾“å…¥ ",e.jsx("code",{className:"px-1.5 py-0.5 bg-red-500/10 text-red-400 rounded font-mono font-bold",children:i})," ä»¥ç¡®è®¤æ“ä½œï¼š"]}),e.jsx("input",{type:"text",value:d,onChange:p=>u(p.target.value),onKeyDown:C,placeholder:i,autoFocus:!0,className:y("w-full px-3 py-2 bg-bg-dark border rounded text-text-primary font-mono focus:outline-none transition-colors",d===i?"border-green-500 focus:border-green-400":d.length>0?"border-red-500/50 focus:border-red-400":"border-border focus:border-primary")}),d.length>0&&d!==i&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:"è¾“å…¥ä¸åŒ¹é…"})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-border bg-bg-medium/30 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,disabled:c,className:"px-4 py-2 rounded-lg text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-bg-light transition-all disabled:opacity-50",children:l}),e.jsx("button",{onClick:j,disabled:!h||c,className:y("px-4 py-2 rounded-lg text-sm font-medium text-white transition-all",h?"bg-red-500 hover:bg-red-600":"bg-red-500/30 cursor-not-allowed",c&&"opacity-50"),children:c?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"å¤„ç†ä¸­..."]}):o})]})]})})}function to(t){const s=Math.floor(t/86400),r=Math.floor(t%86400/3600),n=Math.floor(t%3600/60),a=t%60,i=o=>o.toString().padStart(2,"0");return s>0?`${s}å¤© ${i(r)}:${i(n)}:${i(a)}`:`${i(r)}:${i(n)}:${i(a)}`}function so(t){try{return new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return t}}function ro(){var b;const[t,s]=x.useState(null),[r,n]=x.useState(null),[a,i]=x.useState(new Date),[o,l]=x.useState("--:--:--"),[c,d]=x.useState(!1),[u,h]=x.useState(!1),j=x.useRef(null);x.useEffect(()=>{async function D(){try{const w=await fetch("/api/health",{headers:{Accept:"application/json"}});if(!w.ok)throw new Error("Failed to fetch health status");const g=await w.json();if(s(g),n(null),g.startTime){const F=new Date(g.startTime);j.current=F.getTime()}}catch(w){n(w instanceof Error?w.message:"Unknown error")}}D();const k=setInterval(D,3e4);return()=>clearInterval(k)},[]),x.useEffect(()=>{const D=()=>{if(i(new Date),j.current){const w=Math.floor((Date.now()-j.current)/1e3);l(to(Math.max(0,w)))}};D();const k=setInterval(D,1e3);return()=>clearInterval(k)},[]);const C=!r&&(t==null?void 0:t.status)==="healthy",p=async()=>{h(!0);try{await er(),d(!1),alert("æ‰€æœ‰æ•°æ®å·²æ¸…ç©º")}catch(D){alert("æ¸…ç©ºæ•°æ®å¤±è´¥: "+(D instanceof Error?D.message:"æœªçŸ¥é”™è¯¯"))}finally{h(!1)}};return e.jsxs("div",{className:"h-full overflow-auto flex items-center justify-center p-6",children:[e.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent-blue/5 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"max-w-lg w-full relative",children:[e.jsxs("div",{className:"glass-card p-10 text-center",children:[e.jsxs("div",{className:`w-28 h-28 mx-auto mb-8 rounded-full flex items-center justify-center text-5xl relative ${r?"bg-red-500/10":"bg-green-500/10"}`,children:[e.jsx("div",{className:`absolute inset-0 rounded-full animate-ping opacity-25 ${r?"bg-red-500":"bg-green-500"}`,style:{animationDuration:"2s"}}),e.jsx("span",{className:"relative z-10",children:r?"âŒ":"ðŸ’š"})]}),e.jsx("h1",{className:`text-3xl font-bold mb-3 ${r?"text-red-400":"text-green-400"}`,children:r?"æœåŠ¡å¼‚å¸¸":"æœåŠ¡æ­£å¸¸è¿è¡Œ"}),e.jsx("p",{className:"text-text-secondary mb-10",children:r||"Debug Hub æ‰€æœ‰ç³»ç»Ÿè¿è¡Œæ­£å¸¸"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-10",children:[e.jsx(Me,{label:"çŠ¶æ€",value:((b=t==null?void 0:t.status)==null?void 0:b.toUpperCase())||"--",icon:"ðŸŸ¢",highlight:C}),e.jsx(Me,{label:"ç‰ˆæœ¬",value:(t==null?void 0:t.version)||"--",icon:"ðŸ“¦"}),e.jsx(Me,{label:"è¿è¡Œæ—¶é—´",value:o,icon:"â±ï¸",mono:!0}),e.jsx(Me,{label:"å½“å‰æ—¶é—´",value:a.toLocaleTimeString("zh-CN"),icon:"ðŸ•",mono:!0})]}),(t==null?void 0:t.startTime)&&e.jsxs("div",{className:"text-xs text-text-muted mb-8 p-3 bg-bg-medium/50 rounded-xl",children:[e.jsx("span",{className:"opacity-70",children:"æœåŠ¡å¯åŠ¨äºŽ:"}),e.jsx("span",{className:"ml-2 font-mono text-text-secondary",children:so(t.startTime)})]}),e.jsxs("nav",{className:"flex justify-center gap-3 mb-6",children:[e.jsx(de,{to:"/",className:"btn btn-secondary",children:"ðŸ“± è®¾å¤‡åˆ—è¡¨"}),e.jsx(de,{to:"/api-docs",className:"btn btn-secondary",children:"ðŸ“š API æ–‡æ¡£"})]}),e.jsxs("div",{className:"pt-6 border-t border-border",children:[e.jsx("p",{className:"text-xs text-text-muted mb-3",children:"å±é™©æ“ä½œ"}),e.jsx("button",{onClick:()=>d(!0),className:"btn bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20",children:"ðŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®"})]})]}),e.jsx("p",{className:"text-center mt-8 text-text-muted text-sm",children:e.jsx("span",{className:"opacity-70",children:"Debug Hub Â© 2025 Sun"})})]}),e.jsx(eo,{isOpen:c,title:"æ¸…ç©ºæ‰€æœ‰æ•°æ®",message:"æ­¤æ“ä½œå°†åˆ é™¤æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬æ‰€æœ‰è®¾å¤‡çš„ HTTP äº‹ä»¶ã€æ—¥å¿—ã€WebSocket ä¼šè¯ç­‰ã€‚æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼",confirmWord:"DELETE",confirmText:"ç¡®è®¤æ¸…ç©º",loading:u,onConfirm:p,onClose:()=>d(!1)})]})}function Me({label:t,value:s,icon:r,mono:n=!1,highlight:a=!1}){return e.jsxs("div",{className:`bg-bg-medium/50 rounded-xl p-4 border border-border transition-all ${a?"border-green-500/30":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-sm",children:r}),e.jsx("span",{className:"text-xs text-text-muted uppercase tracking-wider",children:t})]}),e.jsx("div",{className:`text-xl font-semibold text-primary ${n?"font-mono":""}`,children:s})]})}function no(){const{rules:t,fetchRules:s,createOrUpdateRule:r,deleteRule:n,isLoading:a}=st(),[i,o]=x.useState(null),[l,c]=x.useState(!1);x.useEffect(()=>{s()},[]);const d=()=>{o({name:"",matchType:"domain",matchValue:"",action:"highlight",isEnabled:!0,priority:0}),c(!0)},u=p=>{o({...p}),c(!0)},h=async()=>{if(i)try{await r(i),c(!1),o(null)}catch(p){console.error("Failed to save rule",p)}},j=async p=>{confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡è§„åˆ™å—ï¼Ÿ")&&await n(p)},C=async p=>{await r({...p,isEnabled:!p.isEnabled})};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("header",{className:"px-6 py-4 bg-bg-dark border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(de,{to:"/",className:"flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors group",children:[e.jsx("span",{className:"group-hover:-translate-x-1 transition-transform",children:"â†"}),e.jsx("span",{children:"è¿”å›ž"})]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center border border-border",children:e.jsx("span",{className:"text-lg",children:"âš™ï¸"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Traffic Rules"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç®¡ç†åŸŸåé«˜äº®ã€éšè—ç­‰è¿‡æ»¤è§„åˆ™"})]})]}),e.jsx("button",{onClick:d,className:"btn btn-primary",children:"+ æ–°å»ºè§„åˆ™"})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:a?e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"åŠ è½½ä¸­..."}):t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ“‹"}),e.jsx("h2",{className:"text-lg font-medium text-text-primary mb-2",children:"æš‚æ— è§„åˆ™"}),e.jsx("p",{className:"text-sm mb-4",children:'ç‚¹å‡»"æ–°å»ºè§„åˆ™"æ·»åŠ æµé‡è¿‡æ»¤è§„åˆ™'}),e.jsx("button",{onClick:d,className:"btn btn-primary",children:"+ æ–°å»ºè§„åˆ™"})]}):e.jsx("div",{className:"space-y-3",children:t.map(p=>e.jsx("div",{className:y("p-4 bg-bg-dark border border-border rounded-xl transition-all",!p.isEnabled&&"opacity-50"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>C(p),className:y("w-10 h-6 rounded-full transition-colors relative",p.isEnabled?"bg-primary":"bg-bg-light"),children:e.jsx("span",{className:y("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",p.isEnabled?"left-5":"left-1")})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:p.name||p.matchValue}),e.jsxs("div",{className:"text-xs text-text-muted",children:[p.matchType==="domain"&&"åŸŸååŒ¹é…",p.matchType==="urlRegex"&&"æ­£åˆ™åŒ¹é…",p.matchType==="header"&&"è¯·æ±‚å¤´åŒ¹é…",": ",e.jsx("code",{className:"text-text-secondary",children:p.matchValue})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:y("badge",p.action==="highlight"&&"badge-warning",p.action==="hide"&&"badge-danger",p.action==="mark"&&"badge-info"),children:[p.action==="highlight"&&"â­ é«˜äº®",p.action==="hide"&&"ðŸš« éšè—",p.action==="mark"&&"ðŸ·ï¸ æ ‡è®°"]}),e.jsx("button",{onClick:()=>u(p),className:"btn btn-ghost px-3",title:"ç¼–è¾‘",children:"âœï¸"}),e.jsx("button",{onClick:()=>p.id&&j(p.id),className:"btn btn-ghost px-3 text-red-400 hover:bg-red-500/10",title:"åˆ é™¤",children:"ðŸ—‘ï¸"})]})]})},p.id))})}),l&&i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>c(!1)}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl shadow-2xl w-full max-w-md",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:i.id?"ç¼–è¾‘è§„åˆ™":"æ–°å»ºè§„åˆ™"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"è§„åˆ™åç§°"}),e.jsx("input",{type:"text",value:i.name||"",onChange:p=>o({...i,name:p.target.value}),placeholder:"ä¾‹å¦‚ï¼šéšè—å¹¿å‘ŠåŸŸå",className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"åŒ¹é…ç±»åž‹"}),e.jsxs("select",{value:i.matchType||"domain",onChange:p=>o({...i,matchType:p.target.value}),className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"domain",children:"åŸŸå"}),e.jsx("option",{value:"urlRegex",children:"URL æ­£åˆ™"}),e.jsx("option",{value:"header",children:"è¯·æ±‚å¤´"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"åŒ¹é…å€¼"}),e.jsx("input",{type:"text",value:i.matchValue||"",onChange:p=>o({...i,matchValue:p.target.value}),placeholder:i.matchType==="domain"?"example.com":".*\\.example\\.com",className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"åŠ¨ä½œ"}),e.jsxs("select",{value:i.action||"highlight",onChange:p=>o({...i,action:p.target.value}),className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"highlight",children:"â­ é«˜äº®æ˜¾ç¤º"}),e.jsx("option",{value:"hide",children:"ðŸš« éšè—"}),e.jsx("option",{value:"mark",children:"ðŸ·ï¸ æ ‡è®°"})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-border flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>c(!1),className:"btn btn-ghost",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:h,className:"btn btn-primary",disabled:!i.matchValue,children:"ä¿å­˜"})]})]})})]})]})}function ao(){const{theme:t,setTheme:s}=We(),r=()=>{s(t==="dark"?"light":t==="light"?"system":"dark")};return e.jsxs("button",{onClick:r,className:"p-2 rounded-lg hover:bg-bg-light transition-colors text-text-muted hover:text-text-primary",title:`å½“å‰ä¸»é¢˜: ${t==="dark"?"æ·±è‰²":t==="light"?"æµ…è‰²":"è·Ÿéšç³»ç»Ÿ"}`,children:[t==="dark"&&e.jsx(io,{className:"w-5 h-5"}),t==="light"&&e.jsx(oo,{className:"w-5 h-5"}),t==="system"&&e.jsx(lo,{className:"w-5 h-5"})]})}function io({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}function oo({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}function lo({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}const co=["/api-docs","/health"];function uo(){const t=Ut(),s=!co.includes(t.pathname);return e.jsxs("div",{className:"flex h-screen bg-bg-darkest text-text-primary",children:[s&&e.jsx(Dr,{}),e.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[s&&e.jsxs("header",{className:"h-12 bg-bg-dark border-b border-border flex items-center justify-between px-5 shrink-0",children:[e.jsx("div",{className:"flex items-center gap-4 text-xs font-medium text-text-secondary"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs(de,{to:"/api-docs",className:"text-xs text-text-muted hover:text-primary transition-colors flex items-center gap-1.5 px-2 py-1 rounded hover:bg-bg-light",title:"API Documentation",children:[e.jsx("span",{children:"ðŸ“„"}),e.jsx("span",{children:"Docs"})]}),e.jsxs(de,{to:"/health",className:"text-xs text-text-muted hover:text-green-400 transition-colors flex items-center gap-1.5 px-2 py-1 rounded hover:bg-bg-light",title:"System Health",children:[e.jsx("span",{children:"ðŸ’š"}),e.jsx("span",{children:"Health"})]}),e.jsx("div",{className:"h-5 w-px bg-border"}),e.jsx(ao,{})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden relative",children:e.jsxs(Is,{children:[e.jsx(je,{path:"/",element:e.jsx(Ji,{})}),e.jsx(je,{path:"/device/:deviceId",element:e.jsx(Wi,{})}),e.jsx(je,{path:"/rules",element:e.jsx(no,{})}),e.jsx(je,{path:"/api-docs",element:e.jsx(Zi,{})}),e.jsx(je,{path:"/health",element:e.jsx(ro,{})})]})})]})]})}function mo(){const{theme:t,setTheme:s}=We();return x.useEffect(()=>{s(t)},[]),x.useEffect(()=>(Hs(),()=>Ws()),[]),e.jsx(Rs,{children:e.jsx(uo,{})})}Ke.createRoot(document.getElementById("root")).render(e.jsx(Ps.StrictMode,{children:e.jsx(mo,{})}));
