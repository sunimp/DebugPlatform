var Is=Object.defineProperty;var Ps=(t,s,r)=>s in t?Is(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var me=(t,s,r)=>Ps(t,typeof s!="symbol"?s+"":s,r);import{r as m,a as Gt,u as rt,b as Jt,L as de,c as Ms,d as Fs,B as Ls,e as _s,f as Ne,R as As}from"./vendor-C1y34kgY.js";import{c as ne}from"./zustand-DNIvzKHV.js";import{p as $s,a as Te}from"./protobuf-NWeOYLG2.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Qt={exports:{}},We={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bs=m,Hs=Symbol.for("react.element"),Ws=Symbol.for("react.fragment"),zs=Object.prototype.hasOwnProperty,Us=Bs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qs={key:!0,ref:!0,__self:!0,__source:!0};function Kt(t,s,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(n in s)zs.call(s,n)&&!qs.hasOwnProperty(n)&&(a[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:Hs,type:t,key:i,ref:o,props:a,_owner:Us.current}}We.Fragment=Ws;We.jsx=Kt;We.jsxs=Kt;Qt.exports=We;var e=Qt.exports,Ze={},bt=Gt;Ze.createRoot=bt.createRoot,Ze.hydrateRoot=bt.hydrateRoot;const _e=ne(t=>({isServerOnline:!0,isRealtimeConnected:!1,isInDeviceDetail:!1,setServerOnline:s=>t({isServerOnline:s}),setRealtimeConnected:s=>t({isRealtimeConnected:s}),setInDeviceDetail:s=>t({isInDeviceDetail:s}),get isConnected(){return!1},setConnected:s=>t({isRealtimeConnected:s})}));let Ee=null;function Ys(){if(Ee)return;const t=async()=>{try{const s=await fetch("/api/health",{headers:{Accept:"application/json"}});_e.getState().setServerOnline(s.ok)}catch{_e.getState().setServerOnline(!1)}};t(),Ee=setInterval(t,1e4)}function Vs(){Ee&&(clearInterval(Ee),Ee=null)}const H="/api";async function V(t,s){const r=await fetch(t,{headers:{"Content-Type":"application/json",Accept:"application/json",...s==null?void 0:s.headers},...s});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()}const Re={get:t=>V(t),post:(t,s)=>V(t,{method:"POST",body:s!==void 0?JSON.stringify(s):void 0}),put:(t,s)=>V(t,{method:"PUT",body:s!==void 0?JSON.stringify(s):void 0}),delete:t=>V(t,{method:"DELETE"})};async function Gs(){return V(`${H}/devices`)}async function Js(t){return V(`${H}/devices/${t}`)}async function Qs(t,s,r){await fetch(`${H}/devices/${t}/control/toggle-capture`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({network:s,log:r})})}async function Ks(t){await fetch(`${H}/devices/${t}/data`,{method:"DELETE"})}async function Xs(t,s={}){const r=new URLSearchParams;s.page&&r.set("page",String(s.page)),s.pageSize&&r.set("pageSize",String(s.pageSize)),s.method&&r.set("method",s.method),s.statusCode&&r.set("statusCode",String(s.statusCode)),s.urlContains&&r.set("urlContains",s.urlContains),s.isMocked!==void 0&&r.set("isMocked",String(s.isMocked)),s.timeFrom&&r.set("timeFrom",s.timeFrom),s.timeTo&&r.set("timeTo",s.timeTo);const n=r.toString();return V(`${H}/devices/${t}/http${n?`?${n}`:""}`)}async function Zs(t,s){return V(`${H}/devices/${t}/http/${s}`)}async function er(t,s){return V(`${H}/devices/${t}/http/${s}/curl`)}async function tr(t,s){return V(`${H}/devices/${t}/http/${s}/replay`,{method:"POST"})}async function sr(t,s){return V(`${H}/devices/${t}/http/${s}/favorite`,{method:"POST"})}async function rr(t,s){return V(`${H}/devices/${t}/http/batch/delete`,{method:"POST",body:JSON.stringify({ids:s})})}async function nr(t,s,r){return V(`${H}/devices/${t}/http/batch/favorite`,{method:"POST",body:JSON.stringify({ids:s,isFavorite:r})})}async function ar(){await fetch(`${H}/cleanup/truncate`,{method:"POST"})}async function ir(t,s={}){var a;const r=new URLSearchParams;s.page&&r.set("page",String(s.page)),s.pageSize&&r.set("pageSize",String(s.pageSize)),s.level&&r.set("level",s.level),(a=s.levels)!=null&&a.length&&r.set("levels",s.levels.join(",")),s.subsystem&&r.set("subsystem",s.subsystem),s.category&&r.set("category",s.category),s.loggerName&&r.set("loggerName",s.loggerName),s.text&&r.set("text",s.text),s.traceId&&r.set("traceId",s.traceId),s.timeFrom&&r.set("timeFrom",s.timeFrom),s.timeTo&&r.set("timeTo",s.timeTo);const n=r.toString();return V(`${H}/devices/${t}/logs${n?`?${n}`:""}`)}async function or(t){return V(`${H}/devices/${t}/logs/subsystems`)}async function lr(t){return V(`${H}/devices/${t}/logs/categories`)}async function cr(t,s={}){const r=new URLSearchParams;s.page&&r.set("page",String(s.page)),s.pageSize&&r.set("pageSize",String(s.pageSize)),s.urlContains&&r.set("urlContains",s.urlContains),s.host&&r.set("host",s.host),s.isOpen!==void 0&&r.set("isOpen",String(s.isOpen)),s.timeFrom&&r.set("timeFrom",s.timeFrom),s.timeTo&&r.set("timeTo",s.timeTo);const n=r.toString();return V(`${H}/devices/${t}/ws-sessions${n?`?${n}`:""}`)}async function Xt(t,s){return V(`${H}/devices/${t}/ws-sessions/${s}`)}async function yt(t,s,r={}){const n=new URLSearchParams;r.page&&n.set("page",String(r.page)),r.pageSize&&n.set("pageSize",String(r.pageSize)),r.direction&&n.set("direction",r.direction);const a=n.toString();return V(`${H}/devices/${t}/ws-sessions/${s}/frames${a?`?${a}`:""}`)}async function dr(t,s,r){return V(`${H}/devices/${t}/ws-sessions/${s}/frames/${r}`)}async function ur(t,s){return V(`${H}/devices/${t}/ws-sessions/batch/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:s})})}async function mr(t){return V(`${H}/devices/${t}/mock-rules`)}async function xr(t,s){return V(`${H}/devices/${t}/mock-rules`,{method:"POST",body:JSON.stringify(s)})}async function vt(t,s,r){return V(`${H}/devices/${t}/mock-rules/${s}`,{method:"PUT",body:JSON.stringify(r)})}async function hr(t,s){await fetch(`${H}/devices/${t}/mock-rules/${s}`,{method:"DELETE"})}function pr(t,s="json"){return`${H}/devices/${t}/export/logs?format=${s}`}function fr(t,s="json"){return`${H}/devices/${t}/export/http?format=${s}`}function gr(t,s){const r=new URLSearchParams;s&&s.length>0&&r.set("ids",s.join(","));const n=r.toString();return`${H}/devices/${t}/export/har${n?`?${n}`:""}`}async function br(t){return V(`${H}/devices/${t}/breakpoints`)}async function yr(t,s){return V(`${H}/devices/${t}/breakpoints`,{method:"POST",body:JSON.stringify(s)})}async function jt(t,s,r){return V(`${H}/devices/${t}/breakpoints/${s}`,{method:"PUT",body:JSON.stringify(r)})}async function vr(t,s){await fetch(`${H}/devices/${t}/breakpoints/${s}`,{method:"DELETE"})}async function Zt(t){return V(`${H}/devices/${t}/breakpoints/pending`)}async function es(t,s,r){await fetch(`${H}/devices/${t}/breakpoints/resume/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}async function jr(t){return V(`${H}/devices/${t}/chaos`)}async function Nr(t,s){return V(`${H}/devices/${t}/chaos`,{method:"POST",body:JSON.stringify(s)})}async function Nt(t,s,r){return V(`${H}/devices/${t}/chaos/${s}`,{method:"PUT",body:JSON.stringify(r)})}async function wr(t,s){await fetch(`${H}/devices/${t}/chaos/${s}`,{method:"DELETE"})}async function kr(t){return V(`${H}/devices/${t}/databases`)}async function Sr(t,s){return V(`${H}/devices/${t}/databases/${s}/tables`)}async function Er(t,s,r){return V(`${H}/devices/${t}/databases/${s}/tables/${r}/schema`)}async function Ye(t,s,r,n){const a=new URLSearchParams;n!=null&&n.page&&a.set("page",n.page.toString()),n!=null&&n.pageSize&&a.set("pageSize",n.pageSize.toString()),n!=null&&n.orderBy&&a.set("orderBy",n.orderBy),(n==null?void 0:n.ascending)!==void 0&&a.set("ascending",n.ascending.toString());const i=a.toString(),o=`${H}/devices/${t}/databases/${s}/tables/${r}/rows${i?"?"+i:""}`;return V(o)}async function Tr(t,s,r){return V(`${H}/devices/${t}/databases/${s}/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r})})}async function Cr(){return V(`${H}/stats`)}const Oe=ne((t,s)=>({rules:[],deviceRules:[],isLoading:!1,fetchRules:async()=>{t({isLoading:!0});try{const r=await Re.get("/api/traffic-rules");t({rules:r})}catch(r){console.error("Failed to fetch traffic rules",r)}finally{t({isLoading:!1})}},fetchDeviceRules:async r=>{t({isLoading:!0});try{const n=await Re.get(`/api/devices/${r}/traffic-rules`);t({deviceRules:n})}catch(n){console.error("Failed to fetch device traffic rules",n)}finally{t({isLoading:!1})}},createOrUpdateRule:async r=>{try{const n=await Re.post("/api/traffic-rules",r);t(a=>{let i=a.rules;a.rules.some(l=>l.id===n.id)?i=a.rules.map(l=>l.id===n.id?n:l):i=[n,...a.rules];let o=a.deviceRules;return a.deviceRules.some(l=>l.id===n.id)?o=a.deviceRules.map(l=>l.id===n.id?n:l):(n.deviceId===null||r.deviceId&&a.deviceRules.some(l=>l.deviceId===r.deviceId))&&(o=[n,...a.deviceRules]),{rules:i,deviceRules:o}})}catch(n){throw console.error("Failed to save traffic rule",n),n}},deleteRule:async r=>{try{await Re.delete(`/api/traffic-rules/${r}`),t(n=>({rules:n.rules.filter(a=>a.id!==r),deviceRules:n.deviceRules.filter(a=>a.id!==r)}))}catch(n){throw console.error("Failed to delete traffic rule",n),n}},getDomainRule:(r,n)=>{const{deviceRules:a,rules:i}=s();return(n?a:i).find(l=>l.isEnabled&&l.matchType==="domain"&&l.matchValue===r&&(n?l.deviceId===n||l.deviceId===null:!0))},matchRule:(r,n)=>{const{deviceRules:a,rules:i}=s();return(n?a:i).find(l=>{if(!l.isEnabled)return!1;if(l.matchType==="domain")try{return new URL(r.url).hostname===l.matchValue}catch{return!1}if(l.matchType==="urlRegex")try{return new RegExp(l.matchValue).test(r.url)}catch{return!1}return l.matchType==="header",!1})}}));function nt(t){return t.type==="session-divider"}function xe(t,s){return t.filter(r=>{if(nt(r))return!1;const n=r;if(s.method&&n.method!==s.method)return!1;if(s.statusRange&&n.statusCode){const[a,i]=s.statusRange.split("-").map(Number);if(n.statusCode<a||n.statusCode>i)return!1}if(s.urlContains&&!n.url.toLowerCase().includes(s.urlContains.toLowerCase())||s.mockedOnly&&!n.isMocked||s.favoritesOnly&&!n.isFavorite)return!1;if(s.domains&&s.domains.length>0)try{const a=new URL(n.url);if(!s.domains.includes(a.hostname))return!1}catch{return!1}if(!s.showBlacklisted){const a=Oe.getState().matchRule(n);if(a&&a.action==="hide")return!1}return!0})}const at=ne((t,s)=>({events:[],listItems:[],filteredItems:[],selectedEventId:null,selectedEvent:null,total:0,page:1,pageSize:100,isLoading:!1,autoScroll:!0,selectedIds:new Set,isSelectMode:!1,currentSessionId:null,groupMode:"none",filters:{method:"",statusRange:"",urlContains:"",mockedOnly:!1,favoritesOnly:!1,domains:[],showBlacklisted:!1},fetchEvents:async r=>{const{pageSize:n,filters:a}=s();t({isLoading:!0});try{const i=await Xs(r,{pageSize:n,method:a.method||void 0,urlContains:a.urlContains||void 0,isMocked:a.mockedOnly?!0:void 0});let o=i.items;a.favoritesOnly&&(o=o.filter(c=>c.isFavorite));const l=xe(o,a);t({events:o,listItems:o,filteredItems:l,total:i.total,page:i.page,isLoading:!1}),s().fetchSessionHistory(r)}catch(i){console.error("Failed to fetch HTTP events:",i),t({isLoading:!1})}},fetchSessionHistory:async r=>{},selectEvent:async(r,n)=>{t({selectedEventId:n});try{const a=await Zs(r,n);t({selectedEvent:a})}catch(a){console.error("Failed to fetch HTTP event detail:",a)}},clearSelection:()=>{t({selectedEventId:null,selectedEvent:null})},addRealtimeEvent:r=>{t(n=>{const a=[r,...n.events].slice(0,1e3),i=[r,...n.listItems].slice(0,1e3),o=xe(i,n.filters);return{events:a,listItems:i,filteredItems:o,total:n.total+1}})},clearEvents:()=>{t({events:[],listItems:[],filteredItems:[],total:0,selectedEventId:null,selectedEvent:null,selectedIds:new Set,currentSessionId:null})},addSessionDivider:(r,n)=>{},setFilter:(r,n)=>{t(a=>{const i={...a.filters,[r]:n},o=xe(a.listItems,i);return{filters:i,filteredItems:o}})},toggleDomain:r=>{t(n=>{const a=n.filters.domains,i=a.includes(r)?a.filter(c=>c!==r):[...a,r],o={...n.filters,domains:i},l=xe(n.listItems,o);return{filters:o,filteredItems:l}})},clearDomains:()=>{t(r=>{const n={...r.filters,domains:[]},a=xe(r.listItems,n);return{filters:n,filteredItems:a}})},applyFilters:()=>{t(r=>({filteredItems:xe(r.listItems,r.filters)}))},setAutoScroll:r=>{t({autoScroll:r})},setGroupMode:r=>{t({groupMode:r})},updateEventFavorite:(r,n)=>{t(a=>{var c;const i=a.events.map(d=>d.id===r?{...d,isFavorite:n}:d),o=a.listItems.map(d=>!nt(d)&&d.id===r?{...d,isFavorite:n}:d),l=xe(o,a.filters);return{events:i,listItems:o,filteredItems:l,selectedEvent:((c=a.selectedEvent)==null?void 0:c.id)===r?{...a.selectedEvent,isFavorite:n}:a.selectedEvent}})},toggleSelectMode:()=>{t(r=>({isSelectMode:!r.isSelectMode,selectedIds:r.isSelectMode?new Set:r.selectedIds}))},toggleSelectId:r=>{t(n=>{const a=new Set(n.selectedIds);return a.has(r)?a.delete(r):a.add(r),{selectedIds:a}})},selectAll:()=>{t(r=>{const n=new Set(r.events.map(i=>i.id));return{selectedIds:r.selectedIds.size===r.events.length?new Set:n}})},clearSelectedIds:()=>{t({selectedIds:new Set})},batchDelete:async r=>{const{selectedIds:n,events:a}=s();if(n.size!==0)try{await rr(r,Array.from(n)),t({events:a.filter(i=>!n.has(i.id)),selectedIds:new Set,total:s().total-n.size})}catch(i){console.error("Failed to batch delete:",i)}},batchFavorite:async(r,n)=>{const{selectedIds:a,events:i}=s();if(a.size!==0)try{await nr(r,Array.from(a),n),t({events:i.map(o=>a.has(o.id)?{...o,isFavorite:n}:o),selectedIds:new Set})}catch(o){console.error("Failed to batch favorite:",o)}}})),et={verbose:0,debug:1,info:2,warning:3,error:4};function Dr(t){const s={};if(!t.trim())return s;const r=[{field:"level",pattern:/level:(>=)?(\w+)/gi},{field:"subsystem",pattern:/subsystem:("([^"]+)"|(\S+))/gi},{field:"category",pattern:/category:("([^"]+)"|(\S+))/gi},{field:"message",pattern:/message:("([^"]+)"|(\S+))/gi},{field:"traceId",pattern:/traceId:(\S+)/gi},{field:"file",pattern:/file:("([^"]+)"|(\S+))/gi},{field:"function",pattern:/function:("([^"]+)"|(\S+))/gi},{field:"timestampFrom",pattern:/timestamp:>(\S+)/gi},{field:"timestampTo",pattern:/timestamp:<(\S+)/gi}];let n=t;for(const{field:i,pattern:o}of r){let l;for(;(l=o.exec(t))!==null;)switch(n=n.replace(l[0],""),i){case"level":{const c=l[1]===">=",d=l[2].toLowerCase();et[d]!==void 0&&(c?s.minLevel=d:s.level=d);break}case"subsystem":s.subsystem=l[2]||l[3];break;case"category":s.category=l[2]||l[3];break;case"message":{const c=l[2]||l[3];s.message=c;try{s.messageRegex=new RegExp(c,"i")}catch{}break}case"traceId":s.traceId=l[1];break;case"file":s.file=l[2]||l[3];break;case"function":s.function=l[2]||l[3];break;case"timestampFrom":{const c=new Date(l[1]);isNaN(c.getTime())||(s.timestampFrom=c);break}case"timestampTo":{const c=new Date(l[1]);isNaN(c.getTime())||(s.timestampTo=c);break}}}const a=n.trim();return a&&(s.freeText=a),s}function Or(t,s,r="verbose"){const n=s.minLevel||s.level||r,a=et[n];return t.filter(i=>{var l,c,d,x;const o=et[i.level]??0;if(s.level&&i.level!==s.level||o<a||s.subsystem&&i.subsystem!==s.subsystem||s.category&&i.category!==s.category)return!1;if(s.message){if(s.messageRegex){if(!s.messageRegex.test(i.message))return!1}else if(!i.message.toLowerCase().includes(s.message.toLowerCase()))return!1}if(s.traceId&&i.traceId!==s.traceId||s.file&&i.file&&!i.file.toLowerCase().includes(s.file.toLowerCase())||s.function&&i.function&&!i.function.toLowerCase().includes(s.function.toLowerCase()))return!1;if(s.timestampFrom||s.timestampTo){const h=new Date(i.timestamp);if(s.timestampFrom&&h<s.timestampFrom||s.timestampTo&&h>s.timestampTo)return!1}if(s.freeText){const h=s.freeText.toLowerCase(),w=i.message.toLowerCase().includes(h),T=(l=i.subsystem)==null?void 0:l.toLowerCase().includes(h),f=(c=i.category)==null?void 0:c.toLowerCase().includes(h),y=(d=i.file)==null?void 0:d.toLowerCase().includes(h),R=(x=i.function)==null?void 0:x.toLowerCase().includes(h);if(!w&&!T&&!f&&!y&&!R)return!1}return!0})}const Rr=`
æ”¯æŒçš„æœç´¢è¯­æ³•:
â€¢ level:error - ç²¾ç¡®åŒ¹é…çº§åˆ«
â€¢ level:>=warning - æ˜¾ç¤º warning åŠä»¥ä¸Šçº§åˆ«
â€¢ subsystem:Network - åŒ¹é… subsystem
â€¢ category:API - åŒ¹é… category
â€¢ message:"error message" - æœç´¢æ¶ˆæ¯å†…å®¹
â€¢ traceId:xxx - åŒ¹é… traceId
â€¢ file:ViewController - åŒ¹é…æ–‡ä»¶å
â€¢ function:viewDidLoad - åŒ¹é…å‡½æ•°å
â€¢ timestamp:>2025-12-05T10:00:00 - æ—¶é—´èŒƒå›´
â€¢ ç›´æ¥è¾“å…¥æ–‡æœ¬æœç´¢æ¶ˆæ¯å†…å®¹
`.trim(),wt={verbose:0,debug:1,info:2,warning:3,error:4};function Ir(t,s){const r=wt[s.minLevel];return t.filter(n=>!((wt[n.level]??0)<r||s.subsystem&&n.subsystem!==s.subsystem||s.category&&n.category!==s.category||s.text&&!s.searchQuery&&!n.message.toLowerCase().includes(s.text.toLowerCase())||s.traceId&&n.traceId!==s.traceId))}function fe(t,s){let r=Ir(t,s);if(s.searchQuery){const n=Dr(s.searchQuery);r=Or(r,n,s.minLevel)}return r}const ts=ne((t,s)=>({events:[],filteredEvents:[],total:0,page:1,pageSize:500,isLoading:!1,autoScroll:!0,subsystems:[],categories:[],filters:{minLevel:"verbose",subsystem:"",category:"",text:"",traceId:"",searchQuery:""},fetchEvents:async r=>{const{pageSize:n}=s();t({isLoading:!0});try{const a=await ir(r,{pageSize:n}),{filters:i}=s(),o=fe(a.items,i);t({events:a.items,filteredEvents:o,total:a.total,page:a.page,isLoading:!1})}catch(a){console.error("Failed to fetch log events:",a),t({isLoading:!1})}},fetchFilterOptions:async r=>{try{const[n,a]=await Promise.all([or(r),lr(r)]);t({subsystems:n,categories:a})}catch(n){console.error("Failed to fetch filter options:",n)}},addRealtimeEvent:r=>{t(n=>{const a=[r,...n.events].slice(0,5e3),i=fe(a,n.filters);return{events:a,filteredEvents:i,total:n.total+1}})},clearEvents:()=>{t({events:[],filteredEvents:[],total:0})},setFilter:(r,n)=>{t(a=>{const i={...a.filters,[r]:n},o=fe(a.events,i);return{filters:i,filteredEvents:o}})},setMinLevel:r=>{t(n=>{const a={...n.filters,minLevel:r},i=fe(n.events,a);return{filters:a,filteredEvents:i}})},setSearchQuery:r=>{t(n=>{const a={...n.filters,searchQuery:r},i=fe(n.events,a);return{filters:a,filteredEvents:i}})},applyFilters:()=>{t(r=>({filteredEvents:fe(r.events,r.filters)}))},setAutoScroll:r=>{t({autoScroll:r})}})),ss="debug-hub-favorite-devices",Pr=()=>{try{const t=localStorage.getItem(ss);if(t)return new Set(JSON.parse(t))}catch(t){console.error("Failed to load favorite devices:",t)}return new Set},Mr=t=>{try{localStorage.setItem(ss,JSON.stringify([...t]))}catch(s){console.error("Failed to save favorite devices:",s)}},ze=ne((t,s)=>({devices:[],currentDeviceId:null,currentDevice:null,isLoading:!1,error:null,favoriteDeviceIds:Pr(),fetchDevices:async()=>{t({isLoading:!0,error:null});try{const r=await Gs();t({devices:r,isLoading:!1})}catch(r){t({error:r.message,isLoading:!1})}},selectDevice:async r=>{t({currentDeviceId:r,isLoading:!0,error:null});try{const n=await Js(r);t({currentDevice:n,isLoading:!1})}catch(n){t({error:n.message,isLoading:!1})}},clearSelection:()=>{t({currentDeviceId:null,currentDevice:null})},toggleCapture:async(r,n)=>{const{currentDeviceId:a}=s();if(a)try{await Qs(a,r,n)}catch(i){t({error:i.message})}},clearDeviceData:async()=>{const{currentDeviceId:r}=s();if(r)try{await Ks(r),at.getState().clearEvents(),ts.getState().clearEvents()}catch(n){t({error:n.message})}},toggleFavorite:r=>{const{favoriteDeviceIds:n}=s(),a=new Set(n);a.has(r)?a.delete(r):a.add(r),Mr(a),t({favoriteDeviceIds:a})},isFavorite:r=>s().favoriteDeviceIds.has(r)})),rs=ne((t,s)=>({sessions:[],totalSessions:0,sessionsLoading:!1,sessionsError:null,selectedSessionId:null,selectedSession:null,sessionLoading:!1,frames:[],totalFrames:0,framesLoading:!1,framesError:null,filters:{page:1,pageSize:50},framePage:1,framePageSize:100,frameDirection:"",autoScroll:!0,isSelectMode:!1,selectedIds:new Set,fetchSessions:async r=>{t({sessionsLoading:!0,sessionsError:null});try{const n=await cr(r,s().filters);t({sessions:n.items,totalSessions:n.total,sessionsLoading:!1})}catch(n){console.error("[wsStore] fetchSessions error:",n),t({sessionsLoading:!1,sessionsError:n instanceof Error?n.message:"åŠ è½½å¤±è´¥"})}},selectSession:async(r,n)=>{t({selectedSessionId:n,sessionLoading:!0,frames:[],totalFrames:0});try{const[a]=await Promise.all([Xt(r,n),s().fetchFrames(r,n)]);t({selectedSession:a,sessionLoading:!1})}catch{t({sessionLoading:!1})}},fetchFrames:async(r,n)=>{t({framesLoading:!0,framesError:null,framePage:1});try{const a=await yt(r,n,{page:1,pageSize:s().framePageSize,direction:s().frameDirection||void 0});t({frames:a.items,totalFrames:a.total,framesLoading:!1})}catch(a){t({framesLoading:!1,framesError:a instanceof Error?a.message:"åŠ è½½å¤±è´¥"})}},loadMoreFrames:async(r,n)=>{const{framePage:a,framePageSize:i,frames:o,totalFrames:l}=s();if(!(o.length>=l)){t({framesLoading:!0});try{const c=await yt(r,n,{page:a+1,pageSize:i,direction:s().frameDirection||void 0});t({frames:[...o,...c.items],framePage:a+1,framesLoading:!1})}catch{t({framesLoading:!1})}}},setFilter:(r,n)=>{t(a=>({filters:{...a.filters,[r]:n}}))},setFrameDirection:r=>{t({frameDirection:r})},clearSelection:()=>{t({selectedSessionId:null,selectedSession:null,frames:[],totalFrames:0})},clearSessions:()=>{t({sessions:[],totalSessions:0,selectedSessionId:null,selectedSession:null,frames:[],totalFrames:0})},setAutoScroll:r=>{t({autoScroll:r})},addRealtimeSession:r=>{t(n=>n.sessions.some(a=>a.id===r.id)?n:{sessions:[r,...n.sessions],totalSessions:n.totalSessions+1})},updateSessionStatus:(r,n,a,i)=>{t(o=>{var l;return{sessions:o.sessions.map(c=>c.id===r?{...c,isOpen:n,closeCode:a??c.closeCode,closeReason:i??c.closeReason}:c),selectedSession:((l=o.selectedSession)==null?void 0:l.id)===r?{...o.selectedSession,closeCode:a??null,closeReason:i??null}:o.selectedSession}})},updateSessionUrl:(r,n)=>{t(a=>({sessions:a.sessions.map(i=>i.id===r?{...i,url:n}:i)}))},addRealtimeFrame:r=>{const{selectedSessionId:n}=s();r.sessionId===n&&t(a=>({frames:[...a.frames,r],totalFrames:a.totalFrames+1}))},toggleSelectMode:()=>{t(r=>({isSelectMode:!r.isSelectMode,selectedIds:r.isSelectMode?new Set:r.selectedIds}))},toggleSelectId:r=>{t(n=>{const a=new Set(n.selectedIds);return a.has(r)?a.delete(r):a.add(r),{selectedIds:a}})},selectAll:()=>{t(r=>{const n=new Set(r.sessions.map(i=>i.id));return{selectedIds:r.selectedIds.size===r.sessions.length?new Set:n}})},clearSelectedIds:()=>{t({selectedIds:new Set})},batchDelete:async r=>{const{selectedIds:n,sessions:a}=s();if(n.size!==0)try{await ur(r,Array.from(n)),t({sessions:a.filter(i=>!n.has(i.id)),selectedIds:new Set,totalSessions:s().totalSessions-n.size,selectedSessionId:n.has(s().selectedSessionId??"")?null:s().selectedSessionId,selectedSession:n.has(s().selectedSessionId??"")?null:s().selectedSession})}catch(i){console.error("Failed to batch delete WS sessions:",i)}}})),Fr={iOS:"ğŸ“±",iPadOS:"ğŸ“±",macOS:"ğŸ’»",watchOS:"âŒš",tvOS:"ğŸ“º"};function it(t){return Fr[t]||"ğŸ“±"}const ot="ğŸ”²";function Lr(t){if(t==null)return"-";if(t===0)return"0 B";if(isNaN(t))return"-";const s=1024,r=["B","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(s)),a=Math.min(n,r.length-1);return parseFloat((t/Math.pow(s,a)).toFixed(1))+" "+r[a]}function ge(t){return t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString()}function _r(){const[t,s]=m.useState(null),[r,n]=m.useState(!1),[a,i]=m.useState(!1),o=async()=>{i(!0);try{const c=await Cr();s(c)}catch(c){console.error("Failed to fetch server stats:",c)}finally{i(!1)}};if(m.useEffect(()=>{o();const c=setInterval(o,3e4);return()=>clearInterval(c)},[]),!t)return null;const l=({icon:c,label:d,value:x})=>e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsxs("span",{className:"text-text-muted",children:[e.jsx("span",{className:"mr-1.5",children:c}),d]}),e.jsx("span",{className:"font-mono text-text-primary",children:x})]});return e.jsxs("div",{className:"border-t border-border",children:[e.jsxs("button",{onClick:()=>n(!r),className:"w-full px-4 py-2 flex items-center justify-between hover:bg-bg-light transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“Š"}),e.jsx("span",{className:"text-xs font-medium text-text-primary",children:"æœåŠ¡å™¨ç»Ÿè®¡"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!r&&t&&e.jsxs("span",{className:"text-xs text-text-muted",children:[ge(t.httpEventCount)," HTTP Â· ",ge(t.logEventCount)," Log"]}),e.jsx("span",{className:`text-xs text-text-muted transition-transform ${r?"rotate-180":""}`,children:"â–¼"})]})]}),r&&e.jsxs("div",{className:"px-4 pb-3 text-xs space-y-0.5",children:[e.jsx("div",{className:"text-text-muted/60 text-2xs uppercase tracking-wider mt-1 mb-1",children:"æ•°æ®è®°å½•"}),e.jsx(l,{icon:"ğŸŒ",label:"HTTP äº‹ä»¶",value:ge(t.httpEventCount)}),e.jsx(l,{icon:"ğŸ“",label:"æ—¥å¿—æ¡ç›®",value:ge(t.logEventCount)}),e.jsx(l,{icon:"ğŸ”Œ",label:"WS ä¼šè¯",value:ge(t.wsSessionCount)}),e.jsx(l,{icon:"ğŸ“¨",label:"WS å¸§",value:ge(t.wsFrameCount)}),e.jsx("div",{className:"text-text-muted/60 text-2xs uppercase tracking-wider mt-2 mb-1",children:"è§„åˆ™é…ç½®"}),e.jsx(l,{icon:"ğŸ­",label:"Mock è§„åˆ™",value:t.mockRuleCount}),e.jsx(l,{icon:"â¸ï¸",label:"æ–­ç‚¹è§„åˆ™",value:t.breakpointRuleCount}),e.jsx(l,{icon:"ğŸŒ€",label:"æ··æ²Œè§„åˆ™",value:t.chaosRuleCount}),e.jsx(l,{icon:"ğŸš¦",label:"æµé‡è§„åˆ™",value:t.trafficRuleCount}),e.jsx("div",{className:"text-text-muted/60 text-2xs uppercase tracking-wider mt-2 mb-1",children:"è®¾å¤‡è¿æ¥"}),e.jsx(l,{icon:"ğŸ“±",label:"åœ¨çº¿è®¾å¤‡",value:t.onlineDeviceCount}),e.jsx(l,{icon:"ğŸ“‹",label:"å†å²ä¼šè¯",value:t.deviceSessionCount}),t.databaseSizeBytes!==null&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-text-muted/60 text-2xs uppercase tracking-wider mt-2 mb-1",children:"å­˜å‚¨"}),e.jsx(l,{icon:"ğŸ’¾",label:"æ•°æ®åº“å¤§å°",value:Lr(t.databaseSizeBytes)})]}),e.jsx("button",{onClick:o,disabled:a,className:"mt-2 w-full py-1.5 text-center text-xs text-text-muted hover:text-text-primary hover:bg-bg-light rounded transition-colors disabled:opacity-50",children:a?"åˆ·æ–°ä¸­...":"ğŸ”„ åˆ·æ–°ç»Ÿè®¡"})]})]})}function ns(t){var s,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(s=0;s<a;s++)t[s]&&(r=ns(t[s]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function g(){for(var t,s,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(s=ns(t))&&(n&&(n+=" "),n+=s);return n}function Ar(){const t=rt(),s=Jt(),{isServerOnline:r}=_e(),{devices:n,fetchDevices:a,currentDeviceId:i,selectDevice:o,favoriteDeviceIds:l,toggleFavorite:c}=ze(),{events:d,toggleDomain:x,clearDomains:h,filters:w}=at(),{sessions:T,setFilter:f,filters:y}=rs(),{getDomainRule:R,createOrUpdateRule:C,deleteRule:k}=Oe(),[O,B]=m.useState(!1),b=m.useMemo(()=>new URLSearchParams(s.search).get("tab")||"http",[s.search]),[$,Y]=m.useState(""),[W,G]=m.useState(new Set),j=m.useRef({});m.useEffect(()=>{a()},[]);const F=m.useMemo(()=>{if(b==="websocket"){const I={};return T.forEach(q=>{try{const _=new URL(q.url).hostname;I[_]=(I[_]||0)+1}catch{}}),Object.entries(I).map(([q,A])=>({domain:q,count:A})).sort((q,A)=>A.count-q.count)}else{const I={};return d.forEach(q=>{try{const A=new URL(q.url).hostname;I[A]=(I[A]||0)+1}catch{}}),Object.entries(I).map(([q,A])=>({domain:q,count:A})).sort((q,A)=>A.count-q.count)}},[d,T,b]),z=m.useRef(b);m.useEffect(()=>{if(z.current!==b){z.current=b;const A={};F.forEach(({domain:_,count:X})=>{A[_]=X}),j.current=A;return}const I={};F.forEach(({domain:A,count:_})=>{I[A]=_});const q=new Set;for(const[A,_]of Object.entries(I)){const X=j.current[A]||0;_>X&&q.add(A)}q.size>0&&(G(A=>new Set([...A,...q])),setTimeout(()=>{G(A=>{const _=new Set(A);return q.forEach(X=>_.delete(X)),_})},1500)),j.current=I},[F,b]);const D=m.useMemo(()=>{if(!$.trim())return F;const I=$.toLowerCase();return F.filter(({domain:q})=>q.toLowerCase().includes(I))},[F,$]),S=m.useMemo(()=>O?n:n.filter(I=>I.deviceId===i||l.has(I.deviceId)),[n,i,l,O]),u=n.length-S.length,N=I=>{o(I),t(`/device/${I}`)},p=(I,q)=>{I.stopPropagation(),c(q)},E=I=>{b==="websocket"?y.host===I?f("host",""):f("host",I):x(I)},v=()=>{b==="websocket"?f("host",""):h()},M=I=>b==="websocket"?y.host===I:w.domains.includes(I),U=()=>b==="websocket"?!y.host:w.domains.length===0,K=async(I,q)=>{I.stopPropagation();const A=R(q);A?A.action==="highlight"?await C({...A,action:"hide"}):A.id&&await k(A.id):await C({name:q,matchType:"domain",matchValue:q,action:"highlight",isEnabled:!0,priority:0})};return e.jsxs("aside",{className:"w-72 bg-bg-dark border-r border-border flex flex-col h-full",children:[e.jsxs("div",{className:"p-5 border-b border-border flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:"ğŸ”"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-text-primary text-lg",children:"Debug Hub"}),e.jsx("p",{className:"text-2xs text-text-muted",children:"Network Inspector"})]})]}),e.jsxs(de,{to:"/rules",className:"flex items-center gap-1.5 text-xs font-medium px-3 py-1.5 rounded-lg bg-bg-light text-text-secondary hover:text-primary hover:bg-bg-lighter transition-colors",title:"ç®¡ç†æµé‡è§„åˆ™",children:[e.jsx("span",{children:"âš™ï¸"}),"Rules"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"px-3 py-4",children:[e.jsxs("div",{className:"px-2 mb-3 text-xs font-semibold text-text-secondary uppercase tracking-wider flex justify-between items-center",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"ğŸ“±"}),"Devices"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u>0&&!O&&e.jsxs("button",{onClick:()=>B(!0),className:"text-2xs text-text-muted hover:text-primary transition-colors",title:"æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡",children:["+",u," æ›´å¤š"]}),O&&e.jsx("button",{onClick:()=>B(!1),className:"text-2xs text-text-muted hover:text-primary transition-colors",title:"åªæ˜¾ç¤ºæ”¶è—è®¾å¤‡",children:"æ”¶èµ·"}),e.jsx("span",{className:"bg-primary/10 text-primary px-2 py-0.5 rounded-full text-2xs font-bold",children:n.length})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[S.map(I=>{const q=l.has(I.deviceId),A=i===I.deviceId;return e.jsxs("div",{onClick:()=>N(I.deviceId),className:g("group flex items-center gap-3 px-3 py-3 rounded-lg cursor-pointer transition-colors",A?"bg-primary text-bg-darkest":"text-text-secondary hover:bg-bg-light hover:text-text-primary"),children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:g("w-10 h-10 rounded-lg flex items-center justify-center",A?"bg-bg-dark/30":"bg-bg-medium"),children:e.jsx("span",{className:"text-xl",children:it(I.platform)})}),I.isOnline&&e.jsx("span",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-bg-dark rounded-full"})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"font-medium truncate text-sm flex items-center gap-1.5",children:[I.deviceName,I.isSimulator&&e.jsx("span",{className:g("text-2xs px-1.5 py-0.5 rounded",A?"bg-bg-darkest/20 text-bg-darkest":"bg-purple-500/20 text-purple-400"),title:"æ¨¡æ‹Ÿå™¨",children:ot})]}),e.jsxs("div",{className:g("text-2xs truncate mt-0.5",A?"text-bg-darkest/80":"text-text-muted"),children:[I.appName," ",e.jsxs("span",{className:A?"text-bg-darkest/60":"opacity-60",children:[I.appVersion," (",I.buildNumber,")"]})]}),e.jsxs("div",{className:g("text-2xs truncate mt-0.5",A?"text-bg-darkest/80":"text-text-muted"),children:[I.platform," ",e.jsx("span",{className:A?"text-bg-darkest/60":"opacity-60",children:I.systemVersion})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:_=>p(_,I.deviceId),className:g("p-1.5 rounded transition-all",q?"text-yellow-400 hover:text-yellow-300":A?"text-bg-darkest/50 opacity-0 group-hover:opacity-100 hover:text-yellow-400":"text-text-muted opacity-0 group-hover:opacity-100 hover:text-yellow-400"),title:q?"å–æ¶ˆæ”¶è—":"æ”¶è—è®¾å¤‡",children:q?"â­":"â˜†"}),e.jsx("span",{className:g("opacity-0 group-hover:opacity-100 transition-opacity text-sm",A?"text-bg-darkest/70":"text-text-muted"),children:"â†’"})]})]},I.deviceId)}),S.length===0&&n.length>0&&e.jsx("div",{className:"px-4 py-4 text-center text-xs text-text-muted",children:e.jsxs("button",{onClick:()=>B(!0),className:"text-primary hover:underline",children:["æ˜¾ç¤ºå…¨éƒ¨ ",n.length," ä¸ªè®¾å¤‡"]})}),n.length===0&&!r&&e.jsxs("div",{className:"px-4 py-6 text-center text-xs text-text-muted bg-bg-light/20 rounded-lg border border-dashed border-border",children:[e.jsx("span",{className:"text-2xl block mb-2 opacity-50",children:"ğŸ“¡"}),"ç­‰å¾…æœåŠ¡è¿æ¥..."]})]})]}),i&&(b==="http"||b==="websocket")&&e.jsx("div",{className:"divider mx-5 my-2"}),i&&(b==="http"||b==="websocket")&&e.jsxs("div",{className:"px-3 py-3",children:[e.jsxs("div",{className:"px-2 mb-3 text-xs font-semibold text-text-secondary uppercase tracking-wider flex justify-between items-center",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:b==="websocket"?"ğŸ”Œ":"ğŸŒ"}),b==="websocket"?"WS Hosts":"Domains"]}),e.jsx("span",{className:"bg-accent-blue/10 text-accent-blue px-2 py-0.5 rounded-full text-2xs font-bold",children:F.length})]}),e.jsx("div",{className:"px-1 mb-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted text-xs",children:"ğŸ”"}),e.jsx("input",{type:"text",value:$,onChange:I=>Y(I.target.value),placeholder:b==="websocket"?"æœç´¢ä¸»æœº...":"æœç´¢åŸŸå...",className:"w-full pl-8 pr-3 py-2 text-xs bg-bg-medium border border-border rounded text-text-primary placeholder:text-text-muted focus:outline-none focus:border-primary transition-colors"})]})}),e.jsxs("div",{className:"space-y-0.5 max-h-[400px] overflow-y-auto pr-1",children:[e.jsxs("div",{onClick:v,className:g("flex items-center justify-between px-3 py-2 rounded cursor-pointer text-xs transition-colors group",U()?"bg-primary text-bg-darkest font-medium":"text-text-secondary hover:bg-bg-light"),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-sm",children:"ğŸ“‹"}),e.jsx("span",{className:"font-medium",children:b==="websocket"?"å…¨éƒ¨ä¸»æœº":"å…¨éƒ¨åŸŸå"})]}),e.jsx("span",{className:g("font-mono text-2xs px-1.5 py-0.5 rounded",U()?"text-bg-darkest font-bold bg-bg-darkest/20":"opacity-60 bg-bg-medium"),children:F.reduce((I,{count:q})=>I+q,0)})]}),F.length>0&&e.jsx("div",{className:"border-t border-border-subtle my-1"}),D.map(({domain:I,count:q})=>{const A=R(I),_=(A==null?void 0:A.action)==="highlight",X=(A==null?void 0:A.action)==="hide",ae=M(I),L=W.has(I);return e.jsxs("div",{onClick:()=>E(I),className:g("flex items-center justify-between px-3 py-2 rounded cursor-pointer text-xs transition-colors group",ae?"bg-accent-blue text-white font-medium":"text-text-secondary hover:bg-bg-light",L&&"animate-domain-highlight"),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[b==="http"&&e.jsx("input",{type:"checkbox",checked:ae,onChange:()=>E(I),onClick:Z=>Z.stopPropagation(),className:"w-4 h-4 min-w-4 min-h-4 flex-shrink-0 rounded border-border cursor-pointer accent-primary"}),_&&e.jsx("span",{className:"text-yellow-500 text-xs",title:"Highlighted",children:"â˜…"}),X&&e.jsx("span",{className:"text-red-400 text-xs",title:"Hidden",children:"â›”"}),e.jsx("span",{className:g("truncate font-mono",X&&"opacity-50 line-through"),children:I})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:g("font-mono text-2xs px-1.5 py-0.5 rounded",L?"text-primary font-bold bg-primary/10":"opacity-60 bg-bg-medium"),children:q}),e.jsx("button",{onClick:Z=>K(Z,I),className:"opacity-0 group-hover:opacity-100 p-1.5 hover:bg-bg-medium rounded transition-colors text-text-muted hover:text-text-primary",title:"Toggle Rule (None -> Highlight -> Hide)",children:"â‹®"})]})]},I)}),D.length===0&&$&&e.jsxs("div",{className:"px-4 py-4 text-center text-xs text-text-muted bg-bg-light/20 rounded border border-dashed border-border",children:[e.jsx("span",{className:"text-lg block mb-1 opacity-50",children:"ğŸ”"}),b==="websocket"?"æœªæ‰¾åˆ°åŒ¹é…çš„ä¸»æœº":"æœªæ‰¾åˆ°åŒ¹é…çš„åŸŸå"]}),F.length===0&&!$&&e.jsxs("div",{className:"px-4 py-4 text-center text-xs text-text-muted bg-bg-light/20 rounded border border-dashed border-border",children:[e.jsx("span",{className:"text-lg block mb-1 opacity-50",children:b==="websocket"?"ğŸ”Œ":"ğŸŒ"}),b==="websocket"?"æš‚æ—  WebSocket ä¸»æœº":"æš‚æ— åŸŸåè®°å½•"]})]})]})]}),e.jsx(_r,{}),e.jsxs("div",{className:"p-4 bg-bg-darker border-t border-border text-xs text-text-muted flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:g("w-2 h-2 rounded-full",r?"bg-green-500":"bg-red-500")}),e.jsx("span",{className:"font-medium",children:r?"Online":"Offline"})]}),e.jsx("span",{className:"text-text-muted/50",children:"v1.0"})]})]})}function kt(){return{name:"æ–°è§„åˆ™",targetType:"httpResponse",condition:{urlPattern:"",method:null,statusCode:null,headerContains:null,bodyContains:null,wsPayloadContains:null,enabled:!0},action:{modifyRequestHeaders:null,modifyRequestBody:null,mockResponseStatusCode:200,mockResponseHeaders:{"Content-Type":"application/json"},mockResponseBody:btoa(JSON.stringify({mock:!0})),mockWebSocketPayload:null,delayMilliseconds:null},priority:0,enabled:!0}}const $r=ne((t,s)=>({rules:[],loading:!1,error:null,editingRule:null,isEditorOpen:!1,fetchRules:async r=>{t({loading:!0,error:null});try{const n=await mr(r);t({rules:n,loading:!1})}catch(n){t({loading:!1,error:n instanceof Error?n.message:"åŠ è½½å¤±è´¥"})}},createRule:async(r,n)=>{t({loading:!0,error:null});try{const a=await xr(r,n);t(i=>({rules:[a,...i.rules],loading:!1,isEditorOpen:!1,editingRule:null}))}catch(a){throw t({loading:!1,error:a instanceof Error?a.message:"åˆ›å»ºå¤±è´¥"}),a}},updateRule:async(r,n,a)=>{t({loading:!0,error:null});try{const i=await vt(r,n,a);t(o=>({rules:o.rules.map(l=>l.id===n?i:l),loading:!1,isEditorOpen:!1,editingRule:null}))}catch(i){throw t({loading:!1,error:i instanceof Error?i.message:"æ›´æ–°å¤±è´¥"}),i}},deleteRule:async(r,n)=>{t({loading:!0,error:null});try{await hr(r,n),t(a=>({rules:a.rules.filter(i=>i.id!==n),loading:!1}))}catch(a){t({loading:!1,error:a instanceof Error?a.message:"åˆ é™¤å¤±è´¥"})}},toggleRuleEnabled:async(r,n)=>{const a=s().rules.find(i=>i.id===n);if(a)try{await vt(r,n,{enabled:!a.enabled}),t(i=>({rules:i.rules.map(o=>o.id===n?{...o,enabled:!o.enabled}:o)}))}catch(i){console.error("Failed to toggle rule:",i)}},openEditor:r=>{t({isEditorOpen:!0,editingRule:r||null})},closeEditor:()=>{t({isEditorOpen:!1,editingRule:null})},clearRules:()=>{t({rules:[],editingRule:null,isEditorOpen:!1})}}));function Br(t,s){let r;try{r=t()}catch{return}return{getItem:a=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=r.getItem(a))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(a,i)=>r.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>r.removeItem(a)}}const tt=t=>s=>{try{const r=t(s);return r instanceof Promise?r:{then(n){return tt(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return tt(n)(r)}}}},Hr=(t,s)=>(r,n,a)=>{let i={storage:Br(()=>localStorage),partialize:y=>y,version:0,merge:(y,R)=>({...R,...y}),...s},o=!1;const l=new Set,c=new Set;let d=i.storage;if(!d)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...y)},n,a);const x=()=>{const y=i.partialize({...n()});return d.setItem(i.name,{state:y,version:i.version})},h=a.setState;a.setState=(y,R)=>(h(y,R),x());const w=t((...y)=>(r(...y),x()),n,a);a.getInitialState=()=>w;let T;const f=()=>{var y,R;if(!d)return;o=!1,l.forEach(k=>{var O;return k((O=n())!=null?O:w)});const C=((R=i.onRehydrateStorage)==null?void 0:R.call(i,(y=n())!=null?y:w))||void 0;return tt(d.getItem.bind(d))(i.name).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==i.version){if(i.migrate){const O=i.migrate(k.state,k.version);return O instanceof Promise?O.then(B=>[!0,B]):[!0,O]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,k.state];return[!1,void 0]}).then(k=>{var O;const[B,b]=k;if(T=i.merge(b,(O=n())!=null?O:w),r(T,!0),B)return x()}).then(()=>{C==null||C(T,void 0),T=n(),o=!0,c.forEach(k=>k(T))}).catch(k=>{C==null||C(void 0,k)})};return a.persist={setOptions:y=>{i={...i,...y},y.storage&&(d=y.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>f(),hasHydrated:()=>o,onHydrate:y=>(l.add(y),()=>{l.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},i.skipHydration||f(),T||w},as=Hr;function Wr(){return typeof window>"u"||window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Ve(t){return t==="system"?Wr():t}function Ge(t){const s=document.documentElement;t==="light"?(s.classList.add("light"),s.classList.remove("dark")):(s.classList.add("dark"),s.classList.remove("light"))}const Ue=ne()(as((t,s)=>({theme:"dark",resolvedTheme:"dark",setTheme:r=>{const n=Ve(r);Ge(n),t({theme:r,resolvedTheme:n})},toggleTheme:()=>{const{theme:r}=s(),n=r==="dark"?"light":r==="light"?"system":"dark",a=Ve(n);Ge(a),t({theme:n,resolvedTheme:a})}}),{name:"debug-platform-theme",onRehydrateStorage:()=>t=>{if(t){const s=Ve(t.theme);Ge(s),t.resolvedTheme=s}}}));typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const{theme:t,setTheme:s}=Ue.getState();t==="system"&&s("system")});const is=ne((t,s)=>({activities:[],maxActivities:100,addActivity:r=>t(n=>({activities:[r,...n.activities].slice(0,n.maxActivities)})),clearActivities:()=>t({activities:[]}),getActivitiesForDevice:r=>s().activities.filter(n=>n.deviceId===r)})),zr=ne((t,s)=>({pendingHits:[],loading:!1,fetchPendingHits:async r=>{t({loading:!0});try{const n=await Zt(r);t({pendingHits:n})}catch(n){console.error("Failed to fetch pending breakpoints:",n)}finally{t({loading:!1})}},addHit:r=>{t(n=>n.pendingHits.some(a=>a.requestId===r.requestId)?n:{pendingHits:[...n.pendingHits,r]})},removeHit:r=>{t(n=>({pendingHits:n.pendingHits.filter(a=>a.requestId!==r)}))},resumeBreakpoint:async(r,n,a)=>{try{await es(r,n,a),s().removeHit(n)}catch(i){throw console.error("Failed to resume breakpoint:",i),i}},clear:()=>{t({pendingHits:[]})}}));class Ur{constructor(){me(this,"ws",null);me(this,"messageHandlers",new Set);me(this,"connectionHandlers",new Set);me(this,"reconnectTimer",null);me(this,"currentDeviceId",null);me(this,"shouldReconnect",!1)}connect(s,r="both"){this.disconnect(),this.currentDeviceId=s,this.shouldReconnect=!0;const a=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/live?deviceId=${s}&type=${r}`;this.ws=new WebSocket(a),this.ws.onopen=()=>{console.log("[Realtime] Connected"),this.notifyConnectionHandlers(!0)},this.ws.onclose=()=>{console.log("[Realtime] Disconnected"),this.notifyConnectionHandlers(!1),this.scheduleReconnect()},this.ws.onerror=i=>{console.error("[Realtime] Error:",i)},this.ws.onmessage=i=>{try{const o=JSON.parse(i.data);this.notifyMessageHandlers(o)}catch(o){console.error("[Realtime] Failed to parse message:",o)}}}disconnect(){this.shouldReconnect=!1,this.currentDeviceId=null,this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.close(),this.ws=null)}scheduleReconnect(){!this.shouldReconnect||!this.currentDeviceId||(this.reconnectTimer=window.setTimeout(()=>{this.currentDeviceId&&(console.log("[Realtime] Reconnecting..."),this.connect(this.currentDeviceId))},3e3))}onMessage(s){return this.messageHandlers.add(s),()=>this.messageHandlers.delete(s)}onConnection(s){return this.connectionHandlers.add(s),()=>this.connectionHandlers.delete(s)}notifyMessageHandlers(s){this.messageHandlers.forEach(r=>r(s))}notifyConnectionHandlers(s){this.connectionHandlers.forEach(r=>r(s))}get isConnected(){var s;return((s=this.ws)==null?void 0:s.readyState)===WebSocket.OPEN}}const Ie=new Ur;function qr(t){var r,n,a;const s=JSON.parse(t);return{id:s.request.id,method:s.request.method,url:s.request.url,statusCode:((r=s.response)==null?void 0:r.statusCode)??null,startTime:s.request.startTime,duration:((n=s.response)==null?void 0:n.duration)??null,isMocked:s.isMocked,errorDescription:((a=s.response)==null?void 0:a.errorDescription)??null,traceId:s.request.traceId??null,isFavorite:s.isFavorite??!1}}function Yr(t){return JSON.parse(t)}function Vr(t){const s=JSON.parse(t),r=n=>n&&typeof n=="object"&&"_0"in n?n._0:n;return s.kind.sessionCreated?{type:"sessionCreated",data:r(s.kind.sessionCreated)}:s.kind.sessionClosed?{type:"sessionClosed",data:r(s.kind.sessionClosed)}:s.kind.frame?{type:"frame",data:r(s.kind.frame)}:{type:"unknown",data:s}}function be(t,s,r){let n=r.initialDeps??[],a;function i(){var o,l,c,d;let x;r.key&&((o=r.debug)!=null&&o.call(r))&&(x=Date.now());const h=t();if(!(h.length!==n.length||h.some((f,y)=>n[y]!==f)))return a;n=h;let T;if(r.key&&((l=r.debug)!=null&&l.call(r))&&(T=Date.now()),a=s(...h),r.key&&((c=r.debug)!=null&&c.call(r))){const f=Math.round((Date.now()-x)*100)/100,y=Math.round((Date.now()-T)*100)/100,R=y/16,C=(k,O)=>{for(k=String(k);k.length<O;)k=" "+k;return k};console.info(`%câ± ${C(y,5)} /${C(f,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*R,120))}deg 100% 31%);`,r==null?void 0:r.key)}return(d=r==null?void 0:r.onChange)==null||d.call(r,a),a}return i.updateDeps=o=>{n=o},i}function St(t,s){if(t===void 0)throw new Error("Unexpected undefined");return t}const Gr=(t,s)=>Math.abs(t-s)<1.01,Jr=(t,s,r)=>{let n;return function(...a){t.clearTimeout(n),n=t.setTimeout(()=>s.apply(this,a),r)}},Et=t=>{const{offsetWidth:s,offsetHeight:r}=t;return{width:s,height:r}},Qr=t=>t,Kr=t=>{const s=Math.max(t.startIndex-t.overscan,0),r=Math.min(t.endIndex+t.overscan,t.count-1),n=[];for(let a=s;a<=r;a++)n.push(a);return n},Xr=(t,s)=>{const r=t.scrollElement;if(!r)return;const n=t.targetWindow;if(!n)return;const a=o=>{const{width:l,height:c}=o;s({width:Math.round(l),height:Math.round(c)})};if(a(Et(r)),!n.ResizeObserver)return()=>{};const i=new n.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){a({width:d.inlineSize,height:d.blockSize});return}}a(Et(r))};t.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(r,{box:"border-box"}),()=>{i.unobserve(r)}},Tt={passive:!0},Ct=typeof window>"u"?!0:"onscrollend"in window,Zr=(t,s)=>{const r=t.scrollElement;if(!r)return;const n=t.targetWindow;if(!n)return;let a=0;const i=t.options.useScrollendEvent&&Ct?()=>{}:Jr(n,()=>{s(a,!1)},t.options.isScrollingResetDelay),o=x=>()=>{const{horizontal:h,isRtl:w}=t.options;a=h?r.scrollLeft*(w&&-1||1):r.scrollTop,i(),s(a,x)},l=o(!0),c=o(!1);c(),r.addEventListener("scroll",l,Tt);const d=t.options.useScrollendEvent&&Ct;return d&&r.addEventListener("scrollend",c,Tt),()=>{r.removeEventListener("scroll",l),d&&r.removeEventListener("scrollend",c)}},en=(t,s,r)=>{if(s!=null&&s.borderBoxSize){const n=s.borderBoxSize[0];if(n)return Math.round(n[r.options.horizontal?"inlineSize":"blockSize"])}return t[r.options.horizontal?"offsetWidth":"offsetHeight"]},tn=(t,{adjustments:s=0,behavior:r},n)=>{var a,i;const o=t+s;(i=(a=n.scrollElement)==null?void 0:a.scrollTo)==null||i.call(a,{[n.options.horizontal?"left":"top"]:o,behavior:r})};class sn{constructor(s){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let r=null;const n=()=>r||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:r=new this.targetWindow.ResizeObserver(a=>{a.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var a;(a=n())==null||a.disconnect(),r=null},observe:a=>{var i;return(i=n())==null?void 0:i.observe(a,{box:"border-box"})},unobserve:a=>{var i;return(i=n())==null?void 0:i.unobserve(a)}}})(),this.range=null,this.setOptions=r=>{Object.entries(r).forEach(([n,a])=>{typeof a>"u"&&delete r[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Qr,rangeExtractor:Kr,onChange:()=>{},measureElement:en,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...r}},this.notify=r=>{var n,a;(a=(n=this.options).onChange)==null||a.call(n,this,r)},this.maybeNotify=be(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),r=>{this.notify(r)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(r=>r()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var r;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((r=this.scrollElement)==null?void 0:r.window)??null,this.elementsCache.forEach(a=>{this.observer.observe(a)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,a=>{this.scrollRect=a,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(a,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<a?"forward":"backward":null,this.scrollOffset=a,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(r,n)=>{const a=new Map,i=new Map;for(let o=n-1;o>=0;o--){const l=r[o];if(a.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&a.set(l.lane,!0),a.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=be(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(r,n,a,i,o)=>(this.pendingMeasuredCacheIndexes=[],{count:r,paddingStart:n,scrollMargin:a,getItemKey:i,enabled:o}),{key:!1}),this.getMeasurements=be(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:r,paddingStart:n,scrollMargin:a,getItemKey:i,enabled:o},l)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(x=>{this.itemSizeCache.set(x.key,x.size)}));const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const d=this.measurementsCache.slice(0,c);for(let x=c;x<r;x++){const h=i(x),w=this.options.lanes===1?d[x-1]:this.getFurthestMeasurement(d,x),T=w?w.end+this.options.gap:n+a,f=l.get(h),y=typeof f=="number"?f:this.options.estimateSize(x),R=T+y,C=w?w.lane:x%this.options.lanes;d[x]={index:x,start:T,size:y,end:R,key:h,lane:C}}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=be(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(r,n,a,i)=>this.range=r.length>0&&n>0?rn({measurements:r,outerSize:n,scrollOffset:a,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=be(()=>{let r=null,n=null;const a=this.calculateRange();return a&&(r=a.startIndex,n=a.endIndex),this.maybeNotify.updateDeps([this.isScrolling,r,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,r,n]},(r,n,a,i,o)=>i===null||o===null?[]:r({startIndex:i,endIndex:o,overscan:n,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=r=>{const n=this.options.indexAttribute,a=r.getAttribute(n);return a?parseInt(a,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(r,n)=>{const a=this.indexFromElement(r),i=this.measurementsCache[a];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==r&&(l&&this.observer.unobserve(l),this.observer.observe(r),this.elementsCache.set(o,r)),r.isConnected&&this.resizeItem(a,this.options.measureElement(r,n,this))},this.resizeItem=(r,n)=>{const a=this.measurementsCache[r];if(!a)return;const i=this.itemSizeCache.get(a.key)??a.size,o=n-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(a,o,this):a.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(a.index),this.itemSizeCache=new Map(this.itemSizeCache.set(a.key,n)),this.notify(!1))},this.measureElement=r=>{if(!r){this.elementsCache.forEach((n,a)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(a))});return}this._measureElement(r,void 0)},this.getVirtualItems=be(()=>[this.getVirtualIndexes(),this.getMeasurements()],(r,n)=>{const a=[];for(let i=0,o=r.length;i<o;i++){const l=r[i],c=n[l];a.push(c)}return a},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=r=>{const n=this.getMeasurements();if(n.length!==0)return St(n[os(0,n.length-1,a=>St(n[a]).start,r)])},this.getOffsetForAlignment=(r,n,a=0)=>{const i=this.getSize(),o=this.getScrollOffset();n==="auto"&&(n=r>=o+i?"end":"start"),n==="center"?r+=(a-i)/2:n==="end"&&(r-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,r),0)},this.getOffsetForIndex=(r,n="auto")=>{r=Math.max(0,Math.min(r,this.options.count-1));const a=this.measurementsCache[r];if(!a)return;const i=this.getSize(),o=this.getScrollOffset();if(n==="auto")if(a.end>=o+i-this.options.scrollPaddingEnd)n="end";else if(a.start<=o+this.options.scrollPaddingStart)n="start";else return[o,n];const l=n==="end"?a.end+this.options.scrollPaddingEnd:a.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,n,a.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(r,{align:n="start",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(r,n),{adjustments:void 0,behavior:a})},this.scrollToIndex=(r,{align:n="auto",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r=Math.max(0,Math.min(r,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const x=this.getOffsetForIndex(r,d);if(!x){console.warn("Failed to get offset for index:",r);return}const[h,w]=x;this._scrollToOffset(h,{adjustments:void 0,behavior:a}),this.targetWindow.requestAnimationFrame(()=>{const T=this.getScrollOffset(),f=this.getOffsetForIndex(r,w);if(!f){console.warn("Failed to get offset for index:",r);return}Gr(f[0],T)||c(w)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${r} after ${o} attempts.`))};l(n)},this.scrollBy=(r,{behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+r,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var r;const n=this.getMeasurements();let a;if(n.length===0)a=this.options.paddingStart;else if(this.options.lanes===1)a=((r=n[n.length-1])==null?void 0:r.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=n.length-1;for(;o>=0&&i.some(l=>l===null);){const l=n[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}a=Math.max(...i.filter(l=>l!==null))}return Math.max(a-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(r,{adjustments:n,behavior:a})=>{this.options.scrollToFn(r,{behavior:a,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(s)}}const os=(t,s,r,n)=>{for(;t<=s;){const a=(t+s)/2|0,i=r(a);if(i<n)t=a+1;else if(i>n)s=a-1;else return a}return t>0?t-1:0};function rn({measurements:t,outerSize:s,scrollOffset:r,lanes:n}){const a=t.length-1,i=c=>t[c].start;if(t.length<=n)return{startIndex:0,endIndex:a};let o=os(0,a,i,r),l=o;if(n===1)for(;l<a&&t[l].end<r+s;)l++;else if(n>1){const c=Array(n).fill(0);for(;l<a&&c.some(x=>x<r+s);){const x=t[l];c[x.lane]=x.end,l++}const d=Array(n).fill(r+s);for(;o>=0&&d.some(x=>x>=r);){const x=t[o];d[x.lane]=x.start,o--}o=Math.max(0,o-o%n),l=Math.min(a,l+(n-1-l%n))}return{startIndex:o,endIndex:l}}const Dt=typeof document<"u"?m.useLayoutEffect:m.useEffect;function nn(t){const s=m.useReducer(()=>({}),{})[1],r={...t,onChange:(a,i)=>{var o;i?Gt.flushSync(s):s(),(o=t.onChange)==null||o.call(t,a,i)}},[n]=m.useState(()=>new sn(r));return n.setOptions(r),Dt(()=>n._didMount(),[]),Dt(()=>n._willUpdate()),n}function ls(t){return nn({observeElementRect:Xr,observeElementOffset:Zr,scrollToFn:tn,...t})}const cs=6048e5,an=864e5,lt=6e4,ct=36e5,Ot=Symbol.for("constructDateFrom");function se(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&Ot in t?t[Ot](s):t instanceof Date?new t.constructor(s):new Date(s)}function te(t,s){return se(s||t,t)}function on(t,s,r){const n=te(t,r==null?void 0:r.in);return isNaN(s)?se(t,NaN):(n.setDate(n.getDate()+s),n)}let ln={};function qe(){return ln}function Ce(t,s){var l,c,d,x;const r=qe(),n=(s==null?void 0:s.weekStartsOn)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((x=(d=r.locale)==null?void 0:d.options)==null?void 0:x.weekStartsOn)??0,a=te(t,s==null?void 0:s.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Ae(t,s){return Ce(t,{...s,weekStartsOn:1})}function ds(t,s){const r=te(t,s==null?void 0:s.in),n=r.getFullYear(),a=se(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=Ae(a),o=se(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Ae(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function Rt(t){const s=te(t),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+t-+r}function dt(t,...s){const r=se.bind(null,s.find(n=>typeof n=="object"));return s.map(r)}function $e(t,s){const r=te(t,s==null?void 0:s.in);return r.setHours(0,0,0,0),r}function cn(t,s,r){const[n,a]=dt(r==null?void 0:r.in,t,s),i=$e(n),o=$e(a),l=+i-Rt(i),c=+o-Rt(o);return Math.round((l-c)/an)}function dn(t,s){const r=ds(t,s),n=se(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Ae(n)}function us(t){return se(t,Date.now())}function ms(t,s,r){const[n,a]=dt(r==null?void 0:r.in,t,s);return+$e(n)==+$e(a)}function un(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function mn(t){return!(!un(t)&&typeof t!="number"||isNaN(+te(t)))}function ut(t){return s=>{const r=Math.trunc,n=r(s);return n===0?0:n}}function xn(t,s,r){const[n,a]=dt(r==null?void 0:r.in,t,s),i=(+n-+a)/ct;return ut()(i)}function xs(t,s){return+te(t)-+te(s)}function hs(t,s,r){const n=xs(t,s)/lt;return ut()(n)}function hn(t,s,r){const n=xs(t,s)/1e3;return ut()(n)}function pn(t,s){const r=te(t,s==null?void 0:s.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const fn={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gn=(t,s,r)=>{let n;const a=fn[t];return typeof a=="string"?n=a:s===1?n=a.one:n=a.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Je(t){return(s={})=>{const r=s.width?String(s.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const bn={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yn={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vn={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jn={date:Je({formats:bn,defaultWidth:"full"}),time:Je({formats:yn,defaultWidth:"full"}),dateTime:Je({formats:vn,defaultWidth:"full"})},Nn={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},wn=(t,s,r,n)=>Nn[t];function we(t){return(s,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(s):s;return a[i]}}const kn={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Sn={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},En={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Tn={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Cn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Dn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},On=(t,s)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Rn={ordinalNumber:On,era:we({values:kn,defaultWidth:"wide"}),quarter:we({values:Sn,defaultWidth:"wide",argumentCallback:t=>t-1}),month:we({values:En,defaultWidth:"wide"}),day:we({values:Tn,defaultWidth:"wide"}),dayPeriod:we({values:Cn,defaultWidth:"wide",formattingValues:Dn,defaultFormattingWidth:"wide"})};function ke(t){return(s,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=s.match(a);if(!i)return null;const o=i[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Pn(l,h=>h.test(o)):In(l,h=>h.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const x=s.slice(o.length);return{value:d,rest:x}}}function In(t,s){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&s(t[r]))return r}function Pn(t,s){for(let r=0;r<t.length;r++)if(s(t[r]))return r}function Mn(t){return(s,r={})=>{const n=s.match(t.matchPattern);if(!n)return null;const a=n[0],i=s.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=s.slice(a.length);return{value:o,rest:l}}}const Fn=/^(\d+)(th|st|nd|rd)?/i,Ln=/\d+/i,_n={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},An={any:[/^b/i,/^(a|c)/i]},$n={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Bn={any:[/1/i,/2/i,/3/i,/4/i]},Hn={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Wn={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},zn={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Un={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},qn={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Yn={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Vn={ordinalNumber:Mn({matchPattern:Fn,parsePattern:Ln,valueCallback:t=>parseInt(t,10)}),era:ke({matchPatterns:_n,defaultMatchWidth:"wide",parsePatterns:An,defaultParseWidth:"any"}),quarter:ke({matchPatterns:$n,defaultMatchWidth:"wide",parsePatterns:Bn,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ke({matchPatterns:Hn,defaultMatchWidth:"wide",parsePatterns:Wn,defaultParseWidth:"any"}),day:ke({matchPatterns:zn,defaultMatchWidth:"wide",parsePatterns:Un,defaultParseWidth:"any"}),dayPeriod:ke({matchPatterns:qn,defaultMatchWidth:"any",parsePatterns:Yn,defaultParseWidth:"any"})},Gn={code:"en-US",formatDistance:gn,formatLong:jn,formatRelative:wn,localize:Rn,match:Vn,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Jn(t,s){const r=te(t,s==null?void 0:s.in);return cn(r,pn(r))+1}function Qn(t,s){const r=te(t,s==null?void 0:s.in),n=+Ae(r)-+dn(r);return Math.round(n/cs)+1}function ps(t,s){var x,h,w,T;const r=te(t,s==null?void 0:s.in),n=r.getFullYear(),a=qe(),i=(s==null?void 0:s.firstWeekContainsDate)??((h=(x=s==null?void 0:s.locale)==null?void 0:x.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((T=(w=a.locale)==null?void 0:w.options)==null?void 0:T.firstWeekContainsDate)??1,o=se((s==null?void 0:s.in)||t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=Ce(o,s),c=se((s==null?void 0:s.in)||t,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=Ce(c,s);return+r>=+l?n+1:+r>=+d?n:n-1}function Kn(t,s){var l,c,d,x;const r=qe(),n=(s==null?void 0:s.firstWeekContainsDate)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((x=(d=r.locale)==null?void 0:d.options)==null?void 0:x.firstWeekContainsDate)??1,a=ps(t,s),i=se((s==null?void 0:s.in)||t,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),Ce(i,s)}function Xn(t,s){const r=te(t,s==null?void 0:s.in),n=+Ce(r,s)-+Kn(r,s);return Math.round(n/cs)+1}function J(t,s){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(s,"0");return r+n}const le={y(t,s){const r=t.getFullYear(),n=r>0?r:1-r;return J(s==="yy"?n%100:n,s.length)},M(t,s){const r=t.getMonth();return s==="M"?String(r+1):J(r+1,2)},d(t,s){return J(t.getDate(),s.length)},a(t,s){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,s){return J(t.getHours()%12||12,s.length)},H(t,s){return J(t.getHours(),s.length)},m(t,s){return J(t.getMinutes(),s.length)},s(t,s){return J(t.getSeconds(),s.length)},S(t,s){const r=s.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return J(a,s.length)}},ye={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},It={G:function(t,s,r){const n=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,s,r){if(s==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return le.y(t,s)},Y:function(t,s,r,n){const a=ps(t,n),i=a>0?a:1-a;if(s==="YY"){const o=i%100;return J(o,2)}return s==="Yo"?r.ordinalNumber(i,{unit:"year"}):J(i,s.length)},R:function(t,s){const r=ds(t);return J(r,s.length)},u:function(t,s){const r=t.getFullYear();return J(r,s.length)},Q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(n);case"QQ":return J(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(n);case"qq":return J(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,s,r){const n=t.getMonth();switch(s){case"M":case"MM":return le.M(t,s);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,s,r){const n=t.getMonth();switch(s){case"L":return String(n+1);case"LL":return J(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,s,r,n){const a=Xn(t,n);return s==="wo"?r.ordinalNumber(a,{unit:"week"}):J(a,s.length)},I:function(t,s,r){const n=Qn(t);return s==="Io"?r.ordinalNumber(n,{unit:"week"}):J(n,s.length)},d:function(t,s,r){return s==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):le.d(t,s)},D:function(t,s,r){const n=Jn(t);return s==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):J(n,s.length)},E:function(t,s,r){const n=t.getDay();switch(s){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,s,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return J(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,s,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return J(i,s.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,s,r){const n=t.getDay(),a=n===0?7:n;switch(s){case"i":return String(a);case"ii":return J(a,s.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,s,r){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,s,r){const n=t.getHours();let a;switch(n===12?a=ye.noon:n===0?a=ye.midnight:a=n/12>=1?"pm":"am",s){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,s,r){const n=t.getHours();let a;switch(n>=17?a=ye.evening:n>=12?a=ye.afternoon:n>=4?a=ye.morning:a=ye.night,s){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,s,r){if(s==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return le.h(t,s)},H:function(t,s,r){return s==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):le.H(t,s)},K:function(t,s,r){const n=t.getHours()%12;return s==="Ko"?r.ordinalNumber(n,{unit:"hour"}):J(n,s.length)},k:function(t,s,r){let n=t.getHours();return n===0&&(n=24),s==="ko"?r.ordinalNumber(n,{unit:"hour"}):J(n,s.length)},m:function(t,s,r){return s==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):le.m(t,s)},s:function(t,s,r){return s==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):le.s(t,s)},S:function(t,s){return le.S(t,s)},X:function(t,s,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(s){case"X":return Mt(n);case"XXXX":case"XX":return he(n);case"XXXXX":case"XXX":default:return he(n,":")}},x:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"x":return Mt(n);case"xxxx":case"xx":return he(n);case"xxxxx":case"xxx":default:return he(n,":")}},O:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Pt(n,":");case"OOOO":default:return"GMT"+he(n,":")}},z:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Pt(n,":");case"zzzz":default:return"GMT"+he(n,":")}},t:function(t,s,r){const n=Math.trunc(+t/1e3);return J(n,s.length)},T:function(t,s,r){return J(+t,s.length)}};function Pt(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+s+J(i,2)}function Mt(t,s){return t%60===0?(t>0?"-":"+")+J(Math.abs(t)/60,2):he(t,s)}function he(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=J(Math.trunc(n/60),2),i=J(n%60,2);return r+a+s+i}const Ft=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},fs=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},Zn=(t,s)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Ft(t,s);let i;switch(n){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",Ft(n,s)).replace("{{time}}",fs(a,s))},ea={p:fs,P:Zn},ta=/^D+$/,sa=/^Y+$/,ra=["D","DD","YY","YYYY"];function na(t){return ta.test(t)}function aa(t){return sa.test(t)}function ia(t,s,r){const n=oa(t,s,r);if(console.warn(n),ra.includes(t))throw new RangeError(n)}function oa(t,s,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const la=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ca=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,da=/^'([^]*?)'?$/,ua=/''/g,ma=/[a-zA-Z]/;function je(t,s,r){var x,h,w,T;const n=qe(),a=n.locale??Gn,i=n.firstWeekContainsDate??((h=(x=n.locale)==null?void 0:x.options)==null?void 0:h.firstWeekContainsDate)??1,o=n.weekStartsOn??((T=(w=n.locale)==null?void 0:w.options)==null?void 0:T.weekStartsOn)??0,l=te(t,r==null?void 0:r.in);if(!mn(l))throw new RangeError("Invalid time value");let c=s.match(ca).map(f=>{const y=f[0];if(y==="p"||y==="P"){const R=ea[y];return R(f,a.formatLong)}return f}).join("").match(la).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const y=f[0];if(y==="'")return{isToken:!1,value:xa(f)};if(It[y])return{isToken:!0,value:f};if(y.match(ma))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:f}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(f=>{if(!f.isToken)return f.value;const y=f.value;(aa(y)||na(y))&&ia(y,s,String(t));const R=It[y[0]];return R(l,y,a.localize,d)}).join("")}function xa(t){const s=t.match(da);return s?s[1].replace(ua,"'"):t}function gs(t,s){return ms(se(t,t),us(t))}function ha(t,s,r){return on(t,-1,r)}function bs(t,s){return ms(se(t,t),ha(us(t)))}function ys(t,s){const r=()=>se(s==null?void 0:s.in,NaN),a=ba(t);let i;if(a.date){const d=ya(a.date,2);i=va(d.restDateString,d.year)}if(!i||isNaN(+i))return r();const o=+i;let l=0,c;if(a.time&&(l=ja(a.time),isNaN(l)))return r();if(a.timezone){if(c=Na(a.timezone),isNaN(c))return r()}else{const d=new Date(o+l),x=te(0,s==null?void 0:s.in);return x.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),x.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),x}return te(o+l+c,s==null?void 0:s.in)}const Pe={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},pa=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,fa=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ga=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ba(t){const s={},r=t.split(Pe.dateTimeDelimiter);let n;if(r.length>2)return s;if(/:/.test(r[0])?n=r[0]:(s.date=r[0],n=r[1],Pe.timeZoneDelimiter.test(s.date)&&(s.date=t.split(Pe.timeZoneDelimiter)[0],n=t.substr(s.date.length,t.length))),n){const a=Pe.timezone.exec(n);a?(s.time=n.replace(a[1],""),s.timezone=a[1]):s.time=n}return s}function ya(t,s){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),n=t.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((n[1]||n[2]).length)}}function va(t,s){if(s===null)return new Date(NaN);const r=t.match(pa);if(!r)return new Date(NaN);const n=!!r[4],a=Se(r[1]),i=Se(r[2])-1,o=Se(r[3]),l=Se(r[4]),c=Se(r[5])-1;if(n)return Ta(s,l,c)?wa(s,l,c):new Date(NaN);{const d=new Date(0);return!Sa(s,i,o)||!Ea(s,a)?new Date(NaN):(d.setUTCFullYear(s,i,Math.max(a,o)),d)}}function Se(t){return t?parseInt(t):1}function ja(t){const s=t.match(fa);if(!s)return NaN;const r=Qe(s[1]),n=Qe(s[2]),a=Qe(s[3]);return Ca(r,n,a)?r*ct+n*lt+a*1e3:NaN}function Qe(t){return t&&parseFloat(t.replace(",","."))||0}function Na(t){if(t==="Z")return 0;const s=t.match(ga);if(!s)return 0;const r=s[1]==="+"?-1:1,n=parseInt(s[2]),a=s[3]&&parseInt(s[3])||0;return Da(n,a)?r*(n*ct+a*lt):NaN}function wa(t,s,r){const n=new Date(0);n.setUTCFullYear(t,0,4);const a=n.getUTCDay()||7,i=(s-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const ka=[31,null,31,30,31,30,31,31,30,31,30,31];function vs(t){return t%400===0||t%4===0&&t%100!==0}function Sa(t,s,r){return s>=0&&s<=11&&r>=1&&r<=(ka[s]||(vs(t)?29:28))}function Ea(t,s){return s>=1&&s<=(vs(t)?366:365)}function Ta(t,s,r){return s>=1&&s<=53&&r>=0&&r<=6}function Ca(t,s,r){return t===24?s===0&&r===0:r>=0&&r<60&&s>=0&&s<60&&t>=0&&t<25}function Da(t,s){return s>=0&&s<=59}function js(t){try{const s=typeof t=="string"?ys(t):new Date(t),r=new Date,n=hn(r,s),a=hs(r,s),i=xn(r,s);return n<5?"åˆšåˆš":n<60?`${n} ç§’å‰`:a<60?`${a} åˆ†é’Ÿå‰`:i<24?`${i} å°æ—¶å‰`:gs(s)?`ä»Šå¤© ${je(s,"HH:mm")}`:bs(s)?`æ˜¨å¤© ${je(s,"HH:mm")}`:je(s,"MM-dd HH:mm")}catch{return t}}function oe(t){try{const s=typeof t=="string"?ys(t):new Date(t);return hs(new Date,s)<5?js(t):gs(s)?je(s,"HH:mm:ss"):bs(s)?`æ˜¨å¤© ${je(s,"HH:mm")}`:je(s,"MM/dd HH:mm")}catch{return t}}function Ns(t){if(t==null)return"text-text-muted";const s=t*1e3;return s<100?"text-green-400":s<500?"text-green-300":s<1e3?"text-yellow-400":s<3e3?"text-orange-400":"text-red-400"}function De(t,s){let r;if(t instanceof Date&&s instanceof Date)r=s.getTime()-t.getTime();else if(typeof t=="number"){if(t===null)return"-";r=t*1e3}else return"-";if(r<0)return"-";if(r<1)return`${Math.round(r*1e3)}Âµs`;if(r<1e3)return`${Math.round(r)}ms`;if(r<6e4)return`${(r/1e3).toFixed(1)}s`;if(r<36e5){const i=Math.floor(r/6e4),o=Math.floor(r%6e4/1e3);return`${i}m ${o}s`}const n=Math.floor(r/36e5),a=Math.floor(r%36e5/6e4);return`${n}h ${a}m`}function Be(t){if(t===0)return"0 B";if(t<0)return"-";const s=1024,r=["B","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,n)).toFixed(2))+" "+r[n]}function Oa(t,s=60){try{const r=new URL(t),n=r.pathname+r.search;return n.length>s?n.substring(0,s)+"...":n}catch{return t.length>s?t.substring(0,s)+"...":t}}function mt(t){try{return new URL(t).hostname}catch{return t}}function xt(t){return t?t>=200&&t<300?"bg-green-500/15 text-green-400 border border-green-500/30":t>=300&&t<400?"bg-blue-500/15 text-blue-400 border border-blue-500/30":t>=400&&t<500?"bg-yellow-500/15 text-yellow-400 border border-yellow-500/30":"bg-red-500/15 text-red-400 border border-red-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}function ht(t){return{GET:"bg-method-get/20 text-method-get border border-method-get/30",POST:"bg-method-post/20 text-method-post border border-method-post/30",PUT:"bg-method-put/20 text-method-put border border-method-put/30",DELETE:"bg-method-delete/20 text-method-delete border border-method-delete/30",PATCH:"bg-method-patch/20 text-method-patch border border-method-patch/30"}[t.toUpperCase()]||"bg-gray-500/20 text-gray-400 border border-gray-500/30"}function Lt(t){try{return atob(t)}catch{return t}}function Ra(t){const s={verbose:{color:"text-level-verbose",bg:"bg-level-verbose/10",border:"border-l-level-verbose"},debug:{color:"text-level-debug",bg:"bg-level-debug/10",border:"border-l-level-debug"},info:{color:"text-level-info",bg:"bg-level-info/10",border:"border-l-level-info"},warning:{color:"text-level-warning",bg:"bg-level-warning/10",border:"border-l-level-warning"},error:{color:"text-level-error",bg:"bg-level-error/10",border:"border-l-level-error"}};return s[t.toLowerCase()]||s.debug}const Ia=56;function _t(t,s){return s.find(r=>{if(!r.isEnabled)return!1;if(r.matchType==="domain")try{const n=new URL(t.url);return n.hostname===r.matchValue||n.hostname.endsWith("."+r.matchValue)}catch{return!1}if(r.matchType==="urlRegex")try{return new RegExp(r.matchValue).test(t.url)}catch{return!1}return!1})}function Pa({items:t,selectedId:s,onSelect:r,autoScroll:n,deviceId:a,isSelectMode:i=!1,selectedIds:o=new Set,onToggleSelect:l}){const c=m.useRef(null),d=m.useRef(null),{deviceRules:x,rules:h,fetchDeviceRules:w,fetchRules:T}=Oe();m.useEffect(()=>{a?w(a):T()},[a,w,T]);const f=m.useMemo(()=>a?x:h,[a,x,h]),y=m.useMemo(()=>t.filter(b=>!nt(b)),[t]),R=m.useMemo(()=>f.length===0?y:y.filter(b=>{const $=_t(b,f);return!$||$.action!=="hide"}),[y,f]),C=ls({count:R.length,getScrollElement:()=>c.current,estimateSize:()=>Ia,overscan:10}),k=C.getVirtualItems();m.useEffect(()=>{const b=R[0],$=(b==null?void 0:b.id)??null,Y=$!==null&&$!==d.current;n&&Y&&C.scrollToIndex(0,{align:"start",behavior:"smooth"}),d.current=$},[R,n,C]);const O=m.useCallback((b,$)=>{i&&l?($.preventDefault(),l(b.id)):r(b.id)},[i,l,r]),B=(b,$)=>{const Y=!b.statusCode||b.statusCode>=400,W=b.id===s,G=o.has(b.id),j=_t(b,f),F=(j==null?void 0:j.action)==="highlight",z=(j==null?void 0:j.action)==="mark",D=j==null?void 0:j.color,S=z&&D&&!W?{...$,borderLeftColor:D}:$;return e.jsxs("div",{style:S,onClick:u=>O(b,u),className:g("flex items-center cursor-pointer transition-all duration-150 group border-b border-border-light",Y&&!W&&!F&&"bg-red-500/5 hover:bg-red-500/10",W&&"bg-primary text-bg-darkest shadow-sm shadow-primary/20",G&&!W&&"bg-primary/15",F&&!W&&"bg-yellow-500/10 hover:bg-yellow-500/20 border-l-4 border-l-yellow-500",z&&!W&&!F&&"border-l-4",!W&&!G&&!Y&&!F&&!z&&"hover:bg-bg-light/60"),children:[(F||z)&&!W&&e.jsxs("div",{className:"w-6 flex-shrink-0 flex items-center justify-center",children:[F&&e.jsx("span",{className:"text-yellow-500 text-xs",children:"â­"}),z&&!F&&e.jsx("span",{className:"text-xs",style:{color:D||"currentColor"},children:"ğŸ·ï¸"})]}),i&&e.jsx("div",{className:"px-3 py-3.5 w-10 flex-shrink-0",onClick:u=>u.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:G,onChange:()=>l==null?void 0:l(b.id),className:"w-4 h-4 rounded border-border cursor-pointer accent-primary"})}),e.jsx("div",{className:g("px-4 py-3.5 w-[100px] flex-shrink-0",W?"text-bg-darkest/80":"text-text-muted"),children:e.jsx("span",{className:"text-sm font-mono",children:oe(b.startTime)})}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0",children:e.jsx("span",{className:g("inline-flex items-center justify-center px-3 py-1.5 rounded-lg text-xs font-mono font-bold min-w-[60px] shadow-sm",W?"bg-bg-darkest/20 text-bg-darkest":ht(b.method)),children:b.method})}),e.jsx("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0",children:e.jsx("span",{className:g("inline-flex items-center justify-center px-3 py-1.5 rounded-lg text-xs font-mono font-semibold min-w-[44px] shadow-sm",W?"bg-bg-darkest/20 text-bg-darkest":xt(b.statusCode)),children:b.statusCode??"ERR"})}),e.jsx("div",{className:"px-4 py-3.5 flex-1 min-w-0 overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:g("text-sm truncate transition-colors",W?"text-bg-darkest":"text-text-primary group-hover:text-primary"),title:b.url,children:Oa(b.url)}),e.jsx("span",{className:g("text-xs truncate font-mono",W?"text-bg-darkest/70":"text-text-muted opacity-70"),children:mt(b.url)})]})}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0",children:e.jsx("span",{className:g("text-sm font-mono font-medium",W?"text-bg-darkest":Ns(b.duration)),children:De(b.duration)})}),e.jsxs("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0 flex items-center justify-center gap-2",children:[b.isMocked&&e.jsx("span",{className:"inline-flex items-center justify-center w-7 h-7 rounded-lg bg-purple-500/15 text-purple-400 shadow-sm shadow-purple-500/10",title:"å·² Mock",children:"ğŸ­"}),b.isFavorite&&e.jsx("span",{className:"badge-favorite text-base",title:"å·²æ”¶è—",children:"â˜…"}),!b.isMocked&&!b.isFavorite&&e.jsx("span",{className:"w-7 h-7"})]})]},b.id)};return e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center bg-bg-medium border-b border-border text-text-secondary sticky top-0 z-10",children:[i&&e.jsx("div",{className:"px-3 py-3.5 w-10 flex-shrink-0",children:e.jsx("span",{className:"sr-only",children:"é€‰æ‹©"})}),e.jsx("div",{className:"px-4 py-3.5 w-[100px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"æ—¶é—´"}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"æ–¹æ³•"}),e.jsx("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"çŠ¶æ€"}),e.jsx("div",{className:"px-4 py-3.5 flex-1 font-semibold text-xs uppercase tracking-wider",children:"URL / åŸŸå"}),e.jsx("div",{className:"px-4 py-3.5 w-[90px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider",children:"è€—æ—¶"}),e.jsx("div",{className:"px-4 py-3.5 w-[80px] flex-shrink-0 font-semibold text-xs uppercase tracking-wider text-center",children:"æ ‡è®°"})]}),e.jsx("div",{ref:c,className:"flex-1 overflow-auto",children:R.length>0?e.jsx("div",{style:{height:`${C.getTotalSize()}px`,width:"100%",position:"relative"},children:k.map(b=>{const $=R[b.index];return B($,{position:"absolute",top:0,left:0,width:"100%",height:`${b.size}px`,transform:`translateY(${b.start}px)`})})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-20",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-bg-light flex items-center justify-center mb-4 border border-border",children:e.jsx("span",{className:"text-3xl opacity-60",children:"ğŸŒ"})}),e.jsx("p",{className:"text-sm font-medium text-text-secondary mb-1",children:"æš‚æ—  HTTP è¯·æ±‚"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç­‰å¾…ç½‘ç»œè¯·æ±‚è¢«æ•è·..."})]})})]})}function At(t,s){return s.find(r=>{if(!r.isEnabled)return!1;if(r.matchType==="domain")try{const n=new URL(t.url);return n.hostname===r.matchValue||n.hostname.endsWith("."+r.matchValue)}catch{return!1}if(r.matchType==="urlRegex")try{return new RegExp(r.matchValue).test(t.url)}catch{return!1}return!1})}function Ma(t){const s=new Map;for(const r of t){const n=mt(r.url)||"unknown";s.has(n)||s.set(n,[]),s.get(n).push(r)}return s}function Fa(t){const s=new Map;for(const r of t)try{const n=new URL(r.url),a=n.pathname.split("/").filter(Boolean),i=a.length>0?`${n.hostname}/${a.slice(0,2).join("/")}`:n.hostname;s.has(i)||s.set(i,[]),s.get(i).push(r)}catch{const n="invalid-url";s.has(n)||s.set(n,[]),s.get(n).push(r)}return s}function La(t,s,r){if(s==="none")return[];const n=s==="domain"?Ma(t):Fa(t),a=[];for(const[i,o]of n){const l=o.filter(c=>c.duration!==null).map(c=>c.duration);a.push({key:i,label:i,count:o.length,events:o,expanded:r.has(i),avgDuration:l.length>0?l.reduce((c,d)=>c+d,0)/l.length:0,errorCount:o.filter(c=>!c.statusCode||c.statusCode>=400).length,mockedCount:o.filter(c=>c.isMocked).length})}return a.sort((i,o)=>o.count-i.count),a}function _a(t){const s=[];for(let r=0;r<t.length;r++){const n=t[r];if(s.push({type:"group-header",group:n,index:r}),n.expanded)for(const a of n.events)s.push({type:"event",event:a,groupKey:n.key})}return s}const Aa=48,$a=56;function Ba({events:t,groupMode:s,selectedId:r,onSelect:n,deviceId:a,isSelectMode:i=!1,selectedIds:o=new Set,onToggleSelect:l}){const c=m.useRef(null),[d,x]=m.useState(new Set),{deviceRules:h,rules:w,fetchDeviceRules:T,fetchRules:f}=Oe();m.useEffect(()=>{a?T(a):f()},[a,T,f]);const y=m.useMemo(()=>a?h:w,[a,h,w]),R=m.useMemo(()=>y.length===0?t:t.filter(j=>{const F=At(j,y);return!F||F.action!=="hide"}),[t,y]),C=m.useMemo(()=>La(R,s,d),[R,s,d]),k=m.useMemo(()=>_a(C),[C]),O=ls({count:k.length,getScrollElement:()=>c.current,estimateSize:j=>k[j].type==="group-header"?Aa:$a,overscan:10}),B=m.useCallback(j=>{x(F=>{const z=new Set(F);return z.has(j)?z.delete(j):z.add(j),z})},[]),b=m.useCallback(()=>{x(new Set(C.map(j=>j.key)))},[C]),$=m.useCallback(()=>{x(new Set)},[]);if(s==="none")return null;const Y=(j,F)=>{i&&l?(F.preventDefault(),l(j.id)):n(j.id)},W=(j,F)=>e.jsxs("div",{style:F,className:"flex items-center px-4 py-2 bg-bg-light border-b border-border cursor-pointer hover:bg-bg-lighter",onClick:()=>B(j.key),children:[e.jsx("span",{className:"text-lg mr-2",children:j.expanded?"â–¼":"â–¶"}),e.jsx("span",{className:"font-medium text-text-primary flex-1 truncate",children:j.label}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:"px-2 py-1 bg-bg-medium rounded text-text-secondary",children:[j.count," è¯·æ±‚"]}),e.jsxs("span",{className:"px-2 py-1 bg-bg-medium rounded text-text-muted",children:["å¹³å‡ ",De(j.avgDuration)]}),j.errorCount>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 rounded text-red-400",children:[j.errorCount," é”™è¯¯"]}),j.mockedCount>0&&e.jsxs("span",{className:"px-2 py-1 bg-purple-500/20 rounded text-purple-400",children:[j.mockedCount," Mock"]})]})]},`group-${j.key}`),G=(j,F)=>{const z=!j.statusCode||j.statusCode>=400,D=j.id===r,S=o.has(j.id),u=At(j,y),N=(u==null?void 0:u.action)==="highlight",p=(u==null?void 0:u.action)==="mark",E=u==null?void 0:u.color;return e.jsxs("div",{style:p&&E&&!D?{...F,borderLeftColor:E}:F,onClick:v=>Y(j,v),className:g("flex items-center cursor-pointer transition-all duration-150 group border-b border-border-light pl-8",z&&!D&&!N&&"bg-red-500/5 hover:bg-red-500/10",D&&"bg-primary text-bg-darkest shadow-sm shadow-primary/20",S&&!D&&"bg-primary/15",N&&!D&&"bg-yellow-500/10 hover:bg-yellow-500/20 border-l-4 border-l-yellow-500",p&&!D&&!N&&"border-l-4",!D&&!S&&!z&&!N&&!p&&"hover:bg-bg-light/60"),children:[(N||p)&&!D&&e.jsxs("div",{className:"w-6 flex-shrink-0 flex items-center justify-center -ml-6",children:[N&&e.jsx("span",{className:"text-yellow-500 text-xs",children:"â­"}),p&&!N&&e.jsx("span",{className:"text-xs",style:{color:E||"currentColor"},children:"ğŸ·ï¸"})]}),i&&e.jsx("div",{className:"px-3 py-3.5 w-10 flex-shrink-0",onClick:v=>v.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:S,onChange:()=>l==null?void 0:l(j.id),className:"w-4 h-4 rounded border-border cursor-pointer accent-primary"})}),e.jsx("div",{className:g("px-3 py-3.5 w-[90px] flex-shrink-0",D?"text-bg-darkest/80":"text-text-muted"),children:e.jsx("span",{className:"text-sm font-mono",children:oe(j.startTime)})}),e.jsx("div",{className:"px-3 py-3.5 w-[80px] flex-shrink-0",children:e.jsx("span",{className:g("inline-flex items-center justify-center px-2 py-1 rounded-lg text-xs font-mono font-bold min-w-[50px] shadow-sm",D?"bg-bg-darkest/20 text-bg-darkest":ht(j.method)),children:j.method})}),e.jsx("div",{className:"px-3 py-3.5 w-[70px] flex-shrink-0",children:e.jsx("span",{className:g("inline-flex items-center justify-center px-2 py-1 rounded-lg text-xs font-mono font-semibold min-w-[40px] shadow-sm",D?"bg-bg-darkest/20 text-bg-darkest":xt(j.statusCode)),children:j.statusCode??"ERR"})}),e.jsx("div",{className:"px-3 py-3.5 flex-1 min-w-0 overflow-hidden",children:e.jsx("span",{className:g("text-sm truncate",D?"text-bg-darkest":"text-text-primary"),title:j.url,children:(()=>{try{return new URL(j.url).pathname}catch{return j.url}})()})}),e.jsx("div",{className:"px-3 py-3.5 w-[80px] flex-shrink-0",children:e.jsx("span",{className:g("text-sm font-mono font-medium",D?"text-bg-darkest":Ns(j.duration)),children:De(j.duration)})}),e.jsxs("div",{className:"px-3 py-3.5 w-[60px] flex-shrink-0 flex items-center justify-center gap-1",children:[j.isMocked&&e.jsx("span",{className:"text-sm",title:"å·² Mock",children:"ğŸ­"}),j.isFavorite&&e.jsx("span",{className:"text-sm text-accent-yellow",title:"å·²æ”¶è—",children:"â˜…"})]})]},j.id)};return e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-bg-medium border-b border-border",children:[e.jsxs("span",{className:"text-sm text-text-secondary",children:[C.length," ä¸ªåˆ†ç»„ï¼Œ",t.length," ä¸ªè¯·æ±‚"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:b,className:"px-2 py-1 text-xs text-text-muted hover:text-text-secondary hover:bg-bg-light rounded",children:"å±•å¼€å…¨éƒ¨"}),e.jsx("button",{onClick:$,className:"px-2 py-1 text-xs text-text-muted hover:text-text-secondary hover:bg-bg-light rounded",children:"æ”¶èµ·å…¨éƒ¨"})]})]}),e.jsx("div",{ref:c,className:"flex-1 overflow-auto",children:k.length>0?e.jsx("div",{style:{height:`${O.getTotalSize()}px`,width:"100%",position:"relative"},children:O.getVirtualItems().map(j=>{const F=k[j.index],z={position:"absolute",top:0,left:0,width:"100%",height:`${j.size}px`,transform:`translateY(${j.start}px)`};return F.type==="group-header"?W(F.group,z):G(F.event,z)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-20",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-bg-light flex items-center justify-center mb-4 border border-border",children:e.jsx("span",{className:"text-3xl opacity-60",children:"ğŸŒ"})}),e.jsx("p",{className:"text-sm font-medium text-text-secondary mb-1",children:"æš‚æ—  HTTP è¯·æ±‚"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç­‰å¾…ç½‘ç»œè¯·æ±‚è¢«æ•è·..."})]})})]})}function ws({data:t,initialExpanded:s=!0,maxInitialDepth:r=2}){return e.jsx("div",{className:"font-mono text-xs",children:e.jsx(ks,{value:t,depth:0,initialExpanded:s,maxInitialDepth:r})})}function ks({keyName:t,value:s,depth:r,initialExpanded:n,maxInitialDepth:a,isLast:i=!0}){const o=n&&r<a,[l,c]=m.useState(o),d=m.useMemo(()=>s===null?"null":Array.isArray(s)?"array":typeof s,[s]),x=d==="object"||d==="array",h=x&&(d==="array"?s.length===0:Object.keys(s).length===0),w=()=>{switch(d){case"string":return e.jsxs("span",{className:"text-emerald-400",children:['"',String(s),'"']});case"number":return e.jsx("span",{className:"text-amber-400",children:String(s)});case"boolean":return e.jsx("span",{className:"text-purple-400",children:String(s)});case"null":return e.jsx("span",{className:"text-gray-500",children:"null"});case"undefined":return e.jsx("span",{className:"text-gray-500",children:"undefined"});default:return null}},T=()=>{const f=d==="array"?s.map((C,k)=>[String(k),C]):Object.entries(s),y=d==="array"?["[","]"]:["{","}"],R=d==="array"?`Array(${s.length})`:`Object(${Object.keys(s).length})`;return h?e.jsxs("span",{className:"text-gray-500",children:[y[0],y[1]]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>c(!l),className:"inline-flex items-center hover:bg-bg-light rounded px-0.5 -ml-0.5",children:[e.jsx("span",{className:"w-4 text-center text-gray-500",children:l?"â–¼":"â–¶"}),!l&&e.jsx("span",{className:"text-gray-500 ml-1",children:R})]}),l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:y[0]}),e.jsx("div",{className:"pl-4 border-l border-border ml-1",children:f.map(([C,k],O)=>e.jsx(ks,{keyName:d==="array"?void 0:C,value:k,depth:r+1,initialExpanded:n,maxInitialDepth:a,isLast:O===f.length-1},C))}),e.jsx("span",{className:"text-gray-400",children:y[1]})]}):null]})};return e.jsxs("div",{className:g("leading-relaxed",!i&&"mb-0.5"),children:[t!==void 0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sky-400",children:t}),e.jsx("span",{className:"text-gray-500",children:": "})]}),x?T():w(),!i&&!l&&e.jsx("span",{className:"text-gray-500",children:","})]})}function $t({content:t,className:s}){const[r,n]=m.useState("tree"),a=m.useMemo(()=>{try{return JSON.parse(t)}catch{return null}},[t]);return a!==null?e.jsxs("div",{className:s,children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("button",{onClick:()=>n("tree"),className:g("px-2 py-1 text-xs rounded",r==="tree"?"bg-primary text-white":"bg-bg-light text-text-muted hover:bg-bg-lighter"),children:"æ ‘å½¢"}),e.jsx("button",{onClick:()=>n("raw"),className:g("px-2 py-1 text-xs rounded",r==="raw"?"bg-primary text-white":"bg-bg-light text-text-muted hover:bg-bg-lighter"),children:"åŸå§‹"})]}),r==="tree"?e.jsx("div",{className:"bg-bg-dark p-3 rounded overflow-x-auto max-h-96 overflow-y-auto",children:e.jsx(ws,{data:a})}):e.jsx("pre",{className:"text-xs font-mono bg-bg-dark p-3 rounded overflow-x-auto whitespace-pre-wrap break-all max-h-96 overflow-y-auto",children:JSON.stringify(a,null,2)})]}):e.jsx("pre",{className:g("text-xs font-mono whitespace-pre-wrap break-all",s),children:t})}function Ha({timing:t,totalDuration:s}){const r=[{label:"DNS",value:t.dnsLookup,color:"bg-cyan-500",description:"DNS è§£æ"},{label:"TCP",value:t.tcpConnection,color:"bg-green-500",description:"TCP è¿æ¥"},{label:"TLS",value:t.tlsHandshake,color:"bg-purple-500",description:"TLS æ¡æ‰‹"},{label:"TTFB",value:t.timeToFirstByte,color:"bg-amber-500",description:"é¦–å­—èŠ‚æ—¶é—´"},{label:"Download",value:t.contentDownload,color:"bg-blue-500",description:"å†…å®¹ä¸‹è½½"}],n=r.reduce((l,c)=>l+(c.value||0),0),a=s||n||1,i=l=>{if(l==null)return"-";const c=l*1e3;return c<1?`${Math.round(c*1e3)}Âµs`:c<1e3?`${Math.round(c)}ms`:`${(c/1e3).toFixed(2)}s`},o=l=>l==null?0:l/a*100;return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:r.map(l=>{const c=o(l.value);return l.value===null?null:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-xs text-text-muted shrink-0",children:l.label}),e.jsxs("div",{className:"flex-1 h-5 bg-bg-dark rounded overflow-hidden relative",children:[e.jsx("div",{className:`h-full ${l.color} transition-all duration-300`,style:{width:`${Math.max(c,1)}%`}}),e.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs font-mono",children:i(l.value)})]}),e.jsxs("div",{className:"w-12 text-xs text-text-muted text-right shrink-0",children:[c.toFixed(1),"%"]})]},l.label)})}),e.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-border",children:[e.jsx("div",{className:"w-16 text-xs font-medium shrink-0",children:"Total"}),e.jsx("div",{className:"flex-1 text-xs font-mono text-primary",children:i(a)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t border-border text-xs",children:[t.protocolName&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"åè®®:"})," ",e.jsx("span",{className:"font-mono text-primary",children:t.protocolName})]}),t.connectionReused!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"è¿æ¥å¤ç”¨:"})," ",e.jsx("span",{className:t.connectionReused?"text-green-400":"text-yellow-400",children:t.connectionReused?"æ˜¯":"å¦"})]}),t.localAddress&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"æœ¬åœ°åœ°å€:"})," ",e.jsx("span",{className:"font-mono",children:t.localAddress})]}),t.remoteAddress&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"è¿œç¨‹åœ°å€:"})," ",e.jsx("span",{className:"font-mono",children:t.remoteAddress})]}),t.requestBodyBytesSent!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"å‘é€:"})," ",e.jsx("span",{className:"font-mono",children:Be(t.requestBodyBytesSent)})]}),t.responseBodyBytesReceived!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"æ¥æ”¶:"})," ",e.jsx("span",{className:"font-mono",children:Be(t.responseBodyBytesReceived)})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3 pt-2 border-t border-border",children:r.map(l=>e.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[e.jsx("div",{className:`w-3 h-3 rounded ${l.color}`}),e.jsx("span",{className:"text-text-muted",children:l.description})]},l.label))})]})}function Wa({base64Data:t,contentType:s,className:r=""}){const[n,a]=m.useState(!1),[i,o]=m.useState(!1),l=m.useMemo(()=>{const c=Ua(s);return c?`data:${c};base64,${t}`:null},[t,s]);return!l||i?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`relative ${r}`,children:[e.jsx("img",{src:l,alt:"Response preview",className:"image-preview cursor-pointer",onClick:()=>a(!0),onError:()=>o(!0)}),e.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[e.jsx("button",{onClick:()=>a(!0),className:"p-1.5 bg-bg-dark/80 rounded-lg hover:bg-bg-dark transition-colors",title:"å…¨å±é¢„è§ˆ",children:e.jsx(qa,{className:"w-4 h-4"})}),e.jsx("a",{href:l,download:"response-image",className:"p-1.5 bg-bg-dark/80 rounded-lg hover:bg-bg-dark transition-colors",title:"ä¸‹è½½å›¾ç‰‡",children:e.jsx(Ya,{className:"w-4 h-4"})})]})]}),n&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",onClick:()=>a(!1),children:[e.jsx("button",{className:"absolute top-4 right-4 p-2 text-white/70 hover:text-white transition-colors",onClick:()=>a(!1),children:e.jsx(Va,{className:"w-6 h-6"})}),e.jsx("img",{src:l,alt:"Response preview fullscreen",className:"max-w-[90vw] max-h-[90vh] object-contain",onClick:c=>c.stopPropagation()})]})]})}function za(t){if(!t)return!1;const s=t.toLowerCase();return s.startsWith("image/")||s.includes("image/png")||s.includes("image/jpeg")||s.includes("image/gif")||s.includes("image/webp")||s.includes("image/svg+xml")||s.includes("image/bmp")||s.includes("image/ico")}function Ua(t){if(!t)return null;const s=t.split(";")[0].trim().toLowerCase();return["image/png","image/jpeg","image/jpg","image/gif","image/webp","image/svg+xml","image/bmp","image/x-icon","image/ico"].some(n=>s.includes(n)||s===n)||s.startsWith("image/")?s:null}function qa({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}function Ya({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}function Va({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function Bt(t){if(!t)return!1;const s=t.toLowerCase();return s.includes("application/x-protobuf")||s.includes("application/protobuf")||s.includes("application/grpc")||s.includes("application/grpc+proto")||s.includes("application/octet-stream")}function Ht(t){const s=atob(t),r=new Uint8Array(s.length);for(let n=0;n<s.length;n++)r[n]=s.charCodeAt(n);return r}function Ke(t,s){let r=0n,n=0n,a=0;for(;s+a<t.length;){const i=t[s+a];if(r|=BigInt(i&127)<<n,a++,!(i&128))break;if(n+=7n,a>10)throw new Error("Varint too long")}return{value:r,bytesRead:a}}function Ss(t){const s=[],r=[];let n=0;for(;n<t.length;)try{const a=n,{value:i,bytesRead:o}=Ke(t,n);n+=o;const l=Number(i>>3n),c=Number(i&0x7n);if(l===0){r.push(`Invalid field number 0 at offset ${a}`);break}let d,x;switch(c){case 0:{const{value:h,bytesRead:w}=Ke(t,n);d=h,n+=w,x=n-a;break}case 1:{if(n+8>t.length)throw new Error("Unexpected end of data for Fixed64");d=new DataView(t.buffer,t.byteOffset+n,8).getBigUint64(0,!0),n+=8,x=n-a;break}case 2:{const{value:h,bytesRead:w}=Ke(t,n);n+=w;const T=Number(h);if(n+T>t.length)throw new Error(`Length-delimited field extends beyond data: ${T} bytes at offset ${n}`);const f=t.slice(n,n+T);d=Ga(f),n+=T,x=n-a;break}case 5:{if(n+4>t.length)throw new Error("Unexpected end of data for Fixed32");d=new DataView(t.buffer,t.byteOffset+n,4).getUint32(0,!0),n+=4,x=n-a;break}case 3:case 4:r.push(`Deprecated wire type ${c} at field ${l}`),n=t.length,x=0;break;default:throw new Error(`Unknown wire type ${c}`)}s.push({fieldNumber:l,wireType:c,value:d,rawBytes:t.slice(a,n),offset:a,length:x})}catch(a){r.push(`Parse error at offset ${n}: ${a instanceof Error?a.message:String(a)}`);break}return{fields:s,errors:r}}function Ga(t){try{const r=new TextDecoder("utf-8",{fatal:!0}).decode(t);if(Ja(r))return{type:"string",value:r}}catch{}if(t.length>0)try{const s=Ss(t);if(s.fields.length>0&&s.errors.length===0&&s.fields.reduce((n,a)=>n+a.length,0)===t.length)return{type:"nested",value:s.fields}}catch{}return{type:"bytes",value:t}}function Ja(t){if(t.length===0)return!1;let s=0;for(const r of t){const n=r.charCodeAt(0);(n>=32&&n<127||n>127)&&s++}return s/t.length>.9}function Qa(t,s=32){const r=Array.from(t.slice(0,s)).map(n=>n.toString(16).padStart(2,"0")).join(" ");return t.length>s?`${r} ... (${t.length} bytes)`:r}function Ka(t){const s=Number(t),r=[];r.push(`uint: ${t}`);const n=Number(t>>1n^-(t&1n));if(n!==s&&r.push(`sint: ${n}`),(t===0n||t===1n)&&r.push(`bool: ${t===1n}`),s>1e9&&s<2e9){const a=new Date(s*1e3);r.push(`timestamp(s): ${a.toISOString()}`)}else if(s>1e12&&s<2e12){const a=new Date(s);r.push(`timestamp(ms): ${a.toISOString()}`)}return e.jsx("span",{className:"text-xs",children:r.map((a,i)=>e.jsx("span",{className:i===0?"text-green-400":"text-text-muted ml-2",children:a},i))})}function Xa(t){switch(t){case 0:return"Varint";case 1:return"Fixed64";case 2:return"Length-Delimited";case 5:return"Fixed32";case 3:return"StartGroup (deprecated)";case 4:return"EndGroup (deprecated)";default:return"Unknown"}}function st({base64Data:t,contentType:s,className:r}){const[n,a]=m.useState(new Set),[i,o]=m.useState("parsed"),l=m.useMemo(()=>{try{const x=Ht(t);return Ss(x)}catch(x){return{fields:[],errors:[`Failed to decode base64: ${x instanceof Error?x.message:String(x)}`]}}},[t]),c=m.useMemo(()=>{try{return Ht(t)}catch{return new Uint8Array}},[t]),d=x=>{const h=new Set(n);h.has(x)?h.delete(x):h.add(x),a(h)};return e.jsxs("div",{className:g("bg-bg-dark rounded-lg overflow-hidden",r),children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-bg-darker border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-purple-400",children:"ğŸ“¦ Protobuf"}),s&&e.jsx("span",{className:"text-xs text-text-muted",children:s}),e.jsxs("span",{className:"text-xs text-text-muted",children:["(",c.length," bytes)"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>o("parsed"),className:g("px-2 py-1 text-xs rounded transition-colors",i==="parsed"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-primary"),children:"Parsed"}),e.jsx("button",{onClick:()=>o("hex"),className:g("px-2 py-1 text-xs rounded transition-colors",i==="hex"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-primary"),children:"Hex"})]})]}),e.jsxs("div",{className:"p-3 max-h-96 overflow-auto",children:[l.errors.length>0&&e.jsx("div",{className:"mb-3 p-2 bg-red-500/10 border border-red-500/30 rounded text-xs text-red-400",children:l.errors.map((x,h)=>e.jsx("div",{children:x},h))}),i==="parsed"?l.fields.length>0?e.jsx(Es,{fields:l.fields,expandedFields:n,toggleField:d}):e.jsx("div",{className:"text-text-muted text-xs",children:"æ— æ³•è§£æä¸ºæœ‰æ•ˆçš„ Protobuf æ¶ˆæ¯"}):e.jsx(ei,{bytes:c})]})]})}function Es({fields:t,expandedFields:s,toggleField:r,prefix:n=""}){return e.jsx("div",{className:"space-y-1 font-mono text-xs",children:t.map((a,i)=>{const o=`${n}${a.fieldNumber}-${i}`,l=s.has(o),c=typeof a.value=="object"&&a.value!==null&&"type"in a.value&&a.value.type==="nested";return e.jsxs("div",{className:"border-l-2 border-border pl-2",children:[e.jsxs("div",{className:g("flex items-start gap-2 py-1",c&&"cursor-pointer hover:bg-bg-lighter rounded"),onClick:c?()=>r(o):void 0,children:[c&&e.jsx("span",{className:"text-text-muted",children:l?"â–¼":"â–¶"}),e.jsxs("span",{className:"text-yellow-400",children:["field ",a.fieldNumber]}),e.jsxs("span",{className:"text-text-muted",children:["(",Xa(a.wireType),")"]}),e.jsx("span",{className:"text-text-muted",children:"="}),e.jsx(Za,{field:a,expanded:l})]}),c&&l&&e.jsx("div",{className:"ml-4 mt-1",children:e.jsx(Es,{fields:a.value.value,expandedFields:s,toggleField:r,prefix:`${o}-`})})]},o)})})}function Za({field:t,expanded:s}){const{wireType:r,value:n}=t;if(r===0)return Ka(n);if(r===5){const a=n,i=new DataView(new Uint32Array([a]).buffer).getFloat32(0,!0);return e.jsxs("span",{className:"text-xs",children:[e.jsxs("span",{className:"text-green-400",children:["uint32: ",a]}),!isNaN(i)&&isFinite(i)&&e.jsxs("span",{className:"text-text-muted ml-2",children:["float: ",i.toFixed(4)]})]})}if(r===1){const a=n;return e.jsx("span",{className:"text-xs",children:e.jsxs("span",{className:"text-green-400",children:["uint64: ",a.toString()]})})}if(r===2&&typeof n=="object"&&n!==null&&"type"in n){const a=n;if(a.type==="string"){const i=String(a.value);return e.jsxs("span",{className:"text-green-400",children:['"',i.length>100?i.slice(0,100)+"...":i,'"']})}if(a.type==="nested"){const i=a.value;return s?null:e.jsx("span",{className:"text-blue-400",children:`{ ${i.length} fields }`})}if(a.type==="bytes"){const i=a.value;return e.jsxs("span",{className:"text-text-muted",children:["[",Qa(i),"]"]})}}return e.jsx("span",{className:"text-text-muted",children:"?"})}function ei({bytes:t}){const s=[];for(let n=0;n<t.length;n+=16){const a=t.slice(n,n+16),i=Array.from(a).map(l=>l.toString(16).padStart(2,"0")).join(" "),o=Array.from(a).map(l=>l>=32&&l<127?String.fromCharCode(l):".").join("");s.push(e.jsxs("div",{className:"flex gap-4 font-mono text-xs",children:[e.jsx("span",{className:"text-text-muted w-12",children:n.toString(16).padStart(8,"0")}),e.jsx("span",{className:"text-green-400 flex-1",children:i.padEnd(47," ")}),e.jsx("span",{className:"text-yellow-400",children:o})]},n))}return e.jsx("div",{className:"space-y-0.5",children:s})}function ti({event:t,deviceId:s,onShowRelatedLogs:r,onFavoriteChange:n}){var z,D,S,u,N,p;const[a,i]=m.useState("headers"),[o,l]=m.useState(null),[c,d]=m.useState(!1),[x,h]=m.useState(!1),[w,T]=m.useState(null),[f,y]=m.useState((t==null?void 0:t.isFavorite)??!1),[R,C]=m.useState(!1);if(t&&t.isFavorite!==f&&!R&&y(t.isFavorite),!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ğŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:"é€‰æ‹©ä¸€ä¸ªè¯·æ±‚æŸ¥çœ‹è¯¦æƒ…"})]});const k=t.requestBody?Lt(t.requestBody):null,O=t.responseBody?Lt(t.responseBody):null,B=((z=t.responseHeaders)==null?void 0:z["Content-Type"])||((D=t.responseHeaders)==null?void 0:D["content-type"]),b=za(B),$=Bt(B),Y=((S=t.requestHeaders)==null?void 0:S["Content-Type"])||((u=t.requestHeaders)==null?void 0:u["content-type"]),W=Bt(Y),G=async()=>{if(o){await navigator.clipboard.writeText(o),h(!0),setTimeout(()=>h(!1),2e3);return}d(!0);try{const E=await er(s,t.id);l(E.curl),await navigator.clipboard.writeText(E.curl),h(!0),setTimeout(()=>h(!1),2e3)}catch(E){console.error("Failed to generate cURL:",E)}finally{d(!1)}},j=async()=>{T("sending...");try{const E=await tr(s,t.id);T(`âœ“ ${E.status}`),setTimeout(()=>T(null),3e3)}catch{T("âœ— failed"),setTimeout(()=>T(null),3e3)}},F=async()=>{C(!0);try{const E=await sr(s,t.id);y(E.isFavorite),n==null||n(t.id,E.isFavorite)}catch(E){console.error("Failed to toggle favorite:",E)}finally{C(!1)}};return e.jsxs("div",{className:"h-full overflow-auto",children:[e.jsxs("div",{className:"p-4 bg-bg-dark border-b border-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium break-all flex-1",children:t.url}),e.jsx("button",{onClick:F,disabled:R,className:g("ml-2 p-1.5 rounded transition-colors",f?"text-yellow-400 hover:text-yellow-300":"text-text-muted hover:text-yellow-400"),title:f?"å–æ¶ˆæ”¶è—":"æ”¶è—",children:f?e.jsx(si,{className:"w-5 h-5"}):e.jsx(ri,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs mb-3",children:[e.jsx("span",{className:g("px-1.5 py-0.5 rounded font-mono",ht(t.method)),children:t.method}),e.jsx("span",{className:g("px-1.5 py-0.5 rounded font-mono",xt(t.statusCode)),children:t.statusCode??"ERR"}),e.jsx("span",{className:"text-text-muted",children:De(t.duration)}),t.isMocked&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-400",children:"ğŸ­ Mocked"}),((N=t.timing)==null?void 0:N.protocolName)&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-primary/20 text-primary",children:t.timing.protocolName}),((p=t.timing)==null?void 0:p.connectionReused)&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-green-500/20 text-green-400",children:"å¤ç”¨è¿æ¥"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:G,disabled:c,className:"px-3 py-1.5 bg-bg-light border border-border-subtle rounded text-xs hover:bg-bg-lighter transition-colors disabled:opacity-50",children:c?"ç”Ÿæˆä¸­...":x?"âœ“ å·²å¤åˆ¶":"ğŸ“‹ å¤åˆ¶ cURL"}),e.jsx("button",{onClick:j,disabled:w!==null,className:"px-3 py-1.5 bg-bg-light border border-border-subtle rounded text-xs hover:bg-bg-lighter transition-colors disabled:opacity-50",children:w||"ğŸ”„ é‡æ”¾è¯·æ±‚"})]}),t.traceId&&e.jsxs("div",{className:"mt-2 text-xs text-text-muted",children:["TraceId: ",e.jsx("span",{className:"font-mono text-text-primary",children:t.traceId})]})]}),e.jsxs("div",{className:"flex border-b border-border bg-bg-dark",children:[e.jsx(Me,{active:a==="headers",onClick:()=>i("headers"),children:"Headers"}),e.jsx(Me,{active:a==="params",onClick:()=>i("params"),children:"Params"}),e.jsx(Me,{active:a==="body",onClick:()=>i("body"),children:"Body"}),t.timing&&e.jsx(Me,{active:a==="timing",onClick:()=>i("timing"),children:"Timing"})]}),e.jsxs("div",{className:"p-4",children:[a==="headers"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ce,{title:"è¯·æ±‚å¤´",children:e.jsx(Fe,{headers:t.requestHeaders})}),t.responseHeaders&&e.jsx(ce,{title:"å“åº”å¤´",children:e.jsx(Fe,{headers:t.responseHeaders})})]}),a==="params"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ce,{title:"Query Params",children:e.jsx(Fe,{headers:t.queryItems||{}})}),e.jsxs(ce,{title:"Body Params",children:[e.jsx(Fe,{headers:t.bodyParams||{}}),!t.bodyParams&&e.jsx("div",{className:"text-text-muted text-sm",children:"æ— è§£æåçš„ Body å‚æ•°"})]})]}),a==="body"&&e.jsxs("div",{className:"space-y-6",children:[t.requestBody&&e.jsx(ce,{title:"è¯·æ±‚ä½“",children:W?e.jsx(st,{base64Data:t.requestBody,contentType:Y}):e.jsx($t,{content:k??""})}),t.responseBody&&e.jsx(ce,{title:"å“åº”ä½“",children:b?e.jsx(Wa,{base64Data:t.responseBody,contentType:B??null}):$?e.jsx(st,{base64Data:t.responseBody,contentType:B}):e.jsx($t,{content:O??""})}),!t.requestBody&&!t.responseBody&&e.jsx("div",{className:"text-text-muted text-sm",children:"æ— è¯·æ±‚ä½“æˆ–å“åº”ä½“"}),t.errorDescription&&e.jsx(ce,{title:"é”™è¯¯ä¿¡æ¯",children:e.jsx("pre",{className:"text-xs font-mono bg-bg-dark p-3 rounded text-red-400",children:t.errorDescription})})]}),a==="timing"&&t.timing&&e.jsx(ce,{title:"æ€§èƒ½æ—¶é—´çº¿",children:e.jsx(Ha,{timing:t.timing,totalDuration:t.duration})})]}),t.traceId&&r&&e.jsx("div",{className:"p-4 border-t border-border",children:e.jsx("button",{onClick:()=>r(t.traceId),className:"px-3 py-1.5 bg-bg-light border border-border rounded text-sm hover:bg-bg-lighter transition-colors",children:"æŸ¥çœ‹ TraceId å…³è”æ—¥å¿—"})})]})}function Me({active:t,onClick:s,children:r}){return e.jsx("button",{onClick:s,className:g("px-4 py-2 text-xs font-medium transition-colors",t?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-primary"),children:r})}function ce({title:t,children:s}){return e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs uppercase text-text-muted mb-2",children:t}),s]})}function Fe({headers:t}){const s=Object.entries(t);return s.length===0?e.jsx("span",{className:"text-text-muted text-sm",children:"æ— "}):e.jsx("table",{className:"w-full text-xs font-mono",children:e.jsx("tbody",{children:s.map(([r,n])=>e.jsxs("tr",{className:"border-b border-border/50 last:border-0",children:[e.jsx("td",{className:"py-1.5 pr-4 text-primary align-top whitespace-nowrap",children:r}),e.jsx("td",{className:"py-1.5 break-all",children:n})]},r))})})}function si({className:t=""}){return e.jsx("svg",{className:t,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}function ri({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})}const ni={verbose:"VERBOSE",debug:"DEBUG",info:"INFO",warning:"WARN",error:"ERROR"};function ai({events:t,autoScroll:s}){const r=m.useRef(null);return m.useEffect(()=>{s&&r.current&&t.length>0&&(r.current.scrollTop=0)},[t.length,s]),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 bg-bg-medium border-b border-border",children:e.jsxs("div",{className:"flex items-center text-xs font-semibold text-text-secondary uppercase tracking-wider",children:[e.jsx("div",{className:"w-32 px-4 py-3.5",children:"æ—¶é—´"}),e.jsx("div",{className:"w-24 px-4 py-3.5",children:"çº§åˆ«"}),e.jsx("div",{className:"w-36 px-4 py-3.5",children:"åˆ†ç±»"}),e.jsx("div",{className:"flex-1 px-4 py-3.5",children:"æ¶ˆæ¯å†…å®¹"})]})}),e.jsxs("div",{ref:r,className:"flex-1 overflow-auto font-mono text-sm",children:[t.map((n,a)=>{const i=Ra(n.level);return e.jsxs("div",{className:g("flex items-start border-l-2 transition-all duration-150 hover:bg-bg-light/60",i.border,a%2===0?"bg-bg-dark/20":"bg-transparent"),style:{animationDelay:`${Math.min(a*10,300)}ms`},children:[e.jsx("div",{className:"w-32 px-4 py-3 text-text-muted whitespace-nowrap flex-shrink-0 text-xs",children:oe(n.timestamp)}),e.jsx("div",{className:"w-24 px-4 py-2.5 flex-shrink-0",children:e.jsx("span",{className:g("inline-flex items-center justify-center px-2.5 py-1 rounded-lg text-2xs font-bold shadow-sm",i.bg,i.color),children:ni[n.level]})}),e.jsx("div",{className:"w-36 px-4 py-3 text-primary truncate flex-shrink-0 text-xs font-medium",title:n.category||n.subsystem||"-",children:n.category||n.subsystem||"-"}),e.jsx("div",{className:"flex-1 px-4 py-3 text-text-primary break-all whitespace-pre-wrap leading-relaxed text-xs",children:n.message})]},n.id)}),t.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-20",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-bg-light/50 flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-3xl opacity-60",children:"ğŸ“"})}),e.jsx("p",{className:"text-sm font-medium text-text-secondary mb-1",children:"æš‚æ— æ—¥å¿—"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç­‰å¾…æ—¥å¿—äº‹ä»¶åˆ°è¾¾..."})]})]})]})}const ii=[{level:"error",label:"Error",emoji:"âŒ",bgClass:"bg-level-error",textClass:"text-white"},{level:"warning",label:"Warning",emoji:"âš ï¸",bgClass:"bg-level-warning",textClass:"text-white"},{level:"info",label:"Info",emoji:"â„¹ï¸",bgClass:"bg-level-info",textClass:"text-white"},{level:"debug",label:"Debug",emoji:"ğŸ”",bgClass:"bg-level-debug",textClass:"text-white"},{level:"verbose",label:"Verbose",emoji:"ğŸ“",bgClass:"bg-level-verbose",textClass:"text-white"}],Wt={verbose:0,debug:1,info:2,warning:3,error:4};function oi({minLevel:t,subsystems:s,categories:r,selectedSubsystem:n,selectedCategory:a,searchText:i,searchQuery:o,onMinLevelChange:l,onSubsystemChange:c,onCategoryChange:d,onSearchChange:x,onSearchQueryChange:h}){const[w,T]=m.useState(!1),[f,y]=m.useState(!1),R=m.useRef(null),C=Wt[t];return m.useEffect(()=>{function k(O){R.current&&!R.current.contains(O.target)&&y(!1)}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx("div",{className:"flex gap-1",children:ii.map(({level:k,label:O,emoji:B,bgClass:b,textClass:$})=>{const Y=k===t,G=Wt[k]>=C;return e.jsxs("button",{onClick:()=>l(k),title:`æ˜¾ç¤º ${O} åŠæ›´é«˜çº§åˆ«æ—¥å¿—`,className:g("flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-medium transition-all",Y?`${b} ${$} shadow-sm`:G?`${b}/30 ${$.replace("text-white","text-"+k.replace("level-",""))}`:"bg-bg-light/50 text-text-muted hover:bg-bg-light border border-transparent opacity-50"),children:[e.jsx("span",{children:B}),e.jsx("span",{children:O})]},k)})}),e.jsx("div",{className:"w-px h-6 bg-border"}),e.jsxs("select",{value:n,onChange:k=>c(k.target.value),className:"select text-sm",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰ Subsystem"}),s.map(k=>e.jsx("option",{value:k,children:k},k))]}),e.jsxs("select",{value:a,onChange:k=>d(k.target.value),className:"select text-sm",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰ Category"}),r.map(k=>e.jsx("option",{value:k,children:k},k))]}),e.jsxs("div",{className:"flex-1 flex items-center gap-2 min-w-[200px] max-w-[600px]",children:[e.jsx("button",{onClick:()=>T(!w),className:g("px-2 py-1.5 rounded-lg text-xs font-medium transition-colors whitespace-nowrap",w?"bg-primary text-white":"bg-bg-light text-text-muted hover:text-text-secondary"),title:"åˆ‡æ¢é«˜çº§æœç´¢",children:w?"é«˜çº§":"ç®€å•"}),w?e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:o,onChange:k=>h(k.target.value),placeholder:"level:error subsystem:Network message:timeout...",className:"input w-full font-mono text-sm"}),e.jsx("button",{onClick:()=>y(!f),className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-secondary",title:"æœç´¢è¯­æ³•å¸®åŠ©",children:"?"}),f&&e.jsxs("div",{ref:R,className:"absolute top-full right-0 mt-2 w-80 p-3 bg-bg-dark border border-border rounded-lg shadow-xl z-50",children:[e.jsx("h4",{className:"text-sm font-semibold text-text-primary mb-2",children:"æœç´¢è¯­æ³•"}),e.jsx("pre",{className:"text-xs text-text-secondary whitespace-pre-wrap font-mono",children:Rr})]})]}):e.jsx("input",{type:"text",value:i,onChange:k=>x(k.target.value),placeholder:"ğŸ” æœç´¢æ—¥å¿—å†…å®¹...",className:"input flex-1"})]})]})}const li=[{category:"å¯¼èˆª",items:[{keys:["â†‘","â†“"],description:"ä¸Š/ä¸‹é€‰æ‹©è¯·æ±‚"},{keys:["Enter"],description:"æŸ¥çœ‹è¯¦æƒ…"},{keys:["Esc"],description:"å–æ¶ˆé€‰æ‹©/å…³é—­é¢æ¿"}]},{category:"æ“ä½œ",items:[{keys:["âŒ˜/Ctrl","K"],description:"æœç´¢"},{keys:["âŒ˜/Ctrl","R"],description:"åˆ·æ–°åˆ—è¡¨"},{keys:["âŒ˜/Ctrl","L"],description:"æ¸…ç©ºåˆ—è¡¨"},{keys:["âŒ˜/Ctrl","E"],description:"å¯¼å‡ºæ•°æ®"},{keys:["âŒ˜/Ctrl","A"],description:"å…¨é€‰"}]},{category:"æ”¶è—ä¸åˆ é™¤",items:[{keys:["F"],description:"æ”¶è—/å–æ¶ˆæ”¶è—é€‰ä¸­é¡¹"},{keys:["Delete","/","Backspace"],description:"åˆ é™¤é€‰ä¸­é¡¹"}]},{category:"ç•Œé¢",items:[{keys:["âŒ˜/Ctrl","T"],description:"åˆ‡æ¢ä¸»é¢˜"},{keys:["âŒ˜/Ctrl","/"],description:"æ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©"}]}];function ci({isOpen:t,onClose:s}){return m.useEffect(()=>{const r=n=>{n.key==="Escape"&&s()};if(t)return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t,s]),t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative bg-bg-dark border border-border rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"é”®ç›˜å¿«æ·é”®"}),e.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-bg-light transition-colors text-text-muted hover:text-text-primary",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6 overflow-auto max-h-[60vh]",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:li.map(r=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted mb-3",children:r.category}),e.jsx("div",{className:"space-y-2",children:r.items.map((n,a)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:n.description}),e.jsx("div",{className:"flex items-center gap-1",children:n.keys.map((i,o)=>e.jsxs("span",{className:"flex items-center",children:[e.jsx("kbd",{className:"kbd",children:i}),o<n.keys.length-1&&e.jsx("span",{className:"mx-1 text-text-muted text-xs",children:"+"})]},o))})]},a))})]},r.category))})}),e.jsx("div",{className:"px-6 py-3 border-t border-border bg-bg-medium/50 text-center",children:e.jsxs("span",{className:"text-xs text-text-muted",children:["æŒ‰ ",e.jsx("kbd",{className:"kbd",children:"Esc"})," å…³é—­"]})})]})]}):null}function di({sessions:t,selectedId:s,onSelect:r,loading:n,autoScroll:a,isSelectMode:i=!1,selectedIds:o=new Set,onToggleSelect:l}){const c=m.useRef(null),d=m.useRef(null);return m.useEffect(()=>{var h;if(!a||t.length===0)return;const x=(h=t[0])==null?void 0:h.id;x&&x!==d.current&&c.current&&(c.current.scrollTop=0),d.current=x},[t,a]),t.length===0&&!n?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-12",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ğŸ”Œ"}),e.jsx("p",{className:"text-sm",children:"æš‚æ—  WebSocket ä¼šè¯"}),e.jsx("p",{className:"text-xs mt-1 text-text-muted",children:"å½“è®¾å¤‡å»ºç«‹ WebSocket è¿æ¥æ—¶ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ"})]}):e.jsxs("div",{ref:c,className:"overflow-auto h-full",children:[e.jsx("div",{className:"divide-y divide-border/50",children:t.map(x=>e.jsx(ui,{session:x,isSelected:s===x.id,isChecked:o.has(x.id),isSelectMode:i,onSelect:r,onToggleSelect:l},x.id))}),n&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-primary border-t-transparent rounded-full"})})]})}const ui=m.memo(function({session:s,isSelected:r,isChecked:n,isSelectMode:a,onSelect:i,onToggleSelect:o}){const l=s.disconnectTime?De(new Date(s.connectTime),new Date(s.disconnectTime)):null,c=()=>{a&&o?o(s.id):i(s.id)};return e.jsxs("div",{onClick:c,className:g("px-4 py-3 cursor-pointer transition-all","hover:bg-bg-light/50",r&&!a?"bg-primary text-bg-darkest shadow-sm shadow-primary/20":"",!r&&"border-l-2 border-l-transparent",a&&n&&"bg-primary/15"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a?e.jsx("input",{type:"checkbox",checked:n,onChange:()=>o==null?void 0:o(s.id),onClick:d=>d.stopPropagation(),className:"w-4 h-4 rounded border-border bg-bg-light text-primary focus:ring-primary/50 cursor-pointer"}):e.jsx(mi,{isOpen:s.isOpen,isSelectedRow:r&&!a}),e.jsx("span",{className:g("font-mono text-sm truncate flex-1",r&&!a?"text-inherit":"text-text-primary"),children:mt(s.url)}),e.jsx("span",{className:g("text-xs",r&&!a?"text-bg-darkest/70":"text-text-muted"),children:oe(s.connectTime)})]}),e.jsx("div",{className:g("text-xs truncate font-mono ml-5",r&&!a?"text-bg-darkest/70":"text-text-muted"),children:s.url}),e.jsx("div",{className:"flex items-center gap-3 mt-1.5 ml-5",children:s.isOpen?e.jsxs("span",{className:g("inline-flex items-center gap-1 text-xs",r&&!a?"text-green-700":"text-green-400"),children:[e.jsx("span",{className:g("w-1.5 h-1.5 rounded-full animate-pulse",r&&!a?"bg-green-700":"bg-green-400")}),"è¿æ¥ä¸­"]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:g("text-xs",r&&!a?"text-bg-darkest/70":"text-text-muted"),children:["å·²å…³é—­",s.closeCode?` (${s.closeCode})`:""]}),l&&e.jsxs("span",{className:g("text-xs",r&&!a?"text-bg-darkest/70":"text-text-muted"),children:["æŒç»­ ",l]})]})})]})});function mi({isOpen:t,isSelectedRow:s}){return e.jsx("span",{className:g("w-3 h-3 rounded-full flex-shrink-0",t?s?"bg-green-300 shadow-green-300/50 shadow-sm":"bg-green-500 shadow-green-500/50 shadow-sm":s?"bg-gray-300":"bg-gray-500")})}function xi({deviceId:t,session:s,frames:r,loading:n,onLoadMore:a,hasMore:i,frameDirection:o,onFrameDirectionChange:l}){const[c,d]=m.useState("frames"),[x,h]=m.useState(null);return s?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/50",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"ğŸ”Œ"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-mono text-sm text-text-primary truncate",children:s.url}),e.jsxs("p",{className:"text-xs text-text-muted",children:[s.frameCount," å¸§ â€¢ è¿æ¥äº ",oe(s.connectTime)]})]}),e.jsx(hi,{isOpen:!s.disconnectTime,closeCode:s.closeCode})]})}),e.jsxs("div",{className:"px-4 py-2 border-b border-border bg-bg-dark flex gap-2",children:[e.jsxs("button",{onClick:()=>d("frames"),className:g("px-3 py-1.5 text-xs font-medium rounded-lg transition-all",c==="frames"?"bg-primary/20 text-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-light"),children:["ğŸ“¨ æ¶ˆæ¯å¸§ (",s.frameCount,")"]}),e.jsx("button",{onClick:()=>d("info"),className:g("px-3 py-1.5 text-xs font-medium rounded-lg transition-all",c==="info"?"bg-primary/20 text-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-light"),children:"â„¹ï¸ è¿æ¥ä¿¡æ¯"})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[c==="frames"&&e.jsx(pi,{deviceId:t,sessionId:s.id,frames:r,loading:n,onLoadMore:a,hasMore:i,expandedFrameId:x,onToggleExpand:h,direction:o,onDirectionChange:l}),c==="info"&&e.jsx(bi,{session:s})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ğŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:"é€‰æ‹©ä¸€ä¸ª WebSocket ä¼šè¯æŸ¥çœ‹è¯¦æƒ…"})]})}function hi({isOpen:t,closeCode:s}){return t?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded-full bg-green-500/10 text-green-400 border border-green-500/20",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"}),"è¿æ¥ä¸­"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded-full bg-text-muted/10 text-text-muted border border-border",children:["å·²å…³é—­",s?` (${s})`:""]})}function pi({deviceId:t,sessionId:s,frames:r,loading:n,onLoadMore:a,hasMore:i,expandedFrameId:o,onToggleExpand:l,direction:c,onDirectionChange:d}){const x=m.useRef(null),[h,w]=m.useState(!0),T=m.useRef(r.length);m.useEffect(()=>{!h||!x.current||(r.length>T.current&&(x.current.scrollTop=x.current.scrollHeight),T.current=r.length)},[r.length,h]);const f=r.filter(C=>C.direction==="send").length,y=r.filter(C=>C.direction==="receive").length,R=r.reduce((C,k)=>C+(k.payloadSize||0),0);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-border/50 flex items-center justify-between gap-3 bg-bg-dark/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-bg-light/50 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>d(""),className:g("px-2 py-1 text-xs rounded transition-colors",c?"text-text-muted hover:text-text-primary":"bg-bg-dark text-text-primary"),children:"å…¨éƒ¨"}),e.jsxs("button",{onClick:()=>d("send"),className:g("px-2 py-1 text-xs rounded transition-colors flex items-center gap-1",c==="send"?"bg-blue-500/20 text-blue-400":"text-text-muted hover:text-blue-400"),children:[e.jsx("span",{children:"â†‘"})," å‘é€"]}),e.jsxs("button",{onClick:()=>d("receive"),className:g("px-2 py-1 text-xs rounded transition-colors flex items-center gap-1",c==="receive"?"bg-green-500/20 text-green-400":"text-text-muted hover:text-green-400"),children:[e.jsx("span",{children:"â†“"})," æ¥æ”¶"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[e.jsxs("span",{className:"text-blue-400",children:["â†‘",f]}),e.jsxs("span",{className:"text-green-400",children:["â†“",y]}),e.jsxs("span",{children:["â€¢ ",Be(R)]})]})]}),e.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:C=>w(C.target.checked),className:"accent-primary w-3 h-3"}),"è‡ªåŠ¨æ»šåŠ¨"]})]}),e.jsxs("div",{ref:x,className:"flex-1 overflow-auto",children:[r.length===0&&!n?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-8",children:[e.jsx("span",{className:"text-3xl mb-2 opacity-50",children:"ğŸ“­"}),e.jsx("p",{className:"text-sm",children:"æš‚æ— æ¶ˆæ¯å¸§"})]}):e.jsx("div",{className:"divide-y divide-border/30",children:r.map(C=>e.jsx(fi,{deviceId:t,sessionId:s,frame:C,isExpanded:o===C.id,onToggle:()=>l(o===C.id?null:C.id)},C.id))}),i&&e.jsx("div",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:a,disabled:n,className:"btn btn-secondary text-xs",children:n?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"})})]})]})}const fi=m.memo(function({deviceId:s,sessionId:r,frame:n,isExpanded:a,onToggle:i}){const o=n.direction==="send",l=n.opcode==="text",[c,d]=m.useState(null),[x,h]=m.useState(!1),[w,T]=m.useState(null),[f,y]=m.useState("auto"),R=m.useCallback(async()=>{if(!(c||x)){h(!0),T(null);try{const O=await dr(s,r,n.id);d(O)}catch(O){T(O instanceof Error?O.message:"åŠ è½½å¤±è´¥")}finally{h(!1)}}},[s,r,n.id,c,x]),C=()=>{a||R(),i()},k=()=>{if(x)return e.jsx("div",{className:"bg-bg-dark rounded-lg p-4 text-center text-text-muted text-sm",children:e.jsx("span",{className:"animate-pulse",children:"åŠ è½½ä¸­..."})});if(w)return e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4 text-center text-red-400 text-sm",children:w});if(!c)return e.jsx("div",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary",children:n.payloadPreview||"(æ— æ³•é¢„è§ˆ)"});const{payloadText:O,payloadBase64:B}=c;switch(f==="auto"?gi(O,B):f){case"json":try{const $=JSON.parse(O||"");return e.jsx("div",{className:"bg-bg-dark rounded-lg p-3 max-h-80 overflow-auto",children:e.jsx(ws,{data:$})})}catch{return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:O||B})}case"text":return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:O||"(binary - cannot display as text)"});case"hex":return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:zt(B)});case"base64":return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:B});case"protobuf":return e.jsx("div",{className:"bg-bg-dark rounded-lg max-h-80 overflow-auto",children:e.jsx(st,{base64Data:B})});default:return e.jsx("pre",{className:"bg-bg-dark rounded-lg p-3 text-xs font-mono text-text-secondary overflow-auto max-h-60 whitespace-pre-wrap break-all",children:O||zt(B)})}};return e.jsxs("div",{className:g("px-4 py-2 cursor-pointer transition-all","hover:bg-bg-light/30",a&&"bg-bg-light/50",o?"border-l-2 border-l-blue-500/50":"border-l-2 border-l-green-500/50"),onClick:C,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:g("w-7 h-7 rounded-lg flex items-center justify-center text-sm font-medium",o?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"),children:o?"â†‘":"â†“"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:g("text-xs font-mono uppercase px-1.5 py-0.5 rounded",n.opcode==="text"?"bg-blue-500/10 text-blue-400":"bg-purple-500/10 text-purple-400"),children:n.opcode}),e.jsx("span",{className:"text-xs text-text-muted",children:Be(n.payloadSize)}),n.isMocked&&e.jsx("span",{className:"text-2xs px-1.5 py-0.5 bg-purple-500/20 text-purple-400 rounded",children:"MOCK"})]}),!a&&e.jsx("p",{className:"text-xs text-text-secondary truncate font-mono mt-0.5",children:n.payloadPreview||(l?"(empty)":"(binary data)")})]}),e.jsx("span",{className:"text-xs text-text-muted whitespace-nowrap",children:oe(n.timestamp)}),e.jsx("span",{className:g("text-xs text-text-muted transition-transform",a&&"rotate-90"),children:"â–¶"})]}),a&&e.jsxs("div",{className:"mt-3 ml-10",onClick:O=>O.stopPropagation(),children:[c&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:"æ ¼å¼:"}),["auto","text","json","protobuf","hex","base64"].map(O=>e.jsx("button",{onClick:()=>y(O),className:g("px-2 py-0.5 text-xs rounded transition-colors",f===O?"bg-primary/20 text-primary":"text-text-muted hover:text-text-primary hover:bg-bg-light"),children:O.toUpperCase()},O))]}),k()]})]})});function gi(t,s){if(!t){if(s)try{const r=atob(s),n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);if(n.length>0&&(n[0]&7)<=5)return"protobuf"}catch{}return"hex"}try{return JSON.parse(t),"json"}catch{return"text"}}function zt(t){try{const s=atob(t),r=new Uint8Array(s.length);for(let a=0;a<s.length;a++)r[a]=s.charCodeAt(a);const n=[];for(let a=0;a<r.length;a+=16){const i=r.slice(a,a+16),o=Array.from(i).map(d=>d.toString(16).padStart(2,"0")).join(" "),l=Array.from(i).map(d=>d>=32&&d<=126?String.fromCharCode(d):".").join(""),c=a.toString(16).padStart(8,"0");n.push(`${c}  ${o.padEnd(48)}  ${l}`)}return n.join(`
`)}catch{return t}}function bi({session:t}){return e.jsxs("div",{className:"p-4 space-y-4 overflow-auto h-full",children:[e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("h4",{className:"text-xs font-medium text-text-muted uppercase tracking-wider mb-3",children:"è¿æ¥ä¿¡æ¯"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsx(ve,{label:"URL",value:t.url,mono:!0}),e.jsx(ve,{label:"è¿æ¥æ—¶é—´",value:oe(t.connectTime)}),t.disconnectTime&&e.jsx(ve,{label:"æ–­å¼€æ—¶é—´",value:oe(t.disconnectTime)}),t.closeCode&&e.jsx(ve,{label:"å…³é—­ç ",value:String(t.closeCode)}),t.closeReason&&e.jsx(ve,{label:"å…³é—­åŸå› ",value:t.closeReason}),t.subprotocols.length>0&&e.jsx(ve,{label:"å­åè®®",value:t.subprotocols.join(", ")})]})]}),Object.keys(t.requestHeaders).length>0&&e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("h4",{className:"text-xs font-medium text-text-muted uppercase tracking-wider mb-3",children:"è¯·æ±‚å¤´"}),e.jsx("dl",{className:"space-y-1.5",children:Object.entries(t.requestHeaders).map(([s,r])=>e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"text-primary font-medium",children:[s,":"]}),e.jsx("span",{className:"text-text-secondary font-mono break-all",children:r})]},s))})]})]})}function ve({label:t,value:s,mono:r}){return e.jsxs("div",{className:"flex gap-3",children:[e.jsx("dt",{className:"text-text-muted w-20 flex-shrink-0",children:t}),e.jsx("dd",{className:g("text-text-primary break-all",r&&"font-mono text-xs"),children:s})]})}const yi={httpRequest:{label:"HTTP è¯·æ±‚",icon:"ğŸ“¤",color:"text-blue-400 bg-blue-500/10 border-blue-500/20"},httpResponse:{label:"HTTP å“åº”",icon:"ğŸ“¥",color:"text-green-400 bg-green-500/10 border-green-500/20"},wsOutgoing:{label:"WS å‘é€",icon:"â†‘",color:"text-purple-400 bg-purple-500/10 border-purple-500/20"},wsIncoming:{label:"WS æ¥æ”¶",icon:"â†“",color:"text-orange-400 bg-orange-500/10 border-orange-500/20"}};function vi({rules:t,loading:s,onEdit:r,onDelete:n,onToggleEnabled:a,onCreateNew:i}){return t.length===0&&!s?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted py-12",children:[e.jsx("span",{className:"text-5xl mb-4 opacity-50",children:"ğŸ­"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"æš‚æ—  Mock è§„åˆ™"}),e.jsx("p",{className:"text-sm mb-6",children:"åˆ›å»ºè§„åˆ™æ¥æ¨¡æ‹Ÿ API å“åº”æˆ–ä¿®æ”¹è¯·æ±‚"}),e.jsx("button",{onClick:i,className:"btn bg-primary text-white hover:bg-primary-dark",children:"âœ¨ åˆ›å»ºç¬¬ä¸€æ¡è§„åˆ™"})]}):e.jsxs("div",{className:"divide-y divide-border/50",children:[t.map(o=>e.jsx(ji,{rule:o,onEdit:()=>r(o),onDelete:()=>n(o.id),onToggleEnabled:()=>a(o.id)},o.id)),s&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-primary border-t-transparent rounded-full"})})]})}function ji({rule:t,onEdit:s,onDelete:r,onToggleEnabled:n}){const a=yi[t.targetType],i=Ni(t),o=wi(t);return e.jsx("div",{className:g("px-4 py-4 transition-all group",t.enabled?"bg-transparent":"bg-bg-medium/30 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{onClick:n,className:g("w-10 h-6 rounded-full relative transition-all flex-shrink-0 mt-1",t.enabled?"bg-primary":"bg-bg-light border border-border"),children:e.jsx("span",{className:g("absolute top-1 w-4 h-4 rounded-full bg-white shadow transition-all",t.enabled?"left-5":"left-1")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:t.name}),e.jsxs("span",{className:g("inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full border",a.color),children:[e.jsx("span",{children:a.icon}),e.jsx("span",{children:a.label})]}),!t.deviceId&&e.jsx("span",{className:"text-2xs px-1.5 py-0.5 bg-yellow-500/10 text-yellow-400 border border-yellow-500/20 rounded",children:"å…¨å±€"})]}),e.jsx("div",{className:"text-xs text-text-muted mb-1.5 space-y-0.5",children:i.map((l,c)=>e.jsxs("p",{children:[e.jsxs("span",{className:"text-text-secondary",children:[l.label,":"]})," ",e.jsx("span",{className:"font-mono",children:l.value})]},c))}),e.jsxs("div",{className:"text-xs text-text-muted",children:[e.jsx("span",{className:"text-primary",children:"â†’"})," ",o]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-2xs text-text-muted",children:[e.jsxs("span",{children:["ä¼˜å…ˆçº§: ",t.priority]}),t.updatedAt&&e.jsxs("span",{children:["æ›´æ–°äº ",oe(t.updatedAt)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-bg-light text-text-muted hover:text-text-primary transition-all",title:"ç¼–è¾‘",children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡è§„åˆ™å—ï¼Ÿ")&&r()},className:"p-2 rounded-lg hover:bg-red-500/10 text-text-muted hover:text-red-400 transition-all",title:"åˆ é™¤",children:"ğŸ—‘ï¸"})]})]})})}function Ni(t){const s=[],r=t.condition;return r.urlPattern&&s.push({label:"URL",value:r.urlPattern}),r.method&&s.push({label:"æ–¹æ³•",value:r.method}),r.statusCode&&s.push({label:"çŠ¶æ€ç ",value:String(r.statusCode)}),r.bodyContains&&s.push({label:"åŒ…å«",value:r.bodyContains}),r.wsPayloadContains&&s.push({label:"WSåŒ…å«",value:r.wsPayloadContains}),s.length===0&&s.push({label:"åŒ¹é…",value:"æ‰€æœ‰è¯·æ±‚"}),s}function wi(t){const s=t.action,r=[];return s.mockResponseStatusCode&&r.push(`è¿”å› ${s.mockResponseStatusCode}`),s.modifyRequestHeaders&&Object.keys(s.modifyRequestHeaders).length>0&&r.push("ä¿®æ”¹è¯·æ±‚å¤´"),s.modifyRequestBody&&r.push("ä¿®æ”¹è¯·æ±‚ä½“"),s.mockResponseBody&&r.push("è‡ªå®šä¹‰å“åº”ä½“"),s.mockWebSocketPayload&&r.push("æ›¿æ¢ WS æ¶ˆæ¯"),s.delayMilliseconds&&r.push(`å»¶è¿Ÿ ${s.delayMilliseconds}ms`),r.length>0?r.join(", "):"æ— åŠ¨ä½œ"}const ki=[{value:"httpRequest",label:"HTTP è¯·æ±‚",description:"ä¿®æ”¹å‘å‡ºçš„è¯·æ±‚"},{value:"httpResponse",label:"HTTP å“åº”",description:"æ¨¡æ‹Ÿæˆ–ä¿®æ”¹å“åº”"},{value:"wsOutgoing",label:"WebSocket å‘é€",description:"ä¿®æ”¹å‘é€çš„ WS æ¶ˆæ¯"},{value:"wsIncoming",label:"WebSocket æ¥æ”¶",description:"ä¿®æ”¹æ¥æ”¶çš„ WS æ¶ˆæ¯"}];function Si({rule:t,isOpen:s,onClose:r,onSave:n,loading:a}){var I,q,A;const i=!!t,o=t||kt(),[l,c]=m.useState(o.name),[d,x]=m.useState(o.targetType),[h,w]=m.useState(o.priority),[T,f]=m.useState(o.enabled),[y,R]=m.useState(o.condition.urlPattern||""),[C,k]=m.useState(o.condition.method||""),[O,B]=m.useState(((I=o.condition.statusCode)==null?void 0:I.toString())||""),[b,$]=m.useState(o.condition.bodyContains||""),[Y,W]=m.useState(o.condition.wsPayloadContains||""),[G,j]=m.useState(((q=o.action.mockResponseStatusCode)==null?void 0:q.toString())||"200"),[F,z]=m.useState(o.action.mockResponseBody?atob(o.action.mockResponseBody):""),[D,S]=m.useState(JSON.stringify(o.action.mockResponseHeaders||{},null,2)),[u,N]=m.useState(o.action.mockWebSocketPayload?atob(o.action.mockWebSocketPayload):""),[p,E]=m.useState(((A=o.action.delayMilliseconds)==null?void 0:A.toString())||"");m.useEffect(()=>{var _,X,ae;if(s){const L=t||kt();c(L.name),x(L.targetType),w(L.priority),f(L.enabled),R(L.condition.urlPattern||""),k(L.condition.method||""),B(((_=L.condition.statusCode)==null?void 0:_.toString())||""),$(L.condition.bodyContains||""),W(L.condition.wsPayloadContains||""),j(((X=L.action.mockResponseStatusCode)==null?void 0:X.toString())||"200"),z(L.action.mockResponseBody?atob(L.action.mockResponseBody):""),S(JSON.stringify(L.action.mockResponseHeaders||{},null,2)),N(L.action.mockWebSocketPayload?atob(L.action.mockWebSocketPayload):""),E(((ae=L.action.delayMilliseconds)==null?void 0:ae.toString())||"")}},[s,t]);const v=()=>{const _={urlPattern:y||null,method:C||null,statusCode:O?parseInt(O):null,headerContains:null,bodyContains:b||null,wsPayloadContains:Y||null,enabled:!0};let X=null;try{X=D?JSON.parse(D):null}catch{}const ae={modifyRequestHeaders:null,modifyRequestBody:null,mockResponseStatusCode:G?parseInt(G):null,mockResponseHeaders:X,mockResponseBody:F?btoa(F):null,mockWebSocketPayload:u?btoa(u):null,delayMilliseconds:p?parseInt(p):null};n({name:l,targetType:d,condition:_,action:ae,priority:h,enabled:T})};if(!s)return null;const M=d==="httpRequest"||d==="httpResponse",U=d==="wsOutgoing"||d==="wsIncoming",K=d==="httpResponse";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative w-full max-w-2xl max-h-[90vh] bg-bg-dark border border-border rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:i?"ç¼–è¾‘è§„åˆ™":"åˆ›å»º Mock è§„åˆ™"}),e.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-bg-light text-text-muted hover:text-text-primary transition-all",children:"âœ•"})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted uppercase tracking-wider",children:"åŸºæœ¬ä¿¡æ¯"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"è§„åˆ™åç§° *"}),e.jsx("input",{type:"text",value:l,onChange:_=>c(_.target.value),placeholder:"ä¾‹å¦‚ï¼šMock ç”¨æˆ·ä¿¡æ¯æ¥å£",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"ç›®æ ‡ç±»å‹ *"}),e.jsx("select",{value:d,onChange:_=>x(_.target.value),className:"select w-full",children:ki.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"ä¼˜å…ˆçº§"}),e.jsx("input",{type:"number",value:h,onChange:_=>w(parseInt(_.target.value)||0),className:"input w-full"})]}),e.jsx("div",{className:"flex items-center gap-3 pt-5",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:_=>f(_.target.checked),className:"accent-primary w-4 h-4"}),e.jsx("span",{className:"text-sm text-text-secondary",children:"å¯ç”¨è§„åˆ™"})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted uppercase tracking-wider",children:"åŒ¹é…æ¡ä»¶"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"URL æ¨¡å¼ï¼ˆæ”¯æŒ * é€šé…ç¬¦å’Œæ­£åˆ™ï¼‰"}),e.jsx("input",{type:"text",value:y,onChange:_=>R(_.target.value),placeholder:"ä¾‹å¦‚ï¼š*/api/user/* æˆ– ^https://api\\\\.example\\\\.com",className:"input w-full font-mono text-sm"})]}),M&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"HTTP æ–¹æ³•"}),e.jsxs("select",{value:C,onChange:_=>k(_.target.value),className:"select w-full",children:[e.jsx("option",{value:"",children:"ä»»æ„æ–¹æ³•"}),e.jsx("option",{value:"GET",children:"GET"}),e.jsx("option",{value:"POST",children:"POST"}),e.jsx("option",{value:"PUT",children:"PUT"}),e.jsx("option",{value:"DELETE",children:"DELETE"}),e.jsx("option",{value:"PATCH",children:"PATCH"})]})]}),K&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"åŸå§‹çŠ¶æ€ç "}),e.jsx("input",{type:"number",value:O,onChange:_=>B(_.target.value),placeholder:"ä»…åŒ¹é…æŒ‡å®šçŠ¶æ€ç çš„å“åº”",className:"input w-full"})]})]}),M&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"è¯·æ±‚ä½“åŒ…å«"}),e.jsx("input",{type:"text",value:b,onChange:_=>$(_.target.value),placeholder:"åŒ¹é…è¯·æ±‚ä½“ä¸­åŒ…å«çš„å†…å®¹",className:"input w-full font-mono text-sm"})]}),U&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"æ¶ˆæ¯åŒ…å«"}),e.jsx("input",{type:"text",value:Y,onChange:_=>W(_.target.value),placeholder:"åŒ¹é… WebSocket æ¶ˆæ¯ä¸­åŒ…å«çš„å†…å®¹",className:"input w-full font-mono text-sm"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-text-muted uppercase tracking-wider",children:"å“åº”é…ç½®"}),M&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"Mock çŠ¶æ€ç "}),e.jsx("input",{type:"number",value:G,onChange:_=>j(_.target.value),placeholder:"200",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:p,onChange:_=>E(_.target.value),placeholder:"0",className:"input w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å“åº”å¤´ (JSON)"}),e.jsx("textarea",{value:D,onChange:_=>S(_.target.value),placeholder:'{"Content-Type": "application/json"}',rows:3,className:"input w-full font-mono text-sm resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å“åº”ä½“"}),e.jsx("textarea",{value:F,onChange:_=>z(_.target.value),placeholder:'{"success": true, "data": {...}}',rows:6,className:"input w-full font-mono text-sm resize-none"})]})]}),U&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:p,onChange:_=>E(_.target.value),placeholder:"0",className:"input w-32"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1.5",children:"æ›¿æ¢æ¶ˆæ¯å†…å®¹"}),e.jsx("textarea",{value:u,onChange:_=>N(_.target.value),placeholder:'{"type": "mock", "data": {...}}',rows:6,className:"input w-full font-mono text-sm resize-none"})]})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-border flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"btn btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:v,disabled:a||!l.trim(),className:"btn bg-primary text-white hover:bg-primary-dark disabled:opacity-50",children:a?"ä¿å­˜ä¸­...":i?"ä¿å­˜ä¿®æ”¹":"åˆ›å»ºè§„åˆ™"})]})]})]})}function pt({isOpen:t,onClose:s,onConfirm:r,title:n,message:a,confirmText:i="ç¡®è®¤",cancelText:o="å–æ¶ˆ",type:l="danger",loading:c=!1}){if(!t)return null;const x={danger:{icon:"âš ï¸",iconBg:"bg-red-500/20",headerBg:"bg-red-500/5",titleColor:"text-red-400",confirmBg:"bg-red-500 hover:bg-red-600"},warning:{icon:"âš¡",iconBg:"bg-yellow-500/20",headerBg:"bg-yellow-500/5",titleColor:"text-yellow-400",confirmBg:"bg-yellow-500 hover:bg-yellow-600"},info:{icon:"â„¹ï¸",iconBg:"bg-blue-500/20",headerBg:"bg-blue-500/5",titleColor:"text-blue-400",confirmBg:"bg-blue-500 hover:bg-blue-600"}}[l];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl shadow-2xl w-[400px] overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("div",{className:g("px-6 py-4 border-b border-border",x.headerBg),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:g("w-10 h-10 rounded-xl flex items-center justify-center",x.iconBg),children:e.jsx("span",{className:"text-xl",children:x.icon})}),e.jsx("h3",{className:g("text-lg font-bold",x.titleColor),children:n})]})}),e.jsx("div",{className:"px-6 py-5",children:e.jsx("p",{className:"text-text-secondary whitespace-pre-line",children:a})}),e.jsxs("div",{className:"px-6 py-4 border-t border-border bg-bg-medium/30 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,disabled:c,className:"px-4 py-2 rounded-lg text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-bg-light transition-all disabled:opacity-50",children:o}),e.jsx("button",{onClick:r,disabled:c,className:g("px-4 py-2 rounded-lg text-sm font-medium text-white transition-all disabled:opacity-50",x.confirmBg),children:c?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"å¤„ç†ä¸­..."]}):i})]})]})})}function Ei({deviceId:t,isExpanded:s=!1,onToggleExpand:r}){const{activities:n}=is(),a=m.useMemo(()=>n.filter(l=>l.deviceId===t),[n,t]),i=a[0],o=(i==null?void 0:i.type)==="connected";return a.length===0?null:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:r,className:g("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all",o?"bg-green-500/10 text-green-400 border border-green-500/20 hover:bg-green-500/15":"bg-orange-500/10 text-orange-400 border border-orange-500/20 hover:bg-orange-500/15"),children:[e.jsx("span",{className:g("w-2 h-2 rounded-full",o?"bg-green-500":"bg-orange-500")}),e.jsx("span",{children:o?"å·²è¿æ¥":"é‡è¿ä¸­..."}),a.length>1&&e.jsxs("span",{className:"text-2xs opacity-60",children:["(",a.length,")"]}),e.jsx("span",{className:"ml-1",children:s?"â–²":"â–¼"})]}),s&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-bg-dark border border-border rounded-lg shadow-lg z-50 overflow-hidden animate-fadeIn",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-text-primary",children:"è¿æ¥æ´»åŠ¨"}),e.jsxs("span",{className:"text-2xs text-text-muted",children:[a.length," æ¡è®°å½•"]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:a.slice(0,20).map((l,c)=>e.jsx(Ti,{activity:l,isFirst:c===0},l.id))})]})]})}function Ti({activity:t,isFirst:s}){const r=t.type==="connected";return e.jsxs("div",{className:g("flex items-center gap-3 px-4 py-2.5 border-b border-border-light transition-colors",s&&"bg-bg-light/30"),children:[e.jsx("div",{className:g("w-8 h-8 rounded flex items-center justify-center flex-shrink-0",r?"bg-green-500/15":"bg-red-500/15"),children:e.jsx("span",{className:"text-sm",children:r?"ğŸ“±":"ğŸ“´"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:g("text-xs font-medium",r?"text-green-400":"text-red-400"),children:r?"è®¾å¤‡å·²è¿æ¥":"è®¾å¤‡å·²æ–­å¼€"}),e.jsxs("div",{className:"text-2xs text-text-muted font-mono truncate",children:[oe(t.timestamp),t.sessionId&&e.jsxs("span",{className:"ml-2 opacity-60",children:["#",t.sessionId.slice(0,6)]})]})]})]})}function Ci({hits:t,onResume:s,loading:r}){const[n,a]=m.useState(null),i=m.useMemo(()=>t.find(o=>o.requestId===n)||t[0]||null,[t,n]);return t.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"âœ…"}),e.jsx("p",{className:"text-sm",children:"æš‚æ— ç­‰å¾…å¤„ç†çš„æ–­ç‚¹"}),e.jsx("p",{className:"text-xs mt-1",children:"å½“è¯·æ±‚å‘½ä¸­æ–­ç‚¹è§„åˆ™æ—¶ä¼šåœ¨è¿™é‡Œæ˜¾ç¤º"})]}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border bg-orange-500/10 flex items-center gap-3",children:[e.jsx("span",{className:"text-xl animate-pulse",children:"â¸ï¸"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-medium text-orange-400",children:[t.length," ä¸ªæ–­ç‚¹ç­‰å¾…å¤„ç†"]}),e.jsx("p",{className:"text-xs text-text-muted",children:"è¯·æ±‚å·²è¢«æ‹¦æˆªï¼Œç­‰å¾…æ‚¨çš„æ“ä½œ"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"w-1/3 border-r border-border overflow-auto",children:t.map(o=>e.jsxs("div",{onClick:()=>a(o.requestId),className:g("p-3 border-b border-border cursor-pointer transition-colors",(i==null?void 0:i.requestId)===o.requestId?"bg-primary/10 border-l-2 border-l-primary":"hover:bg-bg-light"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:g("px-1.5 py-0.5 text-xs rounded font-medium",o.phase==="request"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"),children:o.phase==="request"?"è¯·æ±‚":"å“åº”"}),e.jsx("span",{className:"text-xs font-mono text-text-secondary",children:o.request.method})]}),e.jsx("div",{className:"text-xs text-text-muted truncate font-mono",children:new URL(o.request.url).pathname})]},o.requestId))}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:i&&e.jsx(Di,{hit:i,onResume:s,loading:r})})]})]})}function Di({hit:t,onResume:s,loading:r}){const[n,a]=m.useState(!1),[i,o]=m.useState(t.request),[l,c]=m.useState(t.response),[d,x]=m.useState("request");m.useState(()=>{o(t.request),c(t.response),a(!1)});const h=()=>{s(t.requestId,{type:"resume"})},w=()=>{s(t.requestId,{type:"abort"})},T=()=>{const R={type:"modify",modification:{request:t.phase==="request"?i:void 0,response:t.phase==="response"?l??void 0:void 0}};s(t.requestId,R)},f=()=>{l&&s(t.requestId,{type:"mockResponse",mockResponse:l})},y=R=>{try{return btoa(R)}catch{return R}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 border-b border-border bg-bg-dark/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:g("px-2 py-1 text-xs rounded font-bold",{"bg-green-500/20 text-green-400":t.request.method==="GET","bg-blue-500/20 text-blue-400":t.request.method==="POST","bg-yellow-500/20 text-yellow-400":t.request.method==="PUT","bg-red-500/20 text-red-400":t.request.method==="DELETE","bg-purple-500/20 text-purple-400":t.request.method==="PATCH"}),children:t.request.method}),e.jsx("span",{className:g("px-2 py-0.5 text-xs rounded",t.phase==="request"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"),children:t.phase==="request"?"è¯·æ±‚é˜¶æ®µ":"å“åº”é˜¶æ®µ"})]}),e.jsx("code",{className:"text-sm text-text-primary break-all",children:t.request.url})]}),e.jsxs("div",{className:"flex border-b border-border",children:[e.jsx("button",{onClick:()=>x("request"),className:g("px-4 py-2 text-sm font-medium transition-colors",d==="request"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-primary"),children:"è¯·æ±‚"}),(t.phase==="response"||n)&&e.jsx("button",{onClick:()=>x("response"),className:g("px-4 py-2 text-sm font-medium transition-colors",d==="response"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-primary"),children:"å“åº”"}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:()=>a(!n),className:g("px-4 py-2 text-sm transition-colors",n?"text-primary":"text-text-muted hover:text-text-primary"),children:n?"âœï¸ ç¼–è¾‘ä¸­":"âœï¸ ç¼–è¾‘"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:d==="request"?e.jsx(Oi,{request:i,onChange:o,editable:n&&t.phase==="request"}):e.jsx(Ri,{response:l,onChange:c,editable:n,showCreateButton:!l&&n,onCreateResponse:()=>c({statusCode:200,headers:{"Content-Type":"application/json"},body:y("{}")})})}),e.jsxs("div",{className:"p-4 border-t border-border bg-bg-dark/50 flex items-center gap-3",children:[e.jsx("button",{onClick:h,disabled:r,className:"btn btn-primary flex-1",children:"â–¶ï¸ ç»§ç»­"}),n&&e.jsx("button",{onClick:T,disabled:r,className:"btn bg-blue-500/20 text-blue-400 border border-blue-500/30 hover:bg-blue-500/30 flex-1",children:"âœï¸ ä¿®æ”¹åç»§ç»­"}),t.phase==="request"&&n&&l&&e.jsx("button",{onClick:f,disabled:r,className:"btn bg-purple-500/20 text-purple-400 border border-purple-500/30 hover:bg-purple-500/30 flex-1",children:"ğŸ­ è¿”å› Mock å“åº”"}),e.jsx("button",{onClick:w,disabled:r,className:"btn btn-danger",children:"â›” ä¸­æ­¢"})]})]})}function Oi({request:t,onChange:s,editable:r}){const n=m.useMemo(()=>{if(!t.body)return"";try{return atob(t.body)}catch{return t.body}},[t.body]),a=i=>{try{return JSON.stringify(JSON.parse(i),null,2)}catch{return i}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Headers"}),e.jsx("div",{className:"bg-bg-dark rounded-lg border border-border overflow-hidden",children:Object.entries(t.headers).map(([i,o])=>e.jsxs("div",{className:"flex border-b border-border last:border-b-0",children:[e.jsx("div",{className:"w-1/3 px-3 py-2 text-xs font-mono text-text-muted bg-bg-medium/50 border-r border-border",children:i}),e.jsx("div",{className:"flex-1 px-3 py-2 text-xs font-mono text-text-primary break-all",children:r?e.jsx("input",{type:"text",value:o,onChange:l=>s({...t,headers:{...t.headers,[i]:l.target.value}}),className:"w-full bg-transparent border-none outline-none"}):o})]},i))})]}),t.body&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Body"}),r?e.jsx("textarea",{value:n,onChange:i=>s({...t,body:btoa(i.target.value)}),className:"w-full h-64 bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary resize-none",spellCheck:!1}):e.jsx("pre",{className:"bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary overflow-auto max-h-64",children:a(n)})]})]})}function Ri({response:t,onChange:s,editable:r,showCreateButton:n,onCreateResponse:a}){if(!t)return n&&a?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("p",{className:"text-sm mb-3",children:"å°šæ— å“åº”æ•°æ®"}),e.jsx("button",{onClick:a,className:"btn btn-primary",children:"åˆ›å»º Mock å“åº”"})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:e.jsx("p",{className:"text-sm",children:"è¯·æ±‚é˜¶æ®µæ–­ç‚¹ï¼Œæš‚æ— å“åº”æ•°æ®"})});const i=m.useMemo(()=>{if(!t.body)return"";try{return atob(t.body)}catch{return t.body}},[t.body]),o=l=>{try{return JSON.stringify(JSON.parse(l),null,2)}catch{return l}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Status Code"}),r?e.jsx("input",{type:"number",value:t.statusCode,onChange:l=>s({...t,statusCode:parseInt(l.target.value)||200}),className:"input w-32"}):e.jsx("span",{className:g("px-2 py-1 rounded text-sm font-medium",t.statusCode>=200&&t.statusCode<300?"bg-green-500/20 text-green-400":t.statusCode>=400?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"),children:t.statusCode})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Headers"}),e.jsx("div",{className:"bg-bg-dark rounded-lg border border-border overflow-hidden",children:Object.entries(t.headers).map(([l,c])=>e.jsxs("div",{className:"flex border-b border-border last:border-b-0",children:[e.jsx("div",{className:"w-1/3 px-3 py-2 text-xs font-mono text-text-muted bg-bg-medium/50 border-r border-border",children:l}),e.jsx("div",{className:"flex-1 px-3 py-2 text-xs font-mono text-text-primary break-all",children:r?e.jsx("input",{type:"text",value:c,onChange:d=>s({...t,headers:{...t.headers,[l]:d.target.value}}),className:"w-full bg-transparent border-none outline-none"}):c})]},l))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Body"}),r?e.jsx("textarea",{value:i,onChange:l=>s({...t,body:btoa(l.target.value)}),className:"w-full h-64 bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary resize-none",spellCheck:!1}):e.jsx("pre",{className:"bg-bg-dark border border-border rounded-lg p-3 font-mono text-xs text-text-primary overflow-auto max-h-64",children:o(i)||"(empty)"})]})]})}function Ii({deviceId:t,pendingHits:s,onResumeBreakpoint:r}){const[n,a]=m.useState([]),[i,o]=m.useState(!1),[l,c]=m.useState(null),[d,x]=m.useState(!1),[h,w]=m.useState("rules"),[T,f]=m.useState([]),[y,R]=m.useState(!1),C=s??T,k=m.useCallback(async()=>{o(!0);try{const j=await br(t);a(j)}catch(j){console.error("Failed to fetch breakpoint rules:",j)}finally{o(!1)}},[t]),O=m.useCallback(async()=>{if(s===void 0)try{const j=await Zt(t);f(j)}catch(j){console.error("Failed to fetch pending breakpoints:",j)}},[t,s]);m.useEffect(()=>{k(),O();const j=setInterval(O,2e3);return()=>clearInterval(j)},[k,O]),m.useEffect(()=>{C.length>0&&w("pending")},[C.length]);const B=()=>{c({name:"",urlPattern:"",method:"",phase:"request",enabled:!0,priority:0}),x(!0)},b=j=>{c({...j}),x(!0)},$=async()=>{if(l)try{l.id?await jt(t,l.id,l):await yr(t,l),x(!1),c(null),k()}catch(j){console.error("Failed to save breakpoint rule:",j)}},Y=async j=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡æ–­ç‚¹è§„åˆ™å—ï¼Ÿ"))try{await vr(t,j),k()}catch(F){console.error("Failed to delete breakpoint rule:",F)}},W=async j=>{try{await jt(t,j.id,{enabled:!j.enabled}),k()}catch(F){console.error("Failed to toggle breakpoint rule:",F)}},G=async(j,F)=>{R(!0);try{r?r(j,F):(await es(t,j,F),f(z=>z.filter(D=>D.requestId!==j)))}catch(z){console.error("Failed to resume breakpoint:",z)}finally{R(!1)}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"â¸ï¸"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:"æ–­ç‚¹ç®¡ç†"}),e.jsx("p",{className:"text-xs text-text-muted",children:"æ‹¦æˆªè¯·æ±‚/å“åº”å¹¶ç­‰å¾…æ‰‹åŠ¨æ“ä½œ"})]})]}),h==="rules"&&e.jsx("button",{onClick:B,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:()=>w("rules"),className:g("px-4 py-2 rounded-lg text-sm font-medium transition-colors",h==="rules"?"bg-bg-light text-text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light/50"),children:["è§„åˆ™åˆ—è¡¨ (",n.length,")"]}),e.jsxs("button",{onClick:()=>w("pending"),className:g("px-4 py-2 rounded-lg text-sm font-medium transition-colors relative",h==="pending"?"bg-bg-light text-text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light/50"),children:["ç­‰å¾…å¤„ç†",C.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-orange-500 text-white text-xs rounded-full flex items-center justify-center animate-pulse",children:C.length})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:h==="rules"?e.jsx("div",{className:"h-full overflow-auto p-4",children:i?e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"åŠ è½½ä¸­..."}):n.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"â¸ï¸"}),e.jsx("p",{className:"text-sm mb-3",children:"æš‚æ— æ–­ç‚¹è§„åˆ™"}),e.jsx("button",{onClick:B,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}):e.jsx("div",{className:"space-y-3",children:n.map(j=>e.jsx(Pi,{rule:j,onEdit:()=>b(j),onDelete:()=>Y(j.id),onToggle:()=>W(j)},j.id))})}):e.jsx(Ci,{hits:C,onResume:G,loading:y})}),d&&l&&e.jsx(Mi,{rule:l,onChange:c,onSave:$,onCancel:()=>{x(!1),c(null)}})]})}function Pi({rule:t,onEdit:s,onDelete:r,onToggle:n}){const a={request:"è¯·æ±‚é˜¶æ®µ",response:"å“åº”é˜¶æ®µ",both:"åŒå‘æ‹¦æˆª"};return e.jsx("div",{className:g("p-4 bg-bg-dark border border-border rounded-xl transition-all",!t.enabled&&"opacity-50"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:g("w-10 h-6 rounded-full transition-colors relative",t.enabled?"bg-primary":"bg-bg-light"),children:e.jsx("span",{className:g("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",t.enabled?"left-5":"left-1")})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:t.name||"æœªå‘½åè§„åˆ™"}),e.jsxs("div",{className:"text-xs text-text-muted flex items-center gap-2",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-orange-500/20 text-orange-400 rounded text-2xs",children:a[t.phase]}),t.method&&e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-500/20 text-blue-400 rounded text-2xs",children:t.method}),t.urlPattern&&e.jsx("code",{className:"text-text-secondary truncate max-w-[200px]",children:t.urlPattern})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:s,className:"p-2 text-text-muted hover:text-text-primary hover:bg-bg-light rounded-lg transition-colors",children:"âœï¸"}),e.jsx("button",{onClick:r,className:"p-2 text-text-muted hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:"ğŸ—‘ï¸"})]})]})})}function Mi({rule:t,onChange:s,onSave:r,onCancel:n}){return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl w-full max-w-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:t.id?"ç¼–è¾‘æ–­ç‚¹è§„åˆ™":"æ–°å»ºæ–­ç‚¹è§„åˆ™"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"è§„åˆ™åç§°"}),e.jsx("input",{type:"text",value:t.name||"",onChange:a=>s({...t,name:a.target.value}),placeholder:"ä¾‹å¦‚ï¼šæ‹¦æˆªç™»å½•æ¥å£",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"URL åŒ¹é…æ¨¡å¼"}),e.jsx("input",{type:"text",value:t.urlPattern||"",onChange:a=>s({...t,urlPattern:a.target.value}),placeholder:"ä¾‹å¦‚ï¼š*/api/login* æˆ–ç•™ç©ºåŒ¹é…æ‰€æœ‰",className:"input w-full font-mono"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"HTTP æ–¹æ³•"}),e.jsxs("select",{value:t.method||"",onChange:a=>s({...t,method:a.target.value||null}),className:"select w-full",children:[e.jsx("option",{value:"",children:"å…¨éƒ¨æ–¹æ³•"}),e.jsx("option",{value:"GET",children:"GET"}),e.jsx("option",{value:"POST",children:"POST"}),e.jsx("option",{value:"PUT",children:"PUT"}),e.jsx("option",{value:"DELETE",children:"DELETE"}),e.jsx("option",{value:"PATCH",children:"PATCH"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"æ‹¦æˆªé˜¶æ®µ"}),e.jsxs("select",{value:t.phase||"request",onChange:a=>s({...t,phase:a.target.value}),className:"select w-full",children:[e.jsx("option",{value:"request",children:"è¯·æ±‚é˜¶æ®µ"}),e.jsx("option",{value:"response",children:"å“åº”é˜¶æ®µ"}),e.jsx("option",{value:"both",children:"åŒå‘æ‹¦æˆª"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"ä¼˜å…ˆçº§"}),e.jsx("input",{type:"number",value:t.priority||0,onChange:a=>s({...t,priority:parseInt(a.target.value)||0}),className:"input w-full"}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"æ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:n,className:"btn btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:r,className:"btn btn-primary",children:"ä¿å­˜"})]})]})})}function Fi({deviceId:t}){const[s,r]=m.useState([]),[n,a]=m.useState(!1),[i,o]=m.useState(null),[l,c]=m.useState(!1),d=m.useCallback(async()=>{a(!0);try{const y=await jr(t);r(y)}catch(y){console.error("Failed to fetch chaos rules:",y)}finally{a(!1)}},[t]);m.useEffect(()=>{d()},[d]);const x=()=>{o({name:"",urlPattern:"",chaos:{type:"latency",minLatency:500,maxLatency:2e3},enabled:!0,priority:0,probability:1}),c(!0)},h=y=>{o({...y}),c(!0)},w=async()=>{if(i)try{i.id?await Nt(t,i.id,i):await Nr(t,i),c(!1),o(null),d()}catch(y){console.error("Failed to save chaos rule:",y)}},T=async y=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡æ•…éšœæ³¨å…¥è§„åˆ™å—ï¼Ÿ"))try{await wr(t,y),d()}catch(R){console.error("Failed to delete chaos rule:",R)}},f=async y=>{try{await Nt(t,y.id,{enabled:!y.enabled}),d()}catch(R){console.error("Failed to toggle chaos rule:",R)}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"ğŸ²"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:"æ•…éšœæ³¨å…¥è§„åˆ™"}),e.jsx("p",{className:"text-xs text-text-muted",children:"æ³¨å…¥ç½‘ç»œæ•…éšœæ¥æµ‹è¯•åº”ç”¨çš„å¥å£®æ€§"})]})]}),e.jsx("button",{onClick:x,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:n?e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"åŠ è½½ä¸­..."}):s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ğŸ²"}),e.jsx("p",{className:"text-sm mb-3",children:"æš‚æ— æ•…éšœæ³¨å…¥è§„åˆ™"}),e.jsx("button",{onClick:x,className:"btn btn-primary text-sm",children:"+ æ–°å»ºè§„åˆ™"})]}):e.jsx("div",{className:"space-y-3",children:s.map(y=>e.jsx(Li,{rule:y,onEdit:()=>h(y),onDelete:()=>T(y.id),onToggle:()=>f(y)},y.id))})}),l&&i&&e.jsx(_i,{rule:i,onChange:o,onSave:w,onCancel:()=>{c(!1),o(null)}})]})}const Ts={latency:{label:"å»¶è¿Ÿ",color:"bg-yellow-500/20 text-yellow-400",icon:"â±ï¸",description:"å¢åŠ ç½‘ç»œå»¶è¿Ÿ"},timeout:{label:"è¶…æ—¶",color:"bg-orange-500/20 text-orange-400",icon:"â°",description:"è¯·æ±‚è¶…æ—¶"},connectionReset:{label:"è¿æ¥é‡ç½®",color:"bg-red-500/20 text-red-400",icon:"ğŸ”Œ",description:"æ¨¡æ‹Ÿè¿æ¥é‡ç½®"},randomError:{label:"éšæœºé”™è¯¯",color:"bg-pink-500/20 text-pink-400",icon:"ğŸ°",description:"è¿”å›éšæœºé”™è¯¯ç "},corruptResponse:{label:"æ•°æ®æŸå",color:"bg-purple-500/20 text-purple-400",icon:"ğŸ’¥",description:"æŸåå“åº”æ•°æ®"},slowNetwork:{label:"æ…¢é€Ÿç½‘ç»œ",color:"bg-blue-500/20 text-blue-400",icon:"ğŸŒ",description:"é™åˆ¶ç½‘ç»œå¸¦å®½"},dropRequest:{label:"ä¸¢å¼ƒè¯·æ±‚",color:"bg-gray-500/20 text-gray-400",icon:"ğŸ—‘ï¸",description:"ç›´æ¥ä¸¢å¼ƒè¯·æ±‚"}};function Li({rule:t,onEdit:s,onDelete:r,onToggle:n}){const a=Ts[t.chaos.type],o=(()=>{const l=t.chaos;switch(l.type){case"latency":return`å»¶è¿Ÿ: ${l.minLatency}-${l.maxLatency}ms`;case"slowNetwork":return`å¸¦å®½: ${l.bytesPerSecond} B/s`;case"randomError":return`é”™è¯¯ç : ${l.errorCodes.join(", ")}`;default:return null}})();return e.jsxs("div",{className:g("p-4 bg-bg-dark border border-border rounded-xl transition-all",!t.enabled&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:g("w-10 h-6 rounded-full transition-colors relative",t.enabled?"bg-primary":"bg-bg-light"),children:e.jsx("span",{className:g("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",t.enabled?"left-5":"left-1")})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-text-primary flex items-center gap-2",children:[e.jsx("span",{children:a.icon}),t.name||"æœªå‘½åè§„åˆ™"]}),e.jsxs("div",{className:"text-xs text-text-muted flex items-center gap-2 mt-1",children:[e.jsx("span",{className:g("px-1.5 py-0.5 rounded text-2xs",a.color),children:a.label}),t.probability<1&&e.jsxs("span",{className:"px-1.5 py-0.5 bg-purple-500/20 text-purple-400 rounded text-2xs",children:[Math.round(t.probability*100),"% æ¦‚ç‡"]}),t.urlPattern&&e.jsx("code",{className:"text-text-secondary truncate max-w-[200px]",children:t.urlPattern})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:s,className:"p-2 text-text-muted hover:text-text-primary hover:bg-bg-light rounded-lg transition-colors",children:"âœï¸"}),e.jsx("button",{onClick:r,className:"p-2 text-text-muted hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:"ğŸ—‘ï¸"})]})]}),o&&e.jsx("div",{className:"mt-2 text-xs text-text-muted",children:o})]})}function _i({rule:t,onChange:s,onSave:r,onCancel:n}){var l,c,d,x;const a=((l=t.chaos)==null?void 0:l.type)||"latency",i=h=>{let w;switch(h){case"latency":w={type:"latency",minLatency:500,maxLatency:2e3};break;case"timeout":w={type:"timeout"};break;case"connectionReset":w={type:"connectionReset"};break;case"randomError":w={type:"randomError",errorCodes:[500,502,503]};break;case"corruptResponse":w={type:"corruptResponse"};break;case"slowNetwork":w={type:"slowNetwork",bytesPerSecond:1024};break;case"dropRequest":w={type:"dropRequest"};break;default:w={type:"latency",minLatency:500,maxLatency:2e3}}s({...t,chaos:w})},o=h=>{t.chaos&&s({...t,chaos:{...t.chaos,...h}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:t.id?"ç¼–è¾‘æ•…éšœæ³¨å…¥è§„åˆ™":"æ–°å»ºæ•…éšœæ³¨å…¥è§„åˆ™"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"è§„åˆ™åç§°"}),e.jsx("input",{type:"text",value:t.name||"",onChange:h=>s({...t,name:h.target.value}),placeholder:"ä¾‹å¦‚ï¼šç™»å½•æ¥å£å»¶è¿Ÿ",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"URL åŒ¹é…æ¨¡å¼"}),e.jsx("input",{type:"text",value:t.urlPattern||"",onChange:h=>s({...t,urlPattern:h.target.value}),placeholder:"ä¾‹å¦‚ï¼š*/api/login* æˆ–ç•™ç©ºåŒ¹é…æ‰€æœ‰",className:"input w-full font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-2",children:"æ•…éšœæ³¨å…¥ç±»å‹"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Ts).map(([h,w])=>e.jsxs("button",{onClick:()=>i(h),className:g("p-3 rounded-lg border text-left transition-all",a===h?"border-primary bg-primary/10":"border-border hover:border-border-hover"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:w.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:w.label})]}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:w.description})]},h))})]}),((c=t.chaos)==null?void 0:c.type)==="latency"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"æœ€å°å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:t.chaos.minLatency,onChange:h=>o({minLatency:parseInt(h.target.value)||0}),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"æœ€å¤§å»¶è¿Ÿ (ms)"}),e.jsx("input",{type:"number",value:t.chaos.maxLatency,onChange:h=>o({maxLatency:parseInt(h.target.value)||0}),className:"input w-full"})]})]}),((d=t.chaos)==null?void 0:d.type)==="slowNetwork"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"å¸¦å®½é™åˆ¶ (B/s)"}),e.jsx("input",{type:"number",value:t.chaos.bytesPerSecond,onChange:h=>o({bytesPerSecond:parseInt(h.target.value)||1024}),className:"input w-full"}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"1024 = 1KB/s, 10240 = 10KB/s"})]}),((x=t.chaos)==null?void 0:x.type)==="randomError"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"é”™è¯¯çŠ¶æ€ç  (é€—å·åˆ†éš”)"}),e.jsx("input",{type:"text",value:t.chaos.errorCodes.join(", "),onChange:h=>{const w=h.target.value.split(",").map(T=>parseInt(T.trim())).filter(T=>!isNaN(T));o({errorCodes:w.length>0?w:[500]})},placeholder:"500, 502, 503",className:"input w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"è§¦å‘æ¦‚ç‡"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:(t.probability||1)*100,onChange:h=>s({...t,probability:parseInt(h.target.value)/100}),className:"flex-1"}),e.jsxs("span",{className:"text-text-primary w-12 text-right",children:[Math.round((t.probability||1)*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-text-muted mb-1",children:"ä¼˜å…ˆçº§"}),e.jsx("input",{type:"number",value:t.priority||0,onChange:h=>s({...t,priority:parseInt(h.target.value)||0}),className:"input w-full"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:n,className:"btn btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:r,className:"btn btn-primary",children:"ä¿å­˜"})]})]})})}const Ut={databases:[],dbLoading:!1,dbError:null,dbSortOrder:"name",dbSortAscending:!0,selectedDb:null,selectedTable:null,tables:[],tablesLoading:!1,schema:[],showSchema:!1,tableData:null,dataLoading:!1,dataError:null,page:1,pageSize:100,orderBy:null,ascending:!0,queryMode:!1,queryInput:"",queryResult:null,queryLoading:!1,queryError:null},Ai=ne((t,s)=>({...Ut,loadDatabases:async r=>{t({dbLoading:!0,dbError:null});try{const n=await kr(r);t({databases:n.databases,dbLoading:!1})}catch(n){t({dbError:n instanceof Error?n.message:"Failed to load databases",dbLoading:!1})}},loadTables:async(r,n)=>{t({tablesLoading:!0,tables:[]});try{const a=await Sr(r,n);t({tables:a.tables,tablesLoading:!1})}catch(a){console.error("Failed to load tables:",a),t({tablesLoading:!1})}},loadSchema:async(r,n,a)=>{try{const i=await Er(r,n,a);t({schema:i.columns})}catch(i){console.error("Failed to load schema:",i),t({schema:[]})}},loadTableData:async(r,n,a)=>{const{page:i,pageSize:o,orderBy:l,ascending:c,tables:d}=s();t({dataLoading:!0,dataError:null});try{const x=await Ye(r,n,a,{page:i,pageSize:o,orderBy:l??void 0,ascending:c}),h=d.map(w=>w.name===a&&x.totalRows!==null?{...w,rowCount:x.totalRows}:w);t({tableData:x,dataLoading:!1,tables:h})}catch(x){const h=x instanceof Error?x.message:"Failed to load table data";console.error("Failed to load table data:",x),t({tableData:null,dataLoading:!1,dataError:h})}},selectDb:r=>{s().selectedDb!==r&&t({selectedDb:r,selectedTable:null,tables:[],schema:[],tableData:null,page:1,orderBy:null})},selectTable:r=>{s().selectedTable!==r&&t({selectedTable:r,schema:[],tableData:null,page:1,orderBy:null})},setShowSchema:r=>{t({showSchema:r})},setPage:r=>{t({page:r})},setSort:r=>{const{orderBy:n,ascending:a}=s();t(n===r?{ascending:!a,page:1}:{orderBy:r,ascending:!0,page:1})},setSortAndReload:async(r,n)=>{const{orderBy:a,ascending:i,selectedDb:o,selectedTable:l}=s(),c=a===n?!i:!0;if(t({orderBy:n,ascending:c,page:1,dataLoading:!0}),o&&l)try{const d=await Ye(r,o,l,{page:1,pageSize:s().pageSize,orderBy:n,ascending:c});t({tableData:d,dataLoading:!1})}catch(d){console.error("Failed to load table data:",d),t({dataLoading:!1})}},setPageAndReload:async(r,n)=>{const{selectedDb:a,selectedTable:i,pageSize:o,orderBy:l,ascending:c}=s();if(t({page:n,dataLoading:!0}),a&&i)try{const d=await Ye(r,a,i,{page:n,pageSize:o,orderBy:l??void 0,ascending:c});t({tableData:d,dataLoading:!1})}catch(d){console.error("Failed to load table data:",d),t({dataLoading:!1})}},setQueryMode:r=>{t({queryMode:r,queryError:null}),r||t({queryResult:null})},setQueryInput:r=>{t({queryInput:r})},executeQuery:async r=>{const{selectedDb:n,queryInput:a}=s();if(!n||!a.trim()){t({queryError:"è¯·é€‰æ‹©æ•°æ®åº“å¹¶è¾“å…¥ SQL æŸ¥è¯¢è¯­å¥"});return}t({queryLoading:!0,queryError:null,queryResult:null});try{const i=await Tr(r,n,a);t({queryResult:i,queryLoading:!1})}catch(i){t({queryError:i instanceof Error?i.message:"Query execution failed",queryLoading:!1})}},clearQueryResult:()=>{t({queryResult:null,queryError:null})},setDbSortOrder:r=>{t({dbSortOrder:r})},toggleDbSortDirection:()=>{t(r=>({dbSortAscending:!r.dbSortAscending}))},getSortedDatabases:()=>{const{databases:r,dbSortOrder:n,dbSortAscending:a}=s();return[...r].sort((o,l)=>{let c=0;switch(n){case"name":c=o.descriptor.name.localeCompare(l.descriptor.name);break;case"size":c=(o.fileSizeBytes??0)-(l.fileSizeBytes??0);break;case"tableCount":c=(o.tableCount??0)-(l.tableCount??0);break}return a?c:-c})},reset:()=>{t(Ut)}}));var qt={exports:{}};const $i={google:{nested:{protobuf:{options:{go_package:"google.golang.org/protobuf/types/descriptorpb",java_package:"com.google.protobuf",java_outer_classname:"DescriptorProtos",csharp_namespace:"Google.Protobuf.Reflection",objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{FileDescriptorSet:{edition:"proto2",fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}},extensions:[[536e6,536e6]]},Edition:{edition:"proto2",values:{EDITION_UNKNOWN:0,EDITION_LEGACY:900,EDITION_PROTO2:998,EDITION_PROTO3:999,EDITION_2023:1e3,EDITION_2024:1001,EDITION_1_TEST_ONLY:1,EDITION_2_TEST_ONLY:2,EDITION_99997_TEST_ONLY:99997,EDITION_99998_TEST_ONLY:99998,EDITION_99999_TEST_ONLY:99999,EDITION_MAX:2147483647}},FileDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10},weakDependency:{rule:"repeated",type:"int32",id:11},optionDependency:{rule:"repeated",type:"string",id:15},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12},edition:{type:"Edition",id:14}}},DescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10},visibility:{type:"SymbolVisibility",id:11}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2},options:{type:"ExtensionRangeOptions",id:3}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},ExtensionRangeOptions:{edition:"proto2",fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999},declaration:{rule:"repeated",type:"Declaration",id:2,options:{retention:"RETENTION_SOURCE"}},features:{type:"FeatureSet",id:50},verification:{type:"VerificationState",id:3,options:{default:"UNVERIFIED",retention:"RETENTION_SOURCE"}}},extensions:[[1e3,536870911]],nested:{Declaration:{fields:{number:{type:"int32",id:1},fullName:{type:"string",id:2},type:{type:"string",id:3},reserved:{type:"bool",id:5},repeated:{type:"bool",id:6}},reserved:[[4,4]]},VerificationState:{values:{DECLARATION:0,UNVERIFIED:1}}}},FieldDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8},proto3Optional:{type:"bool",id:17}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REPEATED:3,LABEL_REQUIRED:2}}}},OneofDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3},reservedRange:{rule:"repeated",type:"EnumReservedRange",id:4},reservedName:{rule:"repeated",type:"string",id:5},visibility:{type:"SymbolVisibility",id:6}},nested:{EnumReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},EnumValueDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{edition:"proto2",fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31,options:{default:!0}},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},swiftPrefix:{type:"string",id:39},phpClassPrefix:{type:"string",id:40},phpNamespace:{type:"string",id:41},phpMetadataNamespace:{type:"string",id:44},rubyPackage:{type:"string",id:45},features:{type:"FeatureSet",id:50},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[42,42],[38,38],"php_generic_services"],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{edition:"proto2",fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:11,options:{deprecated:!0}},features:{type:"FeatureSet",id:12},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[5,5],[6,6],[8,8],[9,9]]},FieldOptions:{edition:"proto2",fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},unverifiedLazy:{type:"bool",id:15},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10,options:{deprecated:!0}},debugRedact:{type:"bool",id:16},retention:{type:"OptionRetention",id:17},targets:{rule:"repeated",type:"OptionTargetType",id:19},editionDefaults:{rule:"repeated",type:"EditionDefault",id:20},features:{type:"FeatureSet",id:21},featureSupport:{type:"FeatureSupport",id:22},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[18,18]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}},OptionRetention:{values:{RETENTION_UNKNOWN:0,RETENTION_RUNTIME:1,RETENTION_SOURCE:2}},OptionTargetType:{values:{TARGET_TYPE_UNKNOWN:0,TARGET_TYPE_FILE:1,TARGET_TYPE_EXTENSION_RANGE:2,TARGET_TYPE_MESSAGE:3,TARGET_TYPE_FIELD:4,TARGET_TYPE_ONEOF:5,TARGET_TYPE_ENUM:6,TARGET_TYPE_ENUM_ENTRY:7,TARGET_TYPE_SERVICE:8,TARGET_TYPE_METHOD:9}},EditionDefault:{fields:{edition:{type:"Edition",id:3},value:{type:"string",id:2}}},FeatureSupport:{fields:{editionIntroduced:{type:"Edition",id:1},editionDeprecated:{type:"Edition",id:2},deprecationWarning:{type:"string",id:3},editionRemoved:{type:"Edition",id:4}}}}},OneofOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{edition:"proto2",fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:6,options:{deprecated:!0}},features:{type:"FeatureSet",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[5,5]]},EnumValueOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:1},features:{type:"FeatureSet",id:2},debugRedact:{type:"bool",id:3},featureSupport:{type:"FieldOptions.FeatureSupport",id:4},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:34},deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:33},idempotencyLevel:{type:"IdempotencyLevel",id:34,options:{default:"IDEMPOTENCY_UNKNOWN"}},features:{type:"FeatureSet",id:35},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],nested:{IdempotencyLevel:{values:{IDEMPOTENCY_UNKNOWN:0,NO_SIDE_EFFECTS:1,IDEMPOTENT:2}}}},UninterpretedOption:{edition:"proto2",fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},FeatureSet:{edition:"proto2",fields:{fieldPresence:{type:"FieldPresence",id:1,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},enumType:{type:"EnumType",id:2,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},repeatedFieldEncoding:{type:"RepeatedFieldEncoding",id:3,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},utf8Validation:{type:"Utf8Validation",id:4,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},messageEncoding:{type:"MessageEncoding",id:5,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},jsonFormat:{type:"JsonFormat",id:6,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},enforceNamingStyle:{type:"EnforceNamingStyle",id:7,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},defaultSymbolVisibility:{type:"VisibilityFeature.DefaultSymbolVisibility",id:8,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},extensions:[[1e3,9994],[9995,9999],[1e4,1e4]],reserved:[[999,999]],nested:{FieldPresence:{values:{FIELD_PRESENCE_UNKNOWN:0,EXPLICIT:1,IMPLICIT:2,LEGACY_REQUIRED:3}},EnumType:{values:{ENUM_TYPE_UNKNOWN:0,OPEN:1,CLOSED:2}},RepeatedFieldEncoding:{values:{REPEATED_FIELD_ENCODING_UNKNOWN:0,PACKED:1,EXPANDED:2}},Utf8Validation:{values:{UTF8_VALIDATION_UNKNOWN:0,VERIFY:2,NONE:3}},MessageEncoding:{values:{MESSAGE_ENCODING_UNKNOWN:0,LENGTH_PREFIXED:1,DELIMITED:2}},JsonFormat:{values:{JSON_FORMAT_UNKNOWN:0,ALLOW:1,LEGACY_BEST_EFFORT:2}},EnforceNamingStyle:{values:{ENFORCE_NAMING_STYLE_UNKNOWN:0,STYLE2024:1,STYLE_LEGACY:2}},VisibilityFeature:{fields:{},reserved:[[1,536870911]],nested:{DefaultSymbolVisibility:{values:{DEFAULT_SYMBOL_VISIBILITY_UNKNOWN:0,EXPORT_ALL:1,EXPORT_TOP_LEVEL:2,LOCAL_ALL:3,STRICT:4}}}}}},FeatureSetDefaults:{edition:"proto2",fields:{defaults:{rule:"repeated",type:"FeatureSetEditionDefault",id:1},minimumEdition:{type:"Edition",id:4},maximumEdition:{type:"Edition",id:5}},nested:{FeatureSetEditionDefault:{fields:{edition:{type:"Edition",id:3},overridableFeatures:{type:"FeatureSet",id:4},fixedFeatures:{type:"FeatureSet",id:5}},reserved:[[1,1],[2,2],"features"]}}},SourceCodeInfo:{edition:"proto2",fields:{location:{rule:"repeated",type:"Location",id:1}},extensions:[[536e6,536e6]],nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},span:{rule:"repeated",type:"int32",id:2,options:{packed:!0}},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{edition:"proto2",fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4},semantic:{type:"Semantic",id:5}},nested:{Semantic:{values:{NONE:0,SET:1,ALIAS:2}}}}}},SymbolVisibility:{edition:"proto2",values:{VISIBILITY_UNSET:0,VISIBILITY_LOCAL:1,VISIBILITY_EXPORT:2}}}}}}},Bi={nested:$i};(function(t,s){var r=$s;t.exports=s=r.descriptor=r.Root.fromJSON(Bi).lookup(".google.protobuf");var n=r.Namespace,a=r.Root,i=r.Enum,o=r.Type,l=r.Field,c=r.MapField,d=r.OneOf,x=r.Service,h=r.Method;a.fromDescriptor=function(u){typeof u.length=="number"&&(u=s.FileDescriptorSet.decode(u));var N=new a;if(u.file)for(var p,E,v=0,M;v<u.file.length;++v){E=N,(p=u.file[v]).package&&p.package.length&&(E=N.define(p.package));var U=z(p);if(p.name&&p.name.length&&N.files.push(E.filename=p.name),p.messageType)for(M=0;M<p.messageType.length;++M)E.add(o.fromDescriptor(p.messageType[M],U));if(p.enumType)for(M=0;M<p.enumType.length;++M)E.add(i.fromDescriptor(p.enumType[M],U));if(p.extension)for(M=0;M<p.extension.length;++M)E.add(l.fromDescriptor(p.extension[M],U));if(p.service)for(M=0;M<p.service.length;++M)E.add(x.fromDescriptor(p.service[M],U));var K=Y(p.options,s.FileOptions);if(K){var I=Object.keys(K);for(M=0;M<I.length;++M)E.setOption(I[M],K[I[M]])}}return N.resolveAll()},a.prototype.toDescriptor=function(u){var N=s.FileDescriptorSet.create();return w(this,N.file,u),N};function w(S,u,N){var p=s.FileDescriptorProto.create({name:S.filename||(S.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});D(N,p),S instanceof a||(p.package=S.fullName.substring(1));for(var E=0,v;E<S.nestedArray.length;++E)(v=S._nestedArray[E])instanceof o?p.messageType.push(v.toDescriptor(N)):v instanceof i?p.enumType.push(v.toDescriptor()):v instanceof l?p.extension.push(v.toDescriptor(N)):v instanceof x?p.service.push(v.toDescriptor()):v instanceof n&&w(v,u,N);p.options=G(S.options,s.FileOptions),p.messageType.length+p.enumType.length+p.extension.length+p.service.length&&u.push(p)}var T=0;o.fromDescriptor=function(u,N,p){typeof u.length=="number"&&(u=s.DescriptorProto.decode(u));var E=new o(u.name.length?u.name:"Type"+T++,Y(u.options,s.MessageOptions)),v;if(p||(E._edition=N),u.oneofDecl)for(v=0;v<u.oneofDecl.length;++v)E.add(d.fromDescriptor(u.oneofDecl[v]));if(u.field)for(v=0;v<u.field.length;++v){var M=l.fromDescriptor(u.field[v],N,!0);E.add(M),u.field[v].hasOwnProperty("oneofIndex")&&E.oneofsArray[u.field[v].oneofIndex].add(M)}if(u.extension)for(v=0;v<u.extension.length;++v)E.add(l.fromDescriptor(u.extension[v],N,!0));if(u.nestedType)for(v=0;v<u.nestedType.length;++v)E.add(o.fromDescriptor(u.nestedType[v],N,!0)),u.nestedType[v].options&&u.nestedType[v].options.mapEntry&&E.setOption("map_entry",!0);if(u.enumType)for(v=0;v<u.enumType.length;++v)E.add(i.fromDescriptor(u.enumType[v],N,!0));if(u.extensionRange&&u.extensionRange.length)for(E.extensions=[],v=0;v<u.extensionRange.length;++v)E.extensions.push([u.extensionRange[v].start,u.extensionRange[v].end]);if(u.reservedRange&&u.reservedRange.length||u.reservedName&&u.reservedName.length){if(E.reserved=[],u.reservedRange)for(v=0;v<u.reservedRange.length;++v)E.reserved.push([u.reservedRange[v].start,u.reservedRange[v].end]);if(u.reservedName)for(v=0;v<u.reservedName.length;++v)E.reserved.push(u.reservedName[v])}return E},o.prototype.toDescriptor=function(u){var N=s.DescriptorProto.create({name:this.name}),p;for(p=0;p<this.fieldsArray.length;++p){var E;if(N.field.push(E=this._fieldsArray[p].toDescriptor(u)),this._fieldsArray[p]instanceof c){var v=b(this._fieldsArray[p].keyType,this._fieldsArray[p].resolvedKeyType,!1),M=b(this._fieldsArray[p].type,this._fieldsArray[p].resolvedType,!1),U=M===11||M===14?this._fieldsArray[p].resolvedType&&j(this.parent,this._fieldsArray[p].resolvedType)||this._fieldsArray[p].type:void 0;N.nestedType.push(s.DescriptorProto.create({name:E.typeName,field:[s.FieldDescriptorProto.create({name:"key",number:1,label:1,type:v}),s.FieldDescriptorProto.create({name:"value",number:2,label:1,type:M,typeName:U})],options:s.MessageOptions.create({mapEntry:!0})}))}}for(p=0;p<this.oneofsArray.length;++p)N.oneofDecl.push(this._oneofsArray[p].toDescriptor());for(p=0;p<this.nestedArray.length;++p)this._nestedArray[p]instanceof l?N.field.push(this._nestedArray[p].toDescriptor(u)):this._nestedArray[p]instanceof o?N.nestedType.push(this._nestedArray[p].toDescriptor(u)):this._nestedArray[p]instanceof i&&N.enumType.push(this._nestedArray[p].toDescriptor());if(this.extensions)for(p=0;p<this.extensions.length;++p)N.extensionRange.push(s.DescriptorProto.ExtensionRange.create({start:this.extensions[p][0],end:this.extensions[p][1]}));if(this.reserved)for(p=0;p<this.reserved.length;++p)typeof this.reserved[p]=="string"?N.reservedName.push(this.reserved[p]):N.reservedRange.push(s.DescriptorProto.ReservedRange.create({start:this.reserved[p][0],end:this.reserved[p][1]}));return N.options=G(this.options,s.MessageOptions),N};var f=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function(u,N,p){if(typeof u.length=="number"&&(u=s.DescriptorProto.decode(u)),typeof u.number!="number")throw Error("missing field id");var E;u.typeName&&u.typeName.length?E=u.typeName:E=O(u.type);var v;switch(u.label){case 1:v=void 0;break;case 2:v="required";break;case 3:v="repeated";break;default:throw Error("illegal label: "+u.label)}var M=u.extendee;u.extendee!==void 0&&(M=M.length?M:void 0);var U=new l(u.name.length?u.name:"field"+u.number,u.number,E,v,M);if(p||(U._edition=N),U.options=Y(u.options,s.FieldOptions),u.proto3_optional&&(U.options.proto3_optional=!0),u.defaultValue&&u.defaultValue.length){var K=u.defaultValue;switch(K){case"true":case"TRUE":K=!0;break;case"false":case"FALSE":K=!1;break;default:var I=f.exec(K);I&&(K=parseInt(K));break}U.setOption("default",K)}return B(u.type)&&(N==="proto3"?u.options&&!u.options.packed&&U.setOption("packed",!1):(!N||N==="proto2")&&u.options&&u.options.packed&&U.setOption("packed",!0)),U},l.prototype.toDescriptor=function(u){var N=s.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)N.type=11,N.typeName=r.util.ucFirst(this.name),N.label=3;else{switch(N.type=b(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:N.typeName=this.resolvedType?j(this.parent,this.resolvedType):this.type;break}this.rule==="repeated"?N.label=3:this.required&&u==="proto2"?N.label=2:N.label=1}if(N.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(N.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(N.options=G(this.options,s.FieldOptions),this.options.default!=null&&(N.defaultValue=String(this.options.default)),this.options.proto3_optional&&(N.proto3_optional=!0)),u==="proto3"?this.packed||((N.options||(N.options=s.FieldOptions.create())).packed=!1):(!u||u==="proto2")&&this.packed&&((N.options||(N.options=s.FieldOptions.create())).packed=!0),N};var y=0;i.fromDescriptor=function(u,N,p){typeof u.length=="number"&&(u=s.EnumDescriptorProto.decode(u));var E={};if(u.value)for(var v=0;v<u.value.length;++v){var M=u.value[v].name,U=u.value[v].number||0;E[M&&M.length?M:"NAME"+U]=U}var K=new i(u.name&&u.name.length?u.name:"Enum"+y++,E,Y(u.options,s.EnumOptions));return p||(K._edition=N),K},i.prototype.toDescriptor=function(){for(var u=[],N=0,p=Object.keys(this.values);N<p.length;++N)u.push(s.EnumValueDescriptorProto.create({name:p[N],number:this.values[p[N]]}));return s.EnumDescriptorProto.create({name:this.name,value:u,options:G(this.options,s.EnumOptions)})};var R=0;d.fromDescriptor=function(u){return typeof u.length=="number"&&(u=s.OneofDescriptorProto.decode(u)),new d(u.name&&u.name.length?u.name:"oneof"+R++)},d.prototype.toDescriptor=function(){return s.OneofDescriptorProto.create({name:this.name})};var C=0;x.fromDescriptor=function(u,N,p){typeof u.length=="number"&&(u=s.ServiceDescriptorProto.decode(u));var E=new x(u.name&&u.name.length?u.name:"Service"+C++,Y(u.options,s.ServiceOptions));if(p||(E._edition=N),u.method)for(var v=0;v<u.method.length;++v)E.add(h.fromDescriptor(u.method[v]));return E},x.prototype.toDescriptor=function(){for(var u=[],N=0;N<this.methodsArray.length;++N)u.push(this._methodsArray[N].toDescriptor());return s.ServiceDescriptorProto.create({name:this.name,method:u,options:G(this.options,s.ServiceOptions)})};var k=0;h.fromDescriptor=function(u){return typeof u.length=="number"&&(u=s.MethodDescriptorProto.decode(u)),new h(u.name&&u.name.length?u.name:"Method"+k++,"rpc",u.inputType,u.outputType,!!u.clientStreaming,!!u.serverStreaming,Y(u.options,s.MethodOptions))},h.prototype.toDescriptor=function(){return s.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:G(this.options,s.MethodOptions)})};function O(S){switch(S){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+S)}function B(S){switch(S){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function b(S,u,N){switch(S){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(u instanceof i)return 14;if(u instanceof o)return N?10:11;throw Error("illegal type: "+S)}function $(S,u){for(var N={},p=0,E,v;p<u.fieldsArray.length;++p)if((v=(E=u._fieldsArray[p]).name)!=="uninterpretedOption"&&Object.prototype.hasOwnProperty.call(S,v)){var M=F(v);E.resolvedType instanceof o?N[M]=$(S[v],E.resolvedType):E.resolvedType instanceof i?N[M]=E.resolvedType.valuesById[S[v]]:N[M]=S[v]}return N}function Y(S,u){if(S)return $(u.toObject(S),u)}function W(S,u){for(var N={},p=Object.keys(S),E=0;E<p.length;++E){var v=p[E],M=r.util.camelCase(v);if(Object.prototype.hasOwnProperty.call(u.fields,M)){var U=u.fields[M];U.resolvedType instanceof o?N[M]=W(S[v],U.resolvedType):N[M]=S[v],U.repeated&&!Array.isArray(N[M])&&(N[M]=[N[M]])}}return N}function G(S,u){if(S)return u.fromObject(W(S,u))}function j(S,u){var N=S.fullName.split("."),p=u.fullName.split("."),E=0,v=0,M=p.length-1;if(!(S instanceof a)&&u instanceof n)for(;E<N.length&&v<M&&N[E]===p[v];){var U=u.lookup(N[E++],!0);if(U!==null&&U!==u)break;++v}else for(;E<N.length&&v<M&&N[E]===p[v];++E,++v);return p.slice(v).join(".")}function F(S){return S.substring(0,1)+S.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(u,N){return"_"+N.toLowerCase()})}function z(S){if(S.syntax==="editions")switch(S.edition){case s.Edition.EDITION_2023:return"2023";default:throw new Error("Unsupported edition "+S.edition)}return S.syntax==="proto3"?"proto3":"proto2"}function D(S,u){if(S)if(S==="proto2"||S==="proto3")u.syntax=S;else switch(u.syntax="editions",S){case"2023":u.edition=s.Edition.EDITION_2023;break;default:throw new Error("Unsupported edition "+S)}}})(qt,qt.exports);async function Hi(t){return new Promise((s,r)=>{const n=new FileReader;n.onload=async()=>{try{const a=n.result,i=new Uint8Array(a),o=Te.Root.fromDescriptor(i),l=Cs(o);s({name:t.name,messageTypes:l,root:o,uploadedAt:new Date})}catch(a){r(new Error(`è§£ææè¿°ç¬¦æ–‡ä»¶å¤±è´¥: ${a instanceof Error?a.message:String(a)}`))}},n.onerror=()=>{r(new Error("è¯»å–æ–‡ä»¶å¤±è´¥"))},n.readAsArrayBuffer(t)})}async function Wi(t,s){const r=atob(t),n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);const a=Te.Root.fromDescriptor(n),i=Cs(a);return{name:s,messageTypes:i,root:a,uploadedAt:new Date}}function Cs(t){const s=[];function r(n,a){for(const i of n.nestedArray){const o=a?`${a}.${i.name}`:i.name;i instanceof Te.Type?(s.push(o),r(i,o)):i instanceof Te.Namespace&&r(i,o)}}return r(t,""),s.sort()}function zi(t,s,r){try{const n=t.root.lookupType(s);let a;if(typeof r=="string"){const l=atob(r);a=new Uint8Array(l.length);for(let c=0;c<l.length;c++)a[c]=l.charCodeAt(c)}else a=r;const i=n.decode(a);return{success:!0,data:n.toObject(i,{longs:String,enums:String,bytes:String,defaults:!1,arrays:!0,objects:!0})}}catch(n){return{success:!1,error:n instanceof Error?n.message:String(n)}}}function Yt(t){try{let s;if(typeof t=="string"){const a=atob(t);s=new Uint8Array(a.length);for(let i=0;i<a.length;i++)s[i]=a.charCodeAt(i)}else s=t;const r=new Te.Reader(s),n={};for(;r.pos<r.len;){const a=r.uint32(),i=a>>>3,o=a&7;let l;switch(o){case 0:l=r.int64().toString();break;case 1:l=r.fixed64().toString();break;case 2:const d=r.bytes();try{const x=new TextDecoder("utf-8",{fatal:!0}).decode(d);Ui(x)?l=x:l=`[${d.length} bytes]`}catch{l=`[${d.length} bytes]`}break;case 5:l=r.fixed32();break;default:r.skipType(o);continue}const c=`field_${i}`;c in n?Array.isArray(n[c])?n[c].push(l):n[c]=[n[c],l]:n[c]=l}return Object.keys(n).length>0?n:null}catch{return null}}function Ui(t){return/^[\x20-\x7E\u4E00-\u9FFF\u3000-\u303F\s]+$/.test(t)}function He(t,s=0){const r="  ".repeat(s),n=[];for(const[a,i]of Object.entries(t))if(i!=null)if(Array.isArray(i)){if(i.length===0)continue;n.push(`${r}${a}: [`);for(const o of i)typeof o=="object"&&o!==null?(n.push(`${r}  {`),n.push(He(o,s+2)),n.push(`${r}  }`)):n.push(`${r}  ${Vt(o)}`);n.push(`${r}]`)}else typeof i=="object"?(n.push(`${r}${a}: {`),n.push(He(i,s+1)),n.push(`${r}}`)):n.push(`${r}${a}: ${Vt(i)}`);return n.join(`
`)}function Vt(t){if(typeof t=="string"){const s=Number(t);if(!isNaN(s)){if(s>1e12&&s<2e12)return`${t} (${new Date(s).toISOString()})`;if(s>1e9&&s<2e9)return`${t} (${new Date(s*1e3).toISOString()})`}return`"${t}"`}return String(t)}async function qi(t){return new Promise((s,r)=>{const n=new FileReader;n.onload=()=>{const a=n.result,i=a.split(",")[1]||a;s(i)},n.onerror=r,n.readAsDataURL(t)})}const ft=ne()(as((t,s)=>({descriptorMeta:[],activeDescriptors:new Map,columnConfigs:[],loading:!1,error:null,uploadDescriptor:async r=>{t({loading:!0,error:null});try{const n=await Hi(r),a=await qi(r),i=s().descriptorMeta.findIndex(o=>o.name===n.name);t(o=>{const l=[...o.descriptorMeta],c={name:n.name,messageTypes:n.messageTypes,uploadedAt:n.uploadedAt.toISOString(),rawData:a};i>=0?l[i]=c:l.push(c);const d=new Map(o.activeDescriptors);return d.set(n.name,n),{descriptorMeta:l,activeDescriptors:d,loading:!1}})}catch(n){t({error:n instanceof Error?n.message:String(n),loading:!1})}},restoreDescriptor:async r=>{const{activeDescriptors:n,descriptorMeta:a}=s();if(n.has(r))return n.get(r);const i=a.find(o=>o.name===r);if(!i)return null;try{const o=await Wi(i.rawData,i.name);return t(l=>{const c=new Map(l.activeDescriptors);return c.set(r,o),{activeDescriptors:c}}),o}catch(o){return console.error("Failed to restore descriptor:",o),null}},removeDescriptor:r=>{t(n=>({descriptorMeta:n.descriptorMeta.filter(a=>a.name!==r),activeDescriptors:new Map([...n.activeDescriptors].filter(([a])=>a!==r)),columnConfigs:n.columnConfigs.filter(a=>a.descriptorName!==r)}))},addColumnConfig:r=>{t(n=>{const a=n.columnConfigs.findIndex(o=>o.dbId===r.dbId&&o.tableName===r.tableName&&o.columnName===r.columnName),i=[...n.columnConfigs];return a>=0?i[a]=r:i.push(r),{columnConfigs:i}})},removeColumnConfig:(r,n,a)=>{t(i=>({columnConfigs:i.columnConfigs.filter(o=>!(o.dbId===r&&o.tableName===n&&o.columnName===a))}))},getColumnConfig:(r,n,a)=>s().columnConfigs.find(i=>i.dbId===r&&i.tableName===n&&i.columnName===a)||null,decodeBlobData:async(r,n,a,i)=>{const o=s().getColumnConfig(r,n,a);if(!o)return{success:!1,error:"æœªé…ç½® Protobuf è§£æ"};const l=await s().restoreDescriptor(o.descriptorName);return l?zi(l,o.messageType,i):{success:!1,error:`æè¿°ç¬¦ "${o.descriptorName}" æœªæ‰¾åˆ°`}},getAvailableMessageTypes:()=>{const{descriptorMeta:r}=s(),n=[];for(const a of r)n.push(...a.messageTypes);return[...new Set(n)].sort()},clearAll:()=>{t({descriptorMeta:[],activeDescriptors:new Map,columnConfigs:[],error:null})}}),{name:"protobuf-store",partialize:t=>({descriptorMeta:t.descriptorMeta,columnConfigs:t.columnConfigs})}));function Yi({className:t,dbId:s,tableName:r,columns:n,onClose:a}){const{descriptorMeta:i,columnConfigs:o,loading:l,error:c,uploadDescriptor:d,removeDescriptor:x,addColumnConfig:h,removeColumnConfig:w,getColumnConfig:T}=ft(),f=m.useRef(null),[y,R]=m.useState("descriptors"),[C,k]=m.useState(null),[O,B]=m.useState(""),[b,$]=m.useState(""),Y=n.filter(D=>{var u;const S=(u=D.type)==null?void 0:u.toLowerCase();return S==="blob"||S===null||S===""}),W=m.useCallback(async D=>{var u;const S=(u=D.target.files)==null?void 0:u[0];S&&(await d(S),f.current&&(f.current.value=""))},[d]),G=m.useCallback(()=>{if(!s||!r||!C||!O||!b)return;h({dbId:s,tableName:r,columnName:C,messageType:b,descriptorName:O}),k(null),$("")},[s,r,C,O,b,h]),j=i.find(D=>D.name===O),F=(j==null?void 0:j.messageTypes)||[],z=o.filter(D=>D.dbId===s&&D.tableName===r);return e.jsxs("div",{className:g("bg-bg-dark rounded-lg border border-border shadow-lg",t),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-400",children:"ğŸ“¦"}),e.jsx("h3",{className:"font-medium text-text-primary text-sm",children:"Protobuf é…ç½®"})]}),e.jsx("button",{onClick:a,className:"p-1 rounded hover:bg-bg-light text-text-muted hover:text-text-secondary transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"flex border-b border-border",children:[e.jsxs("button",{onClick:()=>R("descriptors"),className:g("flex-1 px-4 py-2 text-xs font-medium transition-colors",y==="descriptors"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-secondary"),children:["æè¿°ç¬¦ (",i.length,")"]}),e.jsxs("button",{onClick:()=>R("columns"),className:g("flex-1 px-4 py-2 text-xs font-medium transition-colors",y==="columns"?"text-primary border-b-2 border-primary":"text-text-muted hover:text-text-secondary"),children:["åˆ—æ˜ å°„ (",z.length,")"]})]}),e.jsx("div",{className:"p-4",children:y==="descriptors"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{ref:f,type:"file",accept:".desc,.bin",onChange:W,className:"hidden"}),e.jsx("button",{onClick:()=>{var D;return(D=f.current)==null?void 0:D.click()},disabled:l,className:"w-full px-4 py-2 bg-primary/20 text-primary rounded-lg text-sm font-medium hover:bg-primary/30 disabled:opacity-50 transition-colors",children:l?"åŠ è½½ä¸­...":"ğŸ“ ä¸Šä¼  .desc æ–‡ä»¶"}),e.jsxs("p",{className:"text-xs text-text-muted mt-2",children:["ä½¿ç”¨ ",e.jsx("code",{className:"bg-bg-light px-1 rounded",children:"protoc --descriptor_set_out"})," ç”Ÿæˆ"]})]}),c&&e.jsx("div",{className:"px-3 py-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400",children:c}),i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(D=>e.jsxs("div",{className:"p-3 bg-bg-light rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono text-sm text-text-primary truncate",children:D.name}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:[D.messageTypes.length," ä¸ªæ¶ˆæ¯ç±»å‹"]}),e.jsx("div",{className:"text-2xs text-text-muted/50 mt-0.5",children:new Date(D.uploadedAt).toLocaleString()})]}),e.jsx("button",{onClick:()=>x(D.name),className:"p-1 rounded text-red-400 hover:bg-red-500/10 transition-colors",title:"åˆ é™¤",children:"ğŸ—‘ï¸"})]}),e.jsx("div",{className:"mt-2 max-h-24 overflow-auto",children:e.jsxs("div",{className:"text-2xs font-mono text-text-muted space-y-0.5",children:[D.messageTypes.slice(0,10).map(S=>e.jsx("div",{className:"truncate",children:S},S)),D.messageTypes.length>10&&e.jsxs("div",{className:"text-text-muted/50",children:["... è¿˜æœ‰ ",D.messageTypes.length-10," ä¸ª"]})]})})]},D.name))}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx("div",{className:"text-3xl mb-2 opacity-50",children:"ğŸ“­"}),e.jsx("p",{className:"text-sm",children:"å°šæœªä¸Šä¼ æè¿°ç¬¦æ–‡ä»¶"})]})]}):e.jsx("div",{className:"space-y-4",children:s&&r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-text-muted",children:["å½“å‰è¡¨: ",e.jsx("span",{className:"font-mono text-text-secondary",children:r})]}),z.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"å·²é…ç½®çš„åˆ—:"}),z.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-bg-light rounded border border-border",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono text-sm text-primary",children:D.columnName}),e.jsxs("div",{className:"text-xs text-text-muted truncate",children:["â†’ ",D.messageType]})]}),e.jsx("button",{onClick:()=>w(D.dbId,D.tableName,D.columnName),className:"p-1 rounded text-red-400 hover:bg-red-500/10 transition-colors",children:"âœ•"})]},D.columnName))]}),i.length>0&&Y.length>0?e.jsxs("div",{className:"space-y-3 p-3 bg-bg-lighter rounded-lg border border-border",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"æ·»åŠ é…ç½®:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-2xs text-text-muted mb-1",children:"BLOB åˆ—"}),e.jsxs("select",{value:C||"",onChange:D=>k(D.target.value||null),className:"w-full px-2 py-1.5 bg-bg-dark border border-border rounded text-sm text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"é€‰æ‹©åˆ—..."}),Y.map(D=>{const S=T(s,r,D.name);return e.jsxs("option",{value:D.name,disabled:!!S,children:[D.name," ",S?"(å·²é…ç½®)":""]},D.name)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-2xs text-text-muted mb-1",children:"æè¿°ç¬¦"}),e.jsxs("select",{value:O,onChange:D=>{B(D.target.value),$("")},className:"w-full px-2 py-1.5 bg-bg-dark border border-border rounded text-sm text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"é€‰æ‹©æè¿°ç¬¦..."}),i.map(D=>e.jsx("option",{value:D.name,children:D.name},D.name))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-2xs text-text-muted mb-1",children:"æ¶ˆæ¯ç±»å‹"}),e.jsxs("select",{value:b,onChange:D=>$(D.target.value),disabled:!O,className:"w-full px-2 py-1.5 bg-bg-dark border border-border rounded text-sm text-text-primary focus:outline-none focus:border-primary disabled:opacity-50",children:[e.jsx("option",{value:"",children:"é€‰æ‹©æ¶ˆæ¯ç±»å‹..."}),F.map(D=>e.jsx("option",{value:D,children:D},D))]})]}),e.jsx("button",{onClick:G,disabled:!C||!O||!b,className:"w-full px-3 py-1.5 bg-primary text-white rounded text-sm font-medium hover:bg-primary/90 disabled:opacity-50 transition-colors",children:"æ·»åŠ æ˜ å°„"})]}):i.length===0?e.jsx("div",{className:"text-center py-4 text-text-muted text-xs",children:"è¯·å…ˆä¸Šä¼ æè¿°ç¬¦æ–‡ä»¶"}):e.jsx("div",{className:"text-center py-4 text-text-muted text-xs",children:"å½“å‰è¡¨æ²¡æœ‰ BLOB ç±»å‹çš„åˆ—"})]}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx("div",{className:"text-3xl mb-2 opacity-50",children:"ğŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:"è¯·å…ˆé€‰æ‹©ä¸€ä¸ªè¡¨"})]})})})]})}function Vi({value:t,dbId:s,tableName:r,columnName:n,maxWidth:a=300}){const{getColumnConfig:i,decodeBlobData:o}=ft(),[l,c]=m.useState(!1),[d,x]=m.useState("decoded"),[h,w]=m.useState(null),[T,f]=m.useState(null),[y,R]=m.useState(!1),C=i(s,r,n);m.useEffect(()=>{if(!(!t||!l))if(R(!0),f(null),C)o(s,r,n,t).then(b=>{R(!1),b.success?(w(b.data),f(null)):(w(null),f(b.error))});else{const b=Yt(t);w(b),f(b?null:"æ— æ³•è‡ªåŠ¨è§£æ"),R(!1)}},[t,l,C,s,r,n,o]);const k=m.useMemo(()=>{try{return atob(t).length}catch{return 0}},[t]),O=m.useMemo(()=>{try{const b=atob(t),$=[];for(let Y=0;Y<Math.min(b.length,256);Y++)$.push(b.charCodeAt(Y).toString(16).padStart(2,"0"));return $}catch{return[]}},[t]),B=m.useMemo(()=>d!=="wire"||!l?null:Yt(t),[t,d,l]);return l?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>c(!1),children:e.jsxs("div",{className:"bg-bg-dark rounded-lg border border-border shadow-2xl max-w-2xl w-full max-h-[80vh] flex flex-col",style:{maxWidth:a},onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-400",children:"ğŸ“¦"}),e.jsx("span",{className:"font-mono text-sm text-text-primary",children:n}),e.jsxs("span",{className:"text-xs text-text-muted",children:["(",k," bytes)"]}),C&&e.jsx("span",{className:"text-xs text-green-400 bg-green-400/10 px-2 py-0.5 rounded",children:C.messageType})]}),e.jsx("button",{onClick:()=>c(!1),className:"p-1 rounded hover:bg-bg-light text-text-muted hover:text-text-secondary transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"flex gap-1 px-4 py-2 border-b border-border",children:[e.jsx("button",{onClick:()=>x("decoded"),className:g("px-3 py-1 text-xs rounded transition-colors",d==="decoded"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),children:C?"Schema è§£ç ":"è‡ªåŠ¨è§£æ"}),e.jsx("button",{onClick:()=>x("wire"),className:g("px-3 py-1 text-xs rounded transition-colors",d==="wire"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),children:"Wire Format"}),e.jsx("button",{onClick:()=>x("hex"),className:g("px-3 py-1 text-xs rounded transition-colors",d==="hex"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),children:"Hex"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"})}):d==="decoded"?h?e.jsx("pre",{className:"text-xs font-mono text-text-secondary whitespace-pre-wrap",children:He(h)}):T?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-yellow-400 mb-2",children:"âš ï¸"}),e.jsx("p",{className:"text-sm text-text-muted",children:T}),!C&&e.jsx("p",{className:"text-xs text-text-muted/50 mt-2",children:"é…ç½® Protobuf Schema ä»¥è·å¾—æ›´å¥½çš„è§£æç»“æœ"})]}):null:d==="wire"?B?e.jsx("pre",{className:"text-xs font-mono text-text-secondary whitespace-pre-wrap",children:He(B)}):e.jsx("div",{className:"text-center py-8 text-text-muted",children:"æ— æ³•è§£æ Wire Format"}):e.jsxs("div",{className:"font-mono text-xs",children:[e.jsxs("div",{className:"flex flex-wrap gap-1",children:[O.map((b,$)=>e.jsx("span",{className:g("px-1 py-0.5 rounded",$%16<8?"bg-bg-light":"bg-bg-lighter"),children:b},$)),k>256&&e.jsxs("span",{className:"text-text-muted px-2",children:["... è¿˜æœ‰ ",k-256," bytes"]})]}),e.jsxs("div",{className:"mt-4 text-text-muted",children:["å…± ",k," bytes"]})]})}),!C&&d==="decoded"&&e.jsx("div",{className:"px-4 py-2 border-t border-border text-xs text-text-muted bg-bg-darker",children:"ğŸ’¡ æç¤ºï¼šä¸Šä¼  .desc æ–‡ä»¶å¹¶é…ç½®åˆ—æ˜ å°„å¯è·å¾—ç²¾ç¡®çš„è§£æç»“æœ"})]})}):e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-1 text-xs text-purple-400 hover:text-purple-300 transition-colors",title:"ç‚¹å‡»å±•å¼€",children:[e.jsx("span",{className:"opacity-70",children:"ğŸ“¦"}),e.jsx("span",{className:"font-mono",children:C?`[${C.messageType.split(".").pop()}]`:`[BLOB ${k}B]`}),C&&e.jsx("span",{className:"text-green-400 text-2xs",children:"âœ“"})]})}function Gi(t){if(!t||typeof t!="string"||t.length<4||t.length%4!==0||!/^[A-Za-z0-9+/]+=*$/.test(t))return!1;try{const r=atob(t);let n=0;for(let a=0;a<Math.min(r.length,100);a++){const i=r.charCodeAt(a);(i<32||i>126)&&n++}return n/Math.min(r.length,100)>.3}catch{return!1}}function Ji({deviceId:t}){var Q;const{databases:s,dbLoading:r,dbError:n,selectedDb:a,selectedTable:i,tables:o,tablesLoading:l,schema:c,showSchema:d,tableData:x,dataLoading:h,dataError:w,page:T,pageSize:f,orderBy:y,ascending:R,queryMode:C,queryInput:k,queryResult:O,queryLoading:B,queryError:b,dbSortOrder:$,dbSortAscending:Y,loadDatabases:W,loadTables:G,loadSchema:j,loadTableData:F,selectDb:z,selectTable:D,setShowSchema:S,setSortAndReload:u,setPageAndReload:N,setQueryMode:p,setQueryInput:E,executeQuery:v,setDbSortOrder:M,toggleDbSortDirection:U,getSortedDatabases:K}=Ai(),{descriptorMeta:I,getColumnConfig:q}=ft(),[A,_]=m.useState(!1);m.useEffect(()=>{s.length===0&&W(t)},[t,s.length,W]),m.useEffect(()=>{a&&o.length===0&&G(t,a)},[t,a,o.length,G]),m.useEffect(()=>{a&&i&&!x&&(j(t,a,i),F(t,a,i))},[t,a,i,x,j,F]);const X=m.useCallback(P=>{z(P),G(t,P)},[z,G,t]),ae=m.useCallback(P=>{D(P),a&&(j(t,a,P),F(t,a,P))},[D,a,t,j,F]),L=m.useCallback(P=>{u(t,P)},[u,t]),Z=m.useCallback(P=>{N(t,P)},[N,t]),re=P=>P===null?"-":P<1024?`${P} B`:P<1024*1024?`${(P/1024).toFixed(1)} KB`:`${(P/(1024*1024)).toFixed(1)} MB`,ee=P=>{switch(P){case"log":return"ğŸ“‹";case"cache":return"âš¡";default:return"ğŸ“"}};return r?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full"})}):n?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"âš ï¸"}),e.jsx("p",{className:"text-sm mb-3",children:n}),e.jsx("button",{onClick:()=>W(t),className:"px-4 py-2 bg-primary/20 text-primary rounded-lg hover:bg-primary/30 transition-colors",children:"é‡è¯•"})]}):s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"ğŸ—ƒï¸"}),e.jsx("p",{className:"text-sm",children:"æ²¡æœ‰æ³¨å†Œçš„æ•°æ®åº“"}),e.jsx("p",{className:"text-xs mt-2 text-text-muted",children:"åœ¨ iOS App ä¸­ä½¿ç”¨ DatabaseRegistry.shared.register() æ³¨å†Œæ•°æ®åº“"})]}):e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-64 flex-shrink-0 border-r border-border bg-bg-dark flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-medium text-text-muted uppercase tracking-wider",children:"æ•°æ®åº“"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("select",{value:$,onChange:P=>M(P.target.value),className:"text-2xs bg-bg-light border border-border rounded px-1.5 py-0.5 text-text-secondary focus:outline-none focus:border-primary",title:"æ’åºæ–¹å¼",children:[e.jsx("option",{value:"name",children:"åç§°"}),e.jsx("option",{value:"size",children:"å¤§å°"}),e.jsx("option",{value:"tableCount",children:"è¡¨æ•°"})]}),e.jsx("button",{onClick:U,className:"p-1 rounded hover:bg-bg-light text-text-muted hover:text-text-secondary transition-colors",title:Y?"å‡åº":"é™åº",children:e.jsx("span",{className:"text-xs",children:Y?"â†‘":"â†“"})})]})]}),e.jsx("div",{className:"space-y-1",children:K().map(P=>e.jsx("button",{onClick:()=>X(P.descriptor.id),className:g("w-full px-3 py-2 rounded-lg text-left text-xs transition-all",a===P.descriptor.id?"bg-primary text-white shadow-sm shadow-primary/30":"text-text-secondary hover:bg-bg-light"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:ee(P.descriptor.kind)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:P.descriptor.name}),e.jsxs("div",{className:g("text-2xs",a===P.descriptor.id?"text-white/70":"text-text-muted"),children:[P.tableCount," è¡¨ â€¢ ",re(P.fileSizeBytes)]})]}),P.descriptor.isSensitive&&e.jsx("span",{className:"text-yellow-500",title:"æ•æ„Ÿæ•°æ®",children:"ğŸ”’"})]})},P.descriptor.id))})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-xs font-medium text-text-muted uppercase tracking-wider",children:["è¡¨ ",o.length>0&&`(${o.length})`]}),a&&e.jsx("button",{onClick:()=>p(!C),className:g("px-2 py-1 rounded text-xs transition-colors",C?"bg-accent-blue/20 text-accent-blue":"text-text-muted hover:text-text-secondary hover:bg-bg-light"),title:"SQL æŸ¥è¯¢",children:"</>"})]}),l?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-primary border-t-transparent rounded-full"})}):a?e.jsx("div",{className:"space-y-1",children:o.map(P=>e.jsx("button",{onClick:()=>ae(P.name),className:g("w-full px-3 py-2 rounded-lg text-left text-xs transition-all",i===P.name?"bg-accent-blue text-white shadow-sm shadow-accent-blue/30":"text-text-secondary hover:bg-bg-light"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-mono truncate",children:P.name}),e.jsx("span",{className:g("tabular-nums",i===P.name?"text-white/70":"text-text-muted"),children:P.rowCount!==null?P.rowCount.toLocaleString():"?"})]})},P.name))}):e.jsx("p",{className:"text-xs text-text-muted text-center py-4",children:"è¯·å…ˆé€‰æ‹©æ•°æ®åº“"})]})]}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:C?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-border bg-bg-dark/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:"SQL æŸ¥è¯¢"}),e.jsx("span",{className:"text-xs text-text-muted/50",children:"ï¼ˆä»…æ”¯æŒ SELECTï¼‰"})]}),e.jsx("textarea",{value:k,onChange:P=>E(P.target.value),placeholder:"SELECT * FROM table_name LIMIT 100",className:"w-full h-24 px-3 py-2 bg-bg-light border border-border rounded-lg text-sm font-mono text-text-primary placeholder:text-text-muted resize-none focus:outline-none focus:border-primary/50",onKeyDown:P=>{(P.metaKey||P.ctrlKey)&&P.key==="Enter"&&v(t)}}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:O&&e.jsxs(e.Fragment,{children:[O.rowCount," è¡Œ â€¢ ",O.executionTimeMs.toFixed(2)," ms"]})}),e.jsx("button",{onClick:()=>v(t),disabled:B||!k.trim(),className:"px-4 py-1.5 bg-primary text-white rounded text-xs font-medium hover:bg-primary/90 disabled:opacity-50 transition-colors",children:B?"æ‰§è¡Œä¸­...":"æ‰§è¡Œ (âŒ˜â†µ)"})]}),b&&e.jsx("div",{className:"mt-2 px-3 py-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400",children:b})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:B?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"})}):O?e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"sticky top-0 bg-bg-dark",children:e.jsx("tr",{children:O.columns.map(P=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-text-muted border-b border-border",children:P.name},P.name))})}),e.jsx("tbody",{className:"font-mono",children:O.rows.map((P,ue)=>e.jsx("tr",{className:"border-b border-border/30 hover:bg-bg-light/30 transition-colors",children:O.columns.map(ie=>e.jsx("td",{className:"px-3 py-2 text-text-secondary max-w-xs truncate",title:P.values[ie.name]??"",children:P.values[ie.name]===null?e.jsx("span",{className:"text-text-muted italic",children:"NULL"}):P.values[ie.name]},ie.name))},ue))})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-3 block opacity-50",children:"ğŸ“"}),e.jsx("p",{className:"text-sm",children:"è¾“å…¥ SQL æŸ¥è¯¢è¯­å¥å¹¶æ‰§è¡Œ"})]})})})]}):i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 border-b border-border bg-bg-dark/50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-mono text-sm text-text-primary",children:i}),x&&e.jsxs("span",{className:"text-xs text-text-muted",children:[((Q=x.totalRows)==null?void 0:Q.toLocaleString())??"?"," è¡Œ"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>_(!A),className:g("px-3 py-1.5 rounded text-xs transition-colors",A?"bg-purple-500/20 text-purple-400":I.length>0?"bg-purple-500/10 text-purple-400 hover:bg-purple-500/20":"bg-bg-light text-text-secondary hover:bg-bg-lighter"),title:"Protobuf é…ç½®",children:["ğŸ“¦ Protobuf ",I.length>0&&`(${I.length})`]}),e.jsx("button",{onClick:()=>S(!d),className:g("px-3 py-1.5 rounded text-xs transition-colors",d?"bg-primary/20 text-primary":"bg-bg-light text-text-secondary hover:bg-bg-lighter"),children:"ğŸ“‹ Schema"}),e.jsx("button",{onClick:()=>a&&i&&F(t,a,i),disabled:h,className:"px-3 py-1.5 bg-bg-light text-text-secondary rounded text-xs hover:bg-bg-lighter transition-colors disabled:opacity-50",children:"ğŸ”„ åˆ·æ–°"})]})]}),A&&e.jsx("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/30",children:e.jsx(Yi,{dbId:a,tableName:i,columns:c.map(P=>({name:P.name,type:P.type})),onClose:()=>_(!1)})}),d&&c.length>0&&e.jsx("div",{className:"px-4 py-3 border-b border-border bg-bg-dark/30",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-text-muted",children:[e.jsx("th",{className:"pb-2 font-medium",children:"åˆ—å"}),e.jsx("th",{className:"pb-2 font-medium",children:"ç±»å‹"}),e.jsx("th",{className:"pb-2 font-medium",children:"ä¸»é”®"}),e.jsx("th",{className:"pb-2 font-medium",children:"éç©º"}),e.jsx("th",{className:"pb-2 font-medium",children:"é»˜è®¤å€¼"})]})}),e.jsx("tbody",{className:"font-mono",children:c.map(P=>e.jsxs("tr",{className:"border-t border-border/30",children:[e.jsx("td",{className:"py-1.5 text-primary",children:P.name}),e.jsx("td",{className:"py-1.5 text-text-secondary",children:P.type||"-"}),e.jsx("td",{className:"py-1.5",children:P.primaryKey?"âœ“":""}),e.jsx("td",{className:"py-1.5",children:P.notNull?"âœ“":""}),e.jsx("td",{className:"py-1.5 text-text-muted",children:P.defaultValue||"-"})]},P.name))})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:h?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"})}):x?e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"sticky top-0 bg-bg-dark",children:e.jsx("tr",{children:x.columns.map(P=>e.jsx("th",{onClick:()=>L(P.name),className:"px-3 py-2 text-left font-medium text-text-muted border-b border-border cursor-pointer hover:bg-bg-light/50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:P.primaryKey?"text-primary":"",children:P.name}),y===P.name&&e.jsx("span",{className:"text-primary",children:R?"â†‘":"â†“"})]})},P.name))})}),e.jsx("tbody",{className:"font-mono",children:x.rows.map((P,ue)=>e.jsx("tr",{className:"border-b border-border/30 hover:bg-bg-light/30 transition-colors",children:x.columns.map(ie=>{var gt;const pe=P.values[ie.name],Ds=((gt=ie.type)==null?void 0:gt.toLowerCase())==="blob",Os=a&&i&&q(a,i,ie.name),Rs=Ds||pe&&Gi(pe)&&Os;return e.jsx("td",{className:"px-3 py-2 text-text-secondary max-w-xs",children:pe===null?e.jsx("span",{className:"text-text-muted italic",children:"NULL"}):Rs&&a&&i?e.jsx(Vi,{value:pe,dbId:a,tableName:i,columnName:ie.name}):e.jsx("span",{className:"truncate block",title:pe??"",children:pe})},ie.name)})},ue))})]}):w?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("span",{className:"text-4xl mb-3 opacity-50",children:"âš ï¸"}),e.jsx("p",{className:"text-sm text-red-400 mb-2",children:w}),e.jsx("button",{onClick:()=>a&&i&&F(t,a,i),className:"px-4 py-2 bg-primary/20 text-primary rounded-lg hover:bg-primary/30 transition-colors text-xs",children:"é‡è¯•"})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"æ— æ•°æ®"})}),x&&x.totalRows!==null&&x.totalRows>f&&e.jsxs("div",{className:"px-4 py-2 border-t border-border bg-bg-dark/50 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-text-muted",children:["ç¬¬ ",T," é¡µ / å…± ",Math.ceil(x.totalRows/f)," é¡µ"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Z(Math.max(1,T-1)),disabled:T<=1,className:"px-3 py-1 bg-bg-light text-text-secondary rounded text-xs hover:bg-bg-lighter disabled:opacity-50 transition-colors",children:"ä¸Šä¸€é¡µ"}),e.jsx("button",{onClick:()=>Z(T+1),disabled:T>=Math.ceil(x.totalRows/f),className:"px-3 py-1 bg-bg-light text-text-secondary rounded text-xs hover:bg-bg-lighter disabled:opacity-50 transition-colors",children:"ä¸‹ä¸€é¡µ"})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-3 block opacity-50",children:"ğŸ‘ˆ"}),e.jsx("p",{className:"text-sm",children:a?"é€‰æ‹©ä¸€ä¸ªè¡¨æŸ¥çœ‹æ•°æ®":"é€‰æ‹©ä¸€ä¸ªæ•°æ®åº“"})]})})})]})}function Qi(t){const s=m.useCallback(r=>{const n=r.target,a=n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.isContentEditable;for(const i of t){const o=r.key.toLowerCase()===i.key.toLowerCase(),l=i.shift?r.shiftKey:!r.shiftKey,c=i.alt?r.altKey:!r.altKey,d=i.ctrl?r.ctrlKey||r.metaKey:!r.ctrlKey&&!r.metaKey;if(o&&d&&l&&c){if(a&&!i.allowInInput)continue;r.preventDefault(),i.action();return}}},[t]);m.useEffect(()=>(window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)),[s])}const Xe=[{id:"http",label:"HTTP",icon:"ğŸŒ",description:"HTTP/HTTPS è¯·æ±‚",group:"monitor"},{id:"websocket",label:"WebSocket",icon:"ğŸ”Œ",description:"WS è¿æ¥",group:"monitor"},{id:"logs",label:"æ—¥å¿—",icon:"ğŸ“",description:"åº”ç”¨æ—¥å¿—",group:"monitor"},{id:"breakpoint",label:"æ–­ç‚¹",icon:"â¸ï¸",description:"è¯·æ±‚æ–­ç‚¹",group:"debug"},{id:"mock",label:"Mock",icon:"ğŸ­",description:"æ¥å£æ¨¡æ‹Ÿ",group:"debug"},{id:"chaos",label:"æ•…éšœæ³¨å…¥",icon:"ğŸ²",description:"æ•…éšœæ³¨å…¥",group:"debug"},{id:"database",label:"æ•°æ®åº“",icon:"ğŸ—ƒï¸",description:"SQLite æµè§ˆ",group:"data"}];function Ki(){const{deviceId:t}=Ms(),s=rt(),[r,n]=Fs(),a=r.get("tab"),i=(a==="network"?"http":a)||"http",[o,l]=m.useState(i),[c,d]=m.useState(!0),[x,h]=m.useState(!0),[w,T]=m.useState(!1),[f,y]=m.useState(!1),[R,C]=m.useState(!1),[k,O]=m.useState(!1),B=m.useCallback(L=>{l(L),n({tab:L},{replace:!0})},[n]),{currentDevice:b,selectDevice:$,clearSelection:Y,toggleCapture:W,clearDeviceData:G,toggleFavorite:j,isFavorite:F}=ze(),{setConnected:z,setInDeviceDetail:D}=_e(),S=Ue(L=>L.toggleTheme),{addActivity:u,clearActivities:N}=is(),p=at(),E=ts(),v=rs(),M=$r(),U=zr();Qi([...Xe.map((L,Z)=>({key:String(Z+1),ctrl:!0,description:`åˆ‡æ¢åˆ°${L.label}`,action:()=>B(L.id)})),{key:"k",ctrl:!0,description:"æœç´¢",action:()=>{const L=document.querySelector("[data-search-input]");L==null||L.focus()}},{key:"r",ctrl:!0,description:"åˆ·æ–°",action:()=>{t&&(o==="http"?p.fetchEvents(t):o==="logs"?E.fetchEvents(t):o==="websocket"?v.fetchSessions(t):o==="mock"&&M.fetchRules(t))}},{key:"l",ctrl:!0,description:"æ¸…ç©ºåˆ—è¡¨",action:()=>{o==="http"?p.clearEvents():o==="logs"&&E.clearEvents()}},{key:"t",ctrl:!0,description:"åˆ‡æ¢ä¸»é¢˜",action:S},{key:"/",ctrl:!0,description:"æ˜¾ç¤ºå¿«æ·é”®å¸®åŠ©",action:()=>T(!0)},{key:"Escape",description:"å–æ¶ˆé€‰æ‹©",action:()=>{w?T(!1):M.isEditorOpen?M.closeEditor():p.isSelectMode?p.toggleSelectMode():p.clearSelection()}},{key:"a",ctrl:!0,description:"å…¨é€‰",action:()=>{o==="http"&&p.isSelectMode&&p.selectAll()}},{key:"Backspace",description:"åˆ é™¤é€‰ä¸­",action:()=>{o==="http"&&p.isSelectMode&&p.selectedIds.size>0&&t&&p.batchDelete(t)}},{key:"f",description:"æ”¶è—",action:()=>{o==="http"&&p.isSelectMode&&p.selectedIds.size>0&&t&&p.batchFavorite(t,!0)}}]),m.useEffect(()=>{if(!t)return;D(!0),$(t),p.fetchEvents(t),E.fetchEvents(t),E.fetchFilterOptions(t),v.fetchSessions(t),M.fetchRules(t),Ie.connect(t);const L=Ie.onMessage(re=>{if(re.deviceId===t)switch(re.type){case"httpEvent":p.addRealtimeEvent(qr(re.payload));break;case"logEvent":E.addRealtimeEvent(Yr(re.payload));break;case"wsEvent":{const ee=Vr(re.payload);if(ee.type==="sessionCreated"){const Q=ee.data;v.addRealtimeSession({id:Q.id,url:Q.url,connectTime:Q.connectTime,disconnectTime:null,closeCode:null,closeReason:null,isOpen:!0})}else if(ee.type==="sessionClosed"){const Q=ee.data;v.updateSessionStatus(Q.id,!1,Q.closeCode,Q.closeReason)}else if(ee.type==="frame"){const Q=ee.data;v.sessions.some(ue=>ue.id===Q.sessionId)||(v.addRealtimeSession({id:Q.sessionId,url:"(loading...)",connectTime:Q.timestamp,disconnectTime:null,closeCode:null,closeReason:null,isOpen:!0}),Xt(t,Q.sessionId).then(ue=>{v.updateSessionUrl(Q.sessionId,ue.url)}).catch(()=>{v.updateSessionUrl(Q.sessionId,"(unknown)")}));const P=Q.payload?Math.floor(Q.payload.length*3/4):0;v.addRealtimeFrame({id:Q.id,sessionId:Q.sessionId,direction:Q.direction,opcode:Q.opcode,payloadPreview:Q.payloadPreview??null,payloadSize:P,timestamp:Q.timestamp,isMocked:Q.isMocked})}break}case"deviceConnected":{const ee=JSON.parse(re.payload);u({id:`${ee.sessionId}-connected`,deviceId:t,sessionId:ee.sessionId,timestamp:new Date().toISOString(),type:"connected",deviceName:ee.deviceName});break}case"deviceDisconnected":{u({id:`${Date.now()}-disconnected`,deviceId:t,sessionId:"",timestamp:new Date().toISOString(),type:"disconnected"});break}case"breakpointHit":{const ee=JSON.parse(re.payload);U.addHit(ee),B("breakpoint");break}}}),Z=Ie.onConnection(z);return()=>{L(),Z(),Ie.disconnect(),Y(),p.clearEvents(),E.clearEvents(),v.clearSessions(),M.clearRules(),U.clear(),N(),D(!1)}},[t]);const K=()=>{s("/")},I=m.useCallback(L=>{d(L),W(L,x)},[W,x]),q=m.useCallback(L=>{h(L),W(c,L)},[W,c]),A=m.useCallback(async()=>{await G(),p.clearEvents(),E.clearEvents(),v.clearSessions(),y(!1)},[G]),_=m.useCallback(L=>{t&&p.selectEvent(t,L)},[t]),X=m.useCallback(L=>{E.setFilter("traceId",L),B("logs")},[]),ae=m.useCallback((L,Z)=>{p.updateEventFavorite(L,Z)},[]);return t?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("header",{className:"px-6 py-5 bg-bg-dark border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("button",{onClick:K,className:"flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors group px-3 py-2 rounded hover:bg-bg-light",children:[e.jsx("span",{className:"group-hover:-translate-x-1 transition-transform text-lg",children:"â†"}),e.jsx("span",{className:"font-medium",children:"è¿”å›"})]}),e.jsx("div",{className:"h-8 w-px bg-border"}),e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center border border-border",children:e.jsx("span",{className:"text-2xl",children:b?it(b.deviceInfo.platform):"ğŸ“±"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-text-primary flex items-center gap-2",children:[(b==null?void 0:b.deviceInfo.deviceName)||"åŠ è½½ä¸­...",(b==null?void 0:b.deviceInfo.isSimulator)&&e.jsxs("span",{className:"text-sm px-2 py-0.5 rounded bg-purple-500/20 text-purple-400 border border-purple-500/30",title:"æ¨¡æ‹Ÿå™¨",children:[ot," æ¨¡æ‹Ÿå™¨"]}),t&&e.jsx("button",{onClick:()=>j(t),className:g("p-1 rounded transition-colors",F(t)?"text-yellow-400 hover:text-yellow-300":"text-text-muted hover:text-yellow-400"),title:F(t)?"å–æ¶ˆæ”¶è—":"æ”¶è—è®¾å¤‡",children:F(t)?"â­":"â˜†"})]}),b&&e.jsxs("p",{className:"text-sm text-text-muted mt-0.5",children:[b.deviceInfo.platform," ",b.deviceInfo.systemVersion," â€¢ ",e.jsx("span",{className:"text-text-secondary",children:b.deviceInfo.appName})]})]}),b&&e.jsxs("span",{className:g("badge ml-3 px-3 py-1",b.isOnline?"badge-success":"badge-danger"),children:[e.jsx("span",{className:g("w-2 h-2 rounded-full mr-2",b.isOnline?"bg-green-400":"bg-red-400")}),b.isOnline?"åœ¨çº¿":"ç¦»çº¿"]}),t&&e.jsx(Ei,{deviceId:t,isExpanded:k,onToggleExpand:()=>O(!k)})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-5 px-5 py-2.5 bg-bg-medium rounded-lg border border-border",children:[e.jsxs("label",{className:"flex items-center gap-2.5 text-sm cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:L=>I(L.target.checked),className:"accent-primary w-4 h-4"}),e.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors font-medium",children:"ğŸŒ ç½‘ç»œ"})]}),e.jsx("div",{className:"w-px h-5 bg-border"}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:L=>q(L.target.checked),className:"accent-primary w-4 h-4"}),e.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors font-medium",children:"ğŸ“ æ—¥å¿—"})]})]}),e.jsx("button",{onClick:()=>T(!0),className:"btn btn-ghost px-3.5 py-2.5 rounded",title:"å¿«æ·é”® (Ctrl+/)",children:"âŒ¨ï¸"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>C(!R),className:"btn btn-ghost px-3.5 py-2.5 rounded",title:"æ›´å¤šæ“ä½œ",children:"â‹®"}),R&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>C(!1)}),e.jsx("div",{className:"absolute right-0 top-full mt-2 w-52 bg-bg-dark border border-border rounded-lg shadow-lg z-50 overflow-hidden",children:e.jsxs("button",{onClick:()=>{C(!1),y(!0)},className:"w-full px-4 py-3.5 text-left text-sm text-red-400 hover:bg-red-500/10 flex items-center gap-3 transition-colors font-medium",children:[e.jsx("span",{children:"ğŸ—‘ï¸"}),e.jsx("span",{children:"æ¸…ç©ºè®¾å¤‡æ•°æ®"})]})})]})]})]})]})}),e.jsx("div",{className:"px-6 py-4 bg-bg-dark border-b border-border",children:e.jsx("div",{className:"flex items-center gap-1 p-1 bg-bg-medium rounded-lg border border-border w-fit",children:Xe.map((L,Z)=>{const re=Xe[Z-1],ee=re&&re.group!==L.group;return e.jsxs("div",{className:"flex items-center",children:[ee&&e.jsx("div",{className:"w-px h-6 bg-border mx-1"}),e.jsxs("button",{onClick:()=>B(L.id),title:`${L.description} (âŒ˜${Z+1})`,className:g("flex items-center gap-2 px-5 py-2.5 rounded text-sm font-medium transition-colors relative",o===L.id?"bg-primary text-bg-darkest":"text-text-secondary hover:text-text-primary hover:bg-bg-light"),children:[e.jsx("span",{className:"text-base",children:L.icon}),e.jsx("span",{children:L.label}),L.id==="breakpoint"&&U.pendingHits.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-orange-500 text-white text-xs rounded-full flex items-center justify-center animate-pulse",children:U.pendingHits.length})]})]},L.id)})})}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="http"&&e.jsx(Xi,{deviceId:t,httpStore:p,onSelectEvent:_,onShowRelatedLogs:X,onFavoriteChange:ae,onRefresh:()=>p.fetchEvents(t)}),o==="websocket"&&e.jsx(eo,{deviceId:t,wsStore:v}),o==="logs"&&e.jsx(Zi,{deviceId:t,logStore:E,onRefresh:()=>E.fetchEvents(t)}),o==="mock"&&e.jsx(to,{deviceId:t,mockStore:M}),o==="breakpoint"&&e.jsx(Ii,{deviceId:t,pendingHits:U.pendingHits,onResumeBreakpoint:(L,Z)=>U.resumeBreakpoint(t,L,Z)}),o==="chaos"&&e.jsx(Fi,{deviceId:t}),o==="database"&&e.jsx(Ji,{deviceId:t})]}),e.jsx(ci,{isOpen:w,onClose:()=>T(!1)}),e.jsx(pt,{isOpen:f,onClose:()=>y(!1),onConfirm:A,title:"æ¸…ç©ºè®¾å¤‡æ•°æ®",message:`ç¡®å®šè¦æ¸…ç©º "${(b==null?void 0:b.deviceInfo.deviceName)||"è¯¥è®¾å¤‡"}" çš„æ‰€æœ‰æ•°æ®å—ï¼Ÿ

è¿™å°†åˆ é™¤ï¼š
â€¢ æ‰€æœ‰ HTTP è¯·æ±‚è®°å½•
â€¢ æ‰€æœ‰æ—¥å¿—äº‹ä»¶
â€¢ æ‰€æœ‰ WebSocket ä¼šè¯

æ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,confirmText:"ç¡®è®¤æ¸…ç©º",cancelText:"å–æ¶ˆ",type:"danger"})]}):null}function Xi({deviceId:t,httpStore:s,onSelectEvent:r,onShowRelatedLogs:n,onFavoriteChange:a,onRefresh:i}){const[o,l]=m.useState(!1),c=()=>{const h=Array.from(s.selectedIds);h.length>0&&window.open(gr(t,h),"_blank")},d=m.useCallback(async()=>{await s.batchDelete(t),l(!1)},[t,s]),x=s.filteredItems.filter(h=>!("type"in h&&h.type==="session-divider")).length;return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-5 py-4 bg-bg-medium border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:i,className:"btn btn-secondary",title:"åˆ·æ–°åˆ—è¡¨ (Ctrl+R)",children:"åˆ·æ–°"}),e.jsx("div",{className:"h-7 w-px bg-border"}),e.jsx("button",{onClick:()=>s.toggleSelectMode(),className:g("btn",s.isSelectMode?"btn-primary":"btn-secondary"),title:s.isSelectMode?"é€€å‡ºé€‰æ‹©æ¨¡å¼":"è¿›å…¥é€‰æ‹©æ¨¡å¼",children:s.isSelectMode?"å–æ¶ˆé€‰æ‹©":"æ‰¹é‡é€‰æ‹©"}),s.isSelectMode&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>s.selectAll(),className:"btn btn-secondary",title:"å…¨é€‰/å–æ¶ˆå…¨é€‰",children:s.selectedIds.size===s.events.length?"å–æ¶ˆå…¨é€‰":"å…¨é€‰"}),e.jsxs("button",{onClick:()=>s.batchFavorite(t,!0),disabled:s.selectedIds.size===0,className:"btn bg-yellow-500/10 text-yellow-400 border border-yellow-500/20 hover:bg-yellow-500/20",title:"æ”¶è—é€‰ä¸­çš„è¯·æ±‚",children:["â­ æ”¶è— (",s.selectedIds.size,")"]}),e.jsxs("button",{onClick:c,disabled:s.selectedIds.size===0,className:"btn btn-secondary",title:"å¯¼å‡ºé€‰ä¸­çš„è¯·æ±‚ä¸º HAR",children:["å¯¼å‡º (",s.selectedIds.size,")"]}),e.jsxs("button",{onClick:()=>l(!0),disabled:s.selectedIds.size===0,className:"btn btn-danger",title:"åˆ é™¤é€‰ä¸­çš„è¯·æ±‚",children:["åˆ é™¤ (",s.selectedIds.size,")"]})]}),e.jsx("div",{className:"h-7 w-px bg-border"}),e.jsxs("select",{value:s.filters.method,onChange:h=>s.setFilter("method",h.target.value),className:"select",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰æ–¹æ³•"}),e.jsx("option",{value:"GET",children:"GET"}),e.jsx("option",{value:"POST",children:"POST"}),e.jsx("option",{value:"PUT",children:"PUT"}),e.jsx("option",{value:"DELETE",children:"DELETE"}),e.jsx("option",{value:"PATCH",children:"PATCH"})]}),e.jsx("input",{type:"text",value:s.filters.urlContains,onChange:h=>s.setFilter("urlContains",h.target.value),placeholder:"ğŸ” æœç´¢ URL...",className:"input w-60","data-search-input":!0}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors px-2",children:[e.jsx("input",{type:"checkbox",checked:s.filters.mockedOnly,onChange:h=>s.setFilter("mockedOnly",h.target.checked),className:"accent-primary w-4 h-4"}),"ä»… Mock"]}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors px-2",children:[e.jsx("input",{type:"checkbox",checked:s.filters.favoritesOnly,onChange:h=>s.setFilter("favoritesOnly",h.target.checked),className:"accent-primary w-4 h-4"}),"ä»…æ”¶è—"]}),e.jsx("div",{className:"h-6 w-px bg-border/50"}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors px-2",title:"æ˜¾ç¤ºè¢«é»‘åå•ç­–ç•¥éšè—çš„åŸŸå",children:[e.jsx("input",{type:"checkbox",checked:s.filters.showBlacklisted,onChange:h=>s.setFilter("showBlacklisted",h.target.checked),className:"accent-primary w-4 h-4"}),"æ˜¾ç¤ºé»‘åå•"]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("button",{onClick:()=>s.setFilter("statusRange",s.filters.statusRange==="400-599"?"":"400-599"),className:g("px-3 py-1.5 rounded-lg text-xs font-semibold border transition-all shadow-sm",s.filters.statusRange==="400-599"?"bg-red-500/20 text-red-400 border-red-500/10 shadow-red-500/10":"bg-bg-light text-text-secondary border-border-subtle hover:bg-bg-lighter hover:border-border-light"),children:"âš ï¸ Errors"})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light/70 px-3 py-1.5 rounded-lg border border-border-subtle font-medium",children:[x!==s.events.length?`${x} / ${s.events.length}`:`${s.events.length}`," ","æ¡è®°å½•"]}),e.jsxs("label",{className:"flex items-center gap-2.5 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.autoScroll,onChange:h=>s.setAutoScroll(h.target.checked),className:"accent-primary w-4 h-4"}),"è‡ªåŠ¨æ»šåŠ¨"]}),e.jsx("div",{className:"h-6 w-px bg-border/50"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-text-muted mr-1",children:"åˆ†ç»„:"}),["none","domain","path"].map(h=>e.jsx("button",{onClick:()=>s.setGroupMode(h),className:g("px-2 py-1 text-xs rounded transition-colors",s.groupMode===h?"bg-primary text-white":"bg-bg-light text-text-muted hover:text-text-secondary"),children:h==="none"?"æ— ":h==="domain"?"åŸŸå":"è·¯å¾„"},h))]}),e.jsx("div",{className:"h-6 w-px bg-border/50"}),e.jsx("a",{href:fr(t),target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary",children:"å¯¼å‡ºå…¨éƒ¨"}),e.jsx("button",{onClick:()=>s.clearEvents(),className:"btn btn-ghost text-text-muted hover:text-text-secondary",title:"æ¸…ç©ºå½“å‰åˆ—è¡¨ï¼ˆä¸åˆ é™¤æ•°æ®åº“ï¼‰",children:"æ¸…å±"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 min-w-[400px] border-r border-border flex flex-col",children:s.groupMode==="none"?e.jsx(Pa,{items:s.filteredItems,selectedId:s.selectedEventId,onSelect:r,autoScroll:s.autoScroll,deviceId:t,isSelectMode:s.isSelectMode,selectedIds:s.selectedIds,onToggleSelect:s.toggleSelectId}):e.jsx(Ba,{events:s.filteredItems.filter(h=>!("type"in h&&h.type==="session-divider")),groupMode:s.groupMode,selectedId:s.selectedEventId,onSelect:r,deviceId:t,isSelectMode:s.isSelectMode,selectedIds:s.selectedIds,onToggleSelect:s.toggleSelectId})}),e.jsx("div",{className:"w-[45%] min-w-[400px] bg-bg-dark/50",children:e.jsx(ti,{event:s.selectedEvent,deviceId:t,onShowRelatedLogs:n,onFavoriteChange:a})})]}),e.jsx(pt,{isOpen:o,onClose:()=>l(!1),onConfirm:d,title:"åˆ é™¤ HTTP è¯·æ±‚",message:`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${s.selectedIds.size} ä¸ª HTTP è¯·æ±‚å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,confirmText:"ç¡®è®¤åˆ é™¤",cancelText:"å–æ¶ˆ",type:"danger"})]})}function Zi({deviceId:t,logStore:s,onRefresh:r}){const n=s.filteredEvents.length,a=s.events.length;return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 bg-bg-medium/50 border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"btn btn-secondary",title:"åˆ·æ–°åˆ—è¡¨ (Ctrl+R)",children:"åˆ·æ–°"}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx(oi,{minLevel:s.filters.minLevel,subsystems:s.subsystems,categories:s.categories,selectedSubsystem:s.filters.subsystem,selectedCategory:s.filters.category,searchText:s.filters.text,searchQuery:s.filters.searchQuery,onMinLevelChange:s.setMinLevel,onSubsystemChange:i=>s.setFilter("subsystem",i),onCategoryChange:i=>s.setFilter("category",i),onSearchChange:i=>s.setFilter("text",i),onSearchQueryChange:s.setSearchQuery})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light px-2 py-1 rounded-lg",children:[n!==a?`${n} / ${a}`:`${a}`," æ¡è®°å½•"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.autoScroll,onChange:i=>s.setAutoScroll(i.target.checked),className:"accent-primary"}),"è‡ªåŠ¨æ»šåŠ¨"]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("a",{href:pr(t),target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary",children:"å¯¼å‡º"}),e.jsx("button",{onClick:()=>s.clearEvents(),className:"btn btn-ghost text-text-muted hover:text-text-secondary",title:"æ¸…ç©ºå½“å‰åˆ—è¡¨ï¼ˆä¸åˆ é™¤æ•°æ®åº“ï¼‰",children:"æ¸…å±"})]})]}),e.jsx(ai,{events:s.filteredEvents,autoScroll:s.autoScroll})]})}function eo({deviceId:t,wsStore:s}){const r=m.useRef(null),[n,a]=m.useState(!1),i=m.useCallback(async()=>{await s.batchDelete(t),a(!1)},[t,s]),o=m.useCallback(h=>{s.selectSession(t,h)},[t]),l=m.useCallback(()=>{s.selectedSessionId&&s.loadMoreFrames(t,s.selectedSessionId)},[t,s.selectedSessionId]),c=m.useCallback(h=>{s.setFrameDirection(h),s.selectedSessionId&&s.fetchFrames(t,s.selectedSessionId)},[t,s.selectedSessionId]),d=m.useCallback(h=>{s.setFilter("urlContains",h),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{s.fetchSessions(t)},300)},[t]),x=m.useCallback(h=>{s.setFilter("isOpen",h===""?void 0:h==="true"),s.fetchSessions(t)},[t]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 bg-bg-medium/50 border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>s.fetchSessions(t),className:"btn btn-secondary",title:"åˆ·æ–°åˆ—è¡¨",children:"åˆ·æ–°"}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("button",{onClick:()=>s.toggleSelectMode(),className:g("btn",s.isSelectMode?"btn-primary":"btn-secondary"),title:s.isSelectMode?"é€€å‡ºé€‰æ‹©æ¨¡å¼":"è¿›å…¥é€‰æ‹©æ¨¡å¼",children:s.isSelectMode?"å–æ¶ˆé€‰æ‹©":"æ‰¹é‡é€‰æ‹©"}),s.isSelectMode&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>s.selectAll(),className:"btn btn-secondary",title:"å…¨é€‰/å–æ¶ˆå…¨é€‰",children:s.selectedIds.size===s.sessions.length?"å–æ¶ˆå…¨é€‰":"å…¨é€‰"}),e.jsxs("button",{onClick:()=>a(!0),disabled:s.selectedIds.size===0,className:"btn btn-danger",title:"åˆ é™¤é€‰ä¸­çš„ä¼šè¯",children:["åˆ é™¤ (",s.selectedIds.size,")"]})]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("input",{type:"text",value:s.filters.urlContains||"",onChange:h=>d(h.target.value),placeholder:"æœç´¢ URL...",className:"input w-56"}),e.jsxs("select",{value:s.filters.isOpen===void 0?"":String(s.filters.isOpen),onChange:h=>x(h.target.value),className:"select",children:[e.jsx("option",{value:"",children:"æ‰€æœ‰çŠ¶æ€"}),e.jsx("option",{value:"true",children:"è¿æ¥ä¸­"}),e.jsx("option",{value:"false",children:"å·²å…³é—­"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light px-2 py-1 rounded-lg",children:[s.totalSessions," ä¸ªä¼šè¯"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-text-secondary cursor-pointer hover:text-text-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:s.autoScroll,onChange:h=>s.setAutoScroll(h.target.checked),className:"accent-primary"}),"è‡ªåŠ¨æ»šåŠ¨"]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsx("button",{onClick:()=>s.clearSessions(),className:"btn btn-ghost text-text-muted hover:text-text-secondary",title:"æ¸…ç©ºå½“å‰åˆ—è¡¨ï¼ˆä¸åˆ é™¤æ•°æ®åº“ï¼‰",children:"æ¸…å±"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"w-[40%] min-w-[300px] border-r border-border",children:e.jsx(di,{sessions:s.sessions,selectedId:s.selectedSessionId,onSelect:o,loading:s.sessionsLoading,autoScroll:s.autoScroll,isSelectMode:s.isSelectMode,selectedIds:s.selectedIds,onToggleSelect:s.toggleSelectId})}),e.jsx("div",{className:"flex-1 min-w-[400px] bg-bg-dark/50",children:e.jsx(xi,{deviceId:t,session:s.selectedSession,frames:s.frames,loading:s.framesLoading,onLoadMore:l,hasMore:s.frames.length<s.totalFrames,frameDirection:s.frameDirection,onFrameDirectionChange:c})})]}),e.jsx(pt,{isOpen:n,onClose:()=>a(!1),onConfirm:i,title:"åˆ é™¤ WebSocket ä¼šè¯",message:`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${s.selectedIds.size} ä¸ª WebSocket ä¼šè¯å—ï¼Ÿ

æ­¤æ“ä½œå°†åŒæ—¶åˆ é™¤è¿™äº›ä¼šè¯çš„æ‰€æœ‰å¸§æ•°æ®ï¼Œä¸å¯æ¢å¤ã€‚`,confirmText:"ç¡®è®¤åˆ é™¤",cancelText:"å–æ¶ˆ",type:"danger"})]})}function to({deviceId:t,mockStore:s}){const r=m.useCallback(()=>{s.openEditor()},[]),n=m.useCallback(l=>{s.openEditor(l)},[]),a=m.useCallback(l=>{s.deleteRule(t,l)},[t]),i=m.useCallback(l=>{s.toggleRuleEnabled(t,l)},[t]),o=m.useCallback(async l=>{s.editingRule?await s.updateRule(t,s.editingRule.id,l):await s.createRule(t,l)},[t,s.editingRule]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 bg-bg-medium/50 border-b border-border flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>s.fetchRules(t),className:"btn btn-secondary",children:"åˆ·æ–°"}),e.jsxs("span",{className:"text-xs text-text-muted bg-bg-light px-2 py-1 rounded-lg",children:[s.rules.length," æ¡è§„åˆ™"]})]}),e.jsx("button",{onClick:r,className:"btn bg-primary text-white hover:bg-primary-dark",children:"+ åˆ›å»ºè§„åˆ™"})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(vi,{rules:s.rules,loading:s.loading,onEdit:n,onDelete:a,onToggleEnabled:i,onCreateNew:r})}),e.jsx(Si,{rule:s.editingRule,isOpen:s.isEditorOpen,onClose:s.closeEditor,onSave:o,loading:s.loading})]})}function so({device:t,style:s}){const r=rt(),{favoriteDeviceIds:n,toggleFavorite:a}=ze(),i=n.has(t.deviceId),o=l=>{l.stopPropagation(),a(t.deviceId)};return e.jsxs("div",{onClick:()=>r(`/device/${t.deviceId}`),className:g("glass-card p-5 cursor-pointer transition-all group animate-fadeIn card-interactive",t.isOnline?"hover:border-primary":"opacity-75"),style:s,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:g("w-12 h-12 rounded-xl flex items-center justify-center text-2xl",t.isOnline?"bg-primary/10":"bg-bg-medium"),children:it(t.platform)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-text-primary group-hover:text-primary transition-colors line-clamp-1",children:t.deviceName}),e.jsxs("p",{className:"text-xs text-text-muted line-clamp-1",children:[t.platform," ",t.systemVersion]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.isSimulator&&e.jsxs("span",{className:"badge bg-purple-500/20 text-purple-400 border-purple-500/30",title:"æ¨¡æ‹Ÿå™¨",children:[ot," æ¨¡æ‹Ÿå™¨"]}),e.jsx("button",{onClick:o,className:g("p-1.5 rounded transition-all",i?"text-yellow-400 hover:text-yellow-300":"text-text-muted opacity-0 group-hover:opacity-100 hover:text-yellow-400"),title:i?"å–æ¶ˆæ”¶è—":"æ”¶è—è®¾å¤‡",children:i?"â­":"â˜†"}),e.jsxs("span",{className:g("badge",t.isOnline?"badge-success":"badge-danger"),children:[e.jsx("span",{className:g("w-1.5 h-1.5 rounded-full mr-1.5",t.isOnline?"bg-green-400 status-dot-online":"bg-red-400")}),t.isOnline?"åœ¨çº¿":"ç¦»çº¿"]})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-bg-medium/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:"ğŸ“¦"}),e.jsx("span",{className:"text-sm font-medium text-text-primary line-clamp-1",children:t.appName})]}),e.jsxs("p",{className:"text-xs text-text-muted pl-6",children:["ç‰ˆæœ¬ ",t.appVersion," (",t.buildNumber,")"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-text-muted",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"â±ï¸"}),e.jsxs("span",{children:["æœ€åæ´»åŠ¨: ",js(t.lastSeenAt)]})]}),e.jsx("span",{className:"text-primary opacity-0 group-hover:opacity-100 transition-opacity",children:"æŸ¥çœ‹è¯¦æƒ… â†’"})]})]})}function ro(){const{devices:t,isLoading:s,fetchDevices:r}=ze(),n=t.filter(a=>a.isOnline).length;return m.useEffect(()=>{r();const a=setInterval(r,5e3);return()=>clearInterval(a)},[r]),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("header",{className:"px-6 py-5 bg-bg-dark border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"è®¾å¤‡åˆ—è¡¨"}),e.jsxs("p",{className:"text-sm text-text-muted mt-1",children:["ç®¡ç†å·²è¿æ¥çš„è°ƒè¯•è®¾å¤‡ Â· ",n," åœ¨çº¿ / ",t.length," æ€»è®¡"]})]}),e.jsxs("button",{onClick:r,disabled:s,className:"btn btn-primary disabled:opacity-50",children:[e.jsx("span",{className:s?"animate-spin":"",children:"ğŸ”„"}),e.jsx("span",{children:"åˆ·æ–°"})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:t.map((a,i)=>e.jsx(so,{device:a,style:{animationDelay:`${i*50}ms`}},a.deviceId))}):e.jsx(no,{isLoading:s})})]})}function no({isLoading:t}){return e.jsx("div",{className:"flex flex-col items-center justify-center h-full",children:e.jsx("div",{className:"glass-card p-12 text-center max-w-md",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-bg-light animate-pulse"}),e.jsx("div",{className:"h-6 bg-bg-light rounded w-48 mx-auto mb-3 animate-pulse"}),e.jsx("div",{className:"h-4 bg-bg-light rounded w-64 mx-auto animate-pulse"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-bg-light flex items-center justify-center",children:e.jsx("span",{className:"text-4xl opacity-50",children:"ğŸ“±"})}),e.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-2",children:"æš‚æ— åœ¨çº¿è®¾å¤‡"}),e.jsx("p",{className:"text-sm text-text-muted mb-6",children:"è¯·ç¡®ä¿ iOS App å·²é›†æˆ DebugProbe å¹¶è¿æ¥åˆ° Debug Hub"}),e.jsxs("div",{className:"text-left bg-bg-medium rounded-xl p-4 text-xs font-mono text-text-secondary overflow-x-auto",children:[e.jsx("p",{className:"text-text-muted mb-2",children:"// åœ¨ AppDelegate ä¸­åˆå§‹åŒ–"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-purple-400",children:"let"})," config = ",e.jsx("span",{className:"text-primary",children:"DebugProbe.Configuration"}),"("]}),e.jsxs("p",{className:"pl-4",children:["hubURL: ",e.jsxs("span",{className:"text-green-400",children:['"ws://',"<","host",">",':8081/debug-bridge"']})]}),e.jsx("p",{children:")"}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"text-primary",children:"DebugProbe"}),".shared.start(configuration: config)"]})]})]})})})}const ao=[{icon:"ğŸ“±",title:"è®¾å¤‡ç®¡ç†",endpoints:[{method:"GET",path:"/api/devices",description:"è·å–åœ¨çº¿è®¾å¤‡åˆ—è¡¨"},{method:"GET",path:"/api/devices/:deviceId",description:"è·å–è®¾å¤‡è¯¦æƒ…"},{method:"POST",path:"/api/devices/:deviceId/control/toggle-capture",description:"åˆ‡æ¢æ•è·çŠ¶æ€"},{method:"DELETE",path:"/api/devices/:deviceId/data",description:"æ¸…ç©ºè®¾å¤‡æ•°æ®"}]},{icon:"ğŸŒ",title:"HTTP äº‹ä»¶",endpoints:[{method:"GET",path:"/api/devices/:deviceId/http-events",description:"è·å– HTTP äº‹ä»¶åˆ—è¡¨"},{method:"GET",path:"/api/devices/:deviceId/http-events/:eventId",description:"è·å– HTTP äº‹ä»¶è¯¦æƒ…"},{method:"POST",path:"/api/devices/:deviceId/http-events/:eventId/replay",description:"é‡æ”¾ HTTP è¯·æ±‚"},{method:"PUT",path:"/api/devices/:deviceId/http-events/:eventId/favorite",description:"æ”¶è—/å–æ¶ˆæ”¶è—"}]},{icon:"ğŸ“",title:"æ—¥å¿—äº‹ä»¶",endpoints:[{method:"GET",path:"/api/devices/:deviceId/log-events",description:"è·å–æ—¥å¿—äº‹ä»¶åˆ—è¡¨"}]},{icon:"ğŸ”Œ",title:"WebSocket ä¼šè¯",endpoints:[{method:"GET",path:"/api/devices/:deviceId/ws-sessions",description:"è·å– WebSocket ä¼šè¯åˆ—è¡¨"},{method:"GET",path:"/api/devices/:deviceId/ws-sessions/:sessionId/frames",description:"è·å– WebSocket å¸§æ•°æ®"}]},{icon:"ğŸ­",title:"Mock è§„åˆ™",endpoints:[{method:"GET",path:"/api/devices/:deviceId/mock-rules",description:"è·å– Mock è§„åˆ™åˆ—è¡¨"},{method:"POST",path:"/api/devices/:deviceId/mock-rules",description:"åˆ›å»º Mock è§„åˆ™"},{method:"PUT",path:"/api/devices/:deviceId/mock-rules/:ruleId",description:"æ›´æ–° Mock è§„åˆ™"},{method:"DELETE",path:"/api/devices/:deviceId/mock-rules/:ruleId",description:"åˆ é™¤ Mock è§„åˆ™"}]},{icon:"â¸ï¸",title:"æ–­ç‚¹è°ƒè¯•",endpoints:[{method:"GET",path:"/api/devices/:deviceId/breakpoints",description:"è·å–æ–­ç‚¹è§„åˆ™åˆ—è¡¨"},{method:"POST",path:"/api/devices/:deviceId/breakpoints",description:"åˆ›å»ºæ–­ç‚¹è§„åˆ™"}]},{icon:"ğŸ’¥",title:"æ•…éšœæ³¨å…¥",endpoints:[{method:"GET",path:"/api/devices/:deviceId/chaos-rules",description:"è·å–æ•…éšœæ³¨å…¥è§„åˆ™"},{method:"POST",path:"/api/devices/:deviceId/chaos-rules",description:"åˆ›å»ºæ•…éšœæ³¨å…¥è§„åˆ™"}]},{icon:"ğŸ“¤",title:"æ•°æ®å¯¼å‡º",endpoints:[{method:"GET",path:"/api/export/har/:deviceId",description:"å¯¼å‡º HAR æ–‡ä»¶"},{method:"GET",path:"/api/devices/:deviceId/http-events/:eventId/curl",description:"å¯¼å‡º cURL å‘½ä»¤"}]},{icon:"ğŸ”—",title:"WebSocket è¿æ¥",endpoints:[{method:"WS",path:"/debug-bridge",description:"iOS è®¾å¤‡è¿æ¥ç«¯ç‚¹"},{method:"WS",path:"/ws/live",description:"å®æ—¶äº‹ä»¶æµè®¢é˜…"}]},{icon:"ğŸ§¹",title:"æ•°æ®ç®¡ç†",endpoints:[{method:"GET",path:"/api/cleanup/config",description:"è·å–æ¸…ç†é…ç½®"},{method:"PUT",path:"/api/cleanup/config",description:"æ›´æ–°æ¸…ç†é…ç½®"},{method:"POST",path:"/api/cleanup/run",description:"æ‰§è¡Œè¿‡æœŸæ•°æ®æ¸…ç†"},{method:"POST",path:"/api/cleanup/truncate",description:"æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼ˆå±é™©ï¼‰"}]},{icon:"ğŸ’š",title:"ç³»ç»ŸçŠ¶æ€",endpoints:[{method:"GET",path:"/api/health",description:"å¥åº·æ£€æŸ¥"}]}],io={GET:"bg-green-500/20 text-green-400",POST:"bg-blue-500/20 text-blue-400",PUT:"bg-yellow-500/20 text-yellow-400",DELETE:"bg-red-500/20 text-red-400",WS:"bg-purple-500/20 text-purple-400"};function oo(){return e.jsx("div",{className:"h-full overflow-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-12",children:[e.jsxs("header",{className:"text-center mb-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”"}),e.jsx("h1",{className:"text-4xl font-bold mb-2 text-text-primary",children:"Debug Hub API"}),e.jsx("p",{className:"text-text-secondary text-lg mb-4",children:"ç½‘ç»œå’Œæ—¥å¿—ä¸€ä½“åŒ–è°ƒè¯•å¹³å°"}),e.jsx("span",{className:"inline-block px-4 py-1 bg-bg-light rounded text-sm text-primary border border-border",children:"v1.0.0"}),e.jsxs("nav",{className:"flex justify-center gap-4 mt-6",children:[e.jsx(de,{to:"/",className:"text-text-secondary hover:text-primary transition-colors px-4 py-2 rounded hover:bg-bg-light",children:"ğŸ“± è®¾å¤‡åˆ—è¡¨"}),e.jsx(de,{to:"/health",className:"text-text-secondary hover:text-primary transition-colors px-4 py-2 rounded hover:bg-bg-light",children:"ğŸ’š å¥åº·æ£€æŸ¥"})]})]}),e.jsx("div",{className:"space-y-6",children:ao.map(t=>e.jsxs("section",{className:"bg-bg-dark border border-border rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-bg-medium border-b border-border flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsx("h2",{className:"text-lg font-semibold",children:t.title})]}),e.jsx("div",{className:"p-2",children:t.endpoints.map(s=>e.jsxs("div",{className:"flex items-center gap-4 px-4 py-3 rounded-lg hover:bg-bg-medium transition-colors",children:[e.jsx("span",{className:`font-mono text-xs font-bold px-2 py-1 rounded min-w-[60px] text-center ${io[s.method]}`,children:s.method}),e.jsx("code",{className:"font-mono text-sm text-text-primary flex-1",children:s.path}),e.jsx("span",{className:"text-text-secondary text-sm",children:s.description})]},`${s.method}-${s.path}`))})]},t.title))}),e.jsxs("section",{className:"mt-8 bg-bg-dark border border-border rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-bg-medium border-b border-border flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ğŸš€"}),e.jsx("h2",{className:"text-lg font-semibold",children:"å¿«é€Ÿå¼€å§‹"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-sm mb-2",children:"è·å–è®¾å¤‡åˆ—è¡¨ï¼š"}),e.jsx("pre",{className:"bg-bg-darkest border border-border rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsxs("code",{children:[e.jsx("span",{className:"text-info",children:"curl"})," ",e.jsx("span",{className:"text-green-400",children:"http://localhost:8081/api/devices"})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary text-sm mb-2",children:"è¿æ¥å®æ—¶äº‹ä»¶æµï¼š"}),e.jsx("pre",{className:"bg-bg-darkest border border-border rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsxs("code",{children:[e.jsx("span",{className:"text-info",children:"websocat"})," ",e.jsx("span",{className:"text-green-400",children:"ws://localhost:8081/ws/live"})]})})]})]})]}),e.jsx("footer",{className:"text-center mt-12 py-8 text-text-secondary text-sm",children:e.jsx("p",{children:"Debug Hub Â© 2025 Sun. All rights reserved."})})]})})}function lo({isOpen:t,onClose:s,onConfirm:r,title:n,message:a,confirmWord:i="DELETE",confirmText:o="ç¡®è®¤åˆ é™¤",cancelText:l="å–æ¶ˆ",loading:c=!1}){const[d,x]=m.useState(""),h=d===i;if(m.useEffect(()=>{t||x("")},[t]),!t)return null;const w=()=>{h&&!c&&r()},T=f=>{f.key==="Enter"&&h&&w(),f.key==="Escape"&&s()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-lg shadow-lg w-[440px] overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border bg-red-500/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-red-500/15",children:e.jsx("span",{className:"text-xl",children:"âš ï¸"})}),e.jsx("h3",{className:"text-lg font-bold text-red-400",children:n})]})}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("p",{className:"text-text-secondary whitespace-pre-line mb-4",children:a}),e.jsxs("div",{className:"bg-bg-medium rounded-lg p-4 border border-border",children:[e.jsxs("p",{className:"text-sm text-text-muted mb-2",children:["è¯·è¾“å…¥ ",e.jsx("code",{className:"px-1.5 py-0.5 bg-red-500/10 text-red-400 rounded font-mono font-bold",children:i})," ä»¥ç¡®è®¤æ“ä½œï¼š"]}),e.jsx("input",{type:"text",value:d,onChange:f=>x(f.target.value),onKeyDown:T,placeholder:i,autoFocus:!0,className:g("w-full px-3 py-2 bg-bg-dark border rounded text-text-primary font-mono focus:outline-none transition-colors",d===i?"border-green-500 focus:border-green-400":d.length>0?"border-red-500/50 focus:border-red-400":"border-border focus:border-primary")}),d.length>0&&d!==i&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:"è¾“å…¥ä¸åŒ¹é…"})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-border bg-bg-medium/30 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,disabled:c,className:"px-4 py-2 rounded-lg text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-bg-light transition-all disabled:opacity-50",children:l}),e.jsx("button",{onClick:w,disabled:!h||c,className:g("px-4 py-2 rounded-lg text-sm font-medium text-white transition-all",h?"bg-red-500 hover:bg-red-600":"bg-red-500/30 cursor-not-allowed",c&&"opacity-50"),children:c?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"å¤„ç†ä¸­..."]}):o})]})]})})}function co(t){const s=Math.floor(t/86400),r=Math.floor(t%86400/3600),n=Math.floor(t%3600/60),a=t%60,i=o=>o.toString().padStart(2,"0");return s>0?`${s}å¤© ${i(r)}:${i(n)}:${i(a)}`:`${i(r)}:${i(n)}:${i(a)}`}function uo(t){try{return new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return t}}function mo(){var y;const[t,s]=m.useState(null),[r,n]=m.useState(null),[a,i]=m.useState(new Date),[o,l]=m.useState("--:--:--"),[c,d]=m.useState(!1),[x,h]=m.useState(!1),w=m.useRef(null);m.useEffect(()=>{async function R(){try{const k=await fetch("/api/health",{headers:{Accept:"application/json"}});if(!k.ok)throw new Error("Failed to fetch health status");const O=await k.json();if(s(O),n(null),O.startTime){const B=new Date(O.startTime);w.current=B.getTime()}}catch(k){n(k instanceof Error?k.message:"Unknown error")}}R();const C=setInterval(R,3e4);return()=>clearInterval(C)},[]),m.useEffect(()=>{const R=()=>{if(i(new Date),w.current){const k=Math.floor((Date.now()-w.current)/1e3);l(co(Math.max(0,k)))}};R();const C=setInterval(R,1e3);return()=>clearInterval(C)},[]);const T=!r&&(t==null?void 0:t.status)==="healthy",f=async()=>{h(!0);try{await ar(),d(!1),alert("æ‰€æœ‰æ•°æ®å·²æ¸…ç©º")}catch(R){alert("æ¸…ç©ºæ•°æ®å¤±è´¥: "+(R instanceof Error?R.message:"æœªçŸ¥é”™è¯¯"))}finally{h(!1)}};return e.jsxs("div",{className:"h-full overflow-auto flex items-center justify-center p-6",children:[e.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent-blue/5 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"max-w-lg w-full relative",children:[e.jsxs("div",{className:"glass-card p-10 text-center",children:[e.jsxs("div",{className:`w-28 h-28 mx-auto mb-8 rounded-full flex items-center justify-center text-5xl relative ${r?"bg-red-500/10":"bg-green-500/10"}`,children:[e.jsx("div",{className:`absolute inset-0 rounded-full animate-ping opacity-25 ${r?"bg-red-500":"bg-green-500"}`,style:{animationDuration:"2s"}}),e.jsx("span",{className:"relative z-10",children:r?"âŒ":"ğŸ’š"})]}),e.jsx("h1",{className:`text-3xl font-bold mb-3 ${r?"text-red-400":"text-green-400"}`,children:r?"æœåŠ¡å¼‚å¸¸":"æœåŠ¡æ­£å¸¸è¿è¡Œ"}),e.jsx("p",{className:"text-text-secondary mb-10",children:r||"Debug Hub æ‰€æœ‰ç³»ç»Ÿè¿è¡Œæ­£å¸¸"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-10",children:[e.jsx(Le,{label:"çŠ¶æ€",value:((y=t==null?void 0:t.status)==null?void 0:y.toUpperCase())||"--",icon:"ğŸŸ¢",highlight:T}),e.jsx(Le,{label:"ç‰ˆæœ¬",value:(t==null?void 0:t.version)||"--",icon:"ğŸ“¦"}),e.jsx(Le,{label:"è¿è¡Œæ—¶é—´",value:o,icon:"â±ï¸",mono:!0}),e.jsx(Le,{label:"å½“å‰æ—¶é—´",value:a.toLocaleTimeString("zh-CN"),icon:"ğŸ•",mono:!0})]}),(t==null?void 0:t.startTime)&&e.jsxs("div",{className:"text-xs text-text-muted mb-8 p-3 bg-bg-medium/50 rounded-xl",children:[e.jsx("span",{className:"opacity-70",children:"æœåŠ¡å¯åŠ¨äº:"}),e.jsx("span",{className:"ml-2 font-mono text-text-secondary",children:uo(t.startTime)})]}),e.jsxs("nav",{className:"flex justify-center gap-3 mb-6",children:[e.jsx(de,{to:"/",className:"btn btn-secondary",children:"ğŸ“± è®¾å¤‡åˆ—è¡¨"}),e.jsx(de,{to:"/api-docs",className:"btn btn-secondary",children:"ğŸ“š API æ–‡æ¡£"})]}),e.jsxs("div",{className:"pt-6 border-t border-border",children:[e.jsx("p",{className:"text-xs text-text-muted mb-3",children:"å±é™©æ“ä½œ"}),e.jsx("button",{onClick:()=>d(!0),className:"btn bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20",children:"ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®"})]})]}),e.jsx("p",{className:"text-center mt-8 text-text-muted text-sm",children:e.jsx("span",{className:"opacity-70",children:"Debug Hub Â© 2025 Sun"})})]}),e.jsx(lo,{isOpen:c,title:"æ¸…ç©ºæ‰€æœ‰æ•°æ®",message:"æ­¤æ“ä½œå°†åˆ é™¤æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬æ‰€æœ‰è®¾å¤‡çš„ HTTP äº‹ä»¶ã€æ—¥å¿—ã€WebSocket ä¼šè¯ç­‰ã€‚æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼",confirmWord:"DELETE",confirmText:"ç¡®è®¤æ¸…ç©º",loading:x,onConfirm:f,onClose:()=>d(!1)})]})}function Le({label:t,value:s,icon:r,mono:n=!1,highlight:a=!1}){return e.jsxs("div",{className:`bg-bg-medium/50 rounded-xl p-4 border border-border transition-all ${a?"border-green-500/30":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-sm",children:r}),e.jsx("span",{className:"text-xs text-text-muted uppercase tracking-wider",children:t})]}),e.jsx("div",{className:`text-xl font-semibold text-primary ${n?"font-mono":""}`,children:s})]})}function xo(){const{rules:t,fetchRules:s,createOrUpdateRule:r,deleteRule:n,isLoading:a}=Oe(),[i,o]=m.useState(null),[l,c]=m.useState(!1);m.useEffect(()=>{s()},[]);const d=()=>{o({name:"",matchType:"domain",matchValue:"",action:"highlight",isEnabled:!0,priority:0}),c(!0)},x=f=>{o({...f}),c(!0)},h=async()=>{if(i)try{await r(i),c(!1),o(null)}catch(f){console.error("Failed to save rule",f)}},w=async f=>{confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡è§„åˆ™å—ï¼Ÿ")&&await n(f)},T=async f=>{await r({...f,isEnabled:!f.isEnabled})};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("header",{className:"px-6 py-4 bg-bg-dark border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(de,{to:"/",className:"flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors group",children:[e.jsx("span",{className:"group-hover:-translate-x-1 transition-transform",children:"â†"}),e.jsx("span",{children:"è¿”å›"})]}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center border border-border",children:e.jsx("span",{className:"text-lg",children:"âš™ï¸"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Traffic Rules"}),e.jsx("p",{className:"text-xs text-text-muted",children:"ç®¡ç†åŸŸåé«˜äº®ã€éšè—ç­‰è¿‡æ»¤è§„åˆ™"})]})]}),e.jsx("button",{onClick:d,className:"btn btn-primary",children:"+ æ–°å»ºè§„åˆ™"})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:a?e.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:"åŠ è½½ä¸­..."}):t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ğŸ“‹"}),e.jsx("h2",{className:"text-lg font-medium text-text-primary mb-2",children:"æš‚æ— è§„åˆ™"}),e.jsx("p",{className:"text-sm mb-4",children:'ç‚¹å‡»"æ–°å»ºè§„åˆ™"æ·»åŠ æµé‡è¿‡æ»¤è§„åˆ™'}),e.jsx("button",{onClick:d,className:"btn btn-primary",children:"+ æ–°å»ºè§„åˆ™"})]}):e.jsx("div",{className:"space-y-3",children:t.map(f=>e.jsx("div",{className:g("p-4 bg-bg-dark border border-border rounded-xl transition-all",!f.isEnabled&&"opacity-50"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>T(f),className:g("w-10 h-6 rounded-full transition-colors relative",f.isEnabled?"bg-primary":"bg-bg-light"),children:e.jsx("span",{className:g("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",f.isEnabled?"left-5":"left-1")})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:f.name||f.matchValue}),e.jsxs("div",{className:"text-xs text-text-muted",children:[f.matchType==="domain"&&"åŸŸååŒ¹é…",f.matchType==="urlRegex"&&"æ­£åˆ™åŒ¹é…",f.matchType==="header"&&"è¯·æ±‚å¤´åŒ¹é…",": ",e.jsx("code",{className:"text-text-secondary",children:f.matchValue})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:g("badge",f.action==="highlight"&&"badge-warning",f.action==="hide"&&"badge-danger",f.action==="mark"&&"badge-info"),children:[f.action==="highlight"&&"â­ é«˜äº®",f.action==="hide"&&"ğŸš« éšè—",f.action==="mark"&&"ğŸ·ï¸ æ ‡è®°"]}),e.jsx("button",{onClick:()=>x(f),className:"btn btn-ghost px-3",title:"ç¼–è¾‘",children:"âœï¸"}),e.jsx("button",{onClick:()=>f.id&&w(f.id),className:"btn btn-ghost px-3 text-red-400 hover:bg-red-500/10",title:"åˆ é™¤",children:"ğŸ—‘ï¸"})]})]})},f.id))})}),l&&i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>c(!1)}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-bg-dark border border-border rounded-2xl shadow-2xl w-full max-w-md",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:i.id?"ç¼–è¾‘è§„åˆ™":"æ–°å»ºè§„åˆ™"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"è§„åˆ™åç§°"}),e.jsx("input",{type:"text",value:i.name||"",onChange:f=>o({...i,name:f.target.value}),placeholder:"ä¾‹å¦‚ï¼šéšè—å¹¿å‘ŠåŸŸå",className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"åŒ¹é…ç±»å‹"}),e.jsxs("select",{value:i.matchType||"domain",onChange:f=>o({...i,matchType:f.target.value}),className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"domain",children:"åŸŸå"}),e.jsx("option",{value:"urlRegex",children:"URL æ­£åˆ™"}),e.jsx("option",{value:"header",children:"è¯·æ±‚å¤´"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"åŒ¹é…å€¼"}),e.jsx("input",{type:"text",value:i.matchValue||"",onChange:f=>o({...i,matchValue:f.target.value}),placeholder:i.matchType==="domain"?"example.com":".*\\.example\\.com",className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"åŠ¨ä½œ"}),e.jsxs("select",{value:i.action||"highlight",onChange:f=>o({...i,action:f.target.value}),className:"w-full px-3 py-2 bg-bg-medium border border-border rounded-lg text-text-primary focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"highlight",children:"â­ é«˜äº®æ˜¾ç¤º"}),e.jsx("option",{value:"hide",children:"ğŸš« éšè—"}),e.jsx("option",{value:"mark",children:"ğŸ·ï¸ æ ‡è®°"})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-border flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>c(!1),className:"btn btn-ghost",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:h,className:"btn btn-primary",disabled:!i.matchValue,children:"ä¿å­˜"})]})]})})]})]})}function ho(){const{theme:t,setTheme:s}=Ue(),r=()=>{s(t==="dark"?"light":t==="light"?"system":"dark")};return e.jsxs("button",{onClick:r,className:"p-2 rounded-lg hover:bg-bg-light transition-colors text-text-muted hover:text-text-primary",title:`å½“å‰ä¸»é¢˜: ${t==="dark"?"æ·±è‰²":t==="light"?"æµ…è‰²":"è·Ÿéšç³»ç»Ÿ"}`,children:[t==="dark"&&e.jsx(po,{className:"w-5 h-5"}),t==="light"&&e.jsx(fo,{className:"w-5 h-5"}),t==="system"&&e.jsx(go,{className:"w-5 h-5"})]})}function po({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}function fo({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}function go({className:t=""}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}const bo=["/api-docs","/health"];function yo(){const t=Jt(),s=!bo.includes(t.pathname);return e.jsxs("div",{className:"flex h-screen bg-bg-darkest text-text-primary",children:[s&&e.jsx(Ar,{}),e.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[s&&e.jsxs("header",{className:"h-12 bg-bg-dark border-b border-border flex items-center justify-between px-5 shrink-0",children:[e.jsx("div",{className:"flex items-center gap-4 text-xs font-medium text-text-secondary"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs(de,{to:"/api-docs",className:"text-xs text-text-muted hover:text-primary transition-colors flex items-center gap-1.5 px-2 py-1 rounded hover:bg-bg-light",title:"API Documentation",children:[e.jsx("span",{children:"ğŸ“„"}),e.jsx("span",{children:"Docs"})]}),e.jsxs(de,{to:"/health",className:"text-xs text-text-muted hover:text-green-400 transition-colors flex items-center gap-1.5 px-2 py-1 rounded hover:bg-bg-light",title:"System Health",children:[e.jsx("span",{children:"ğŸ’š"}),e.jsx("span",{children:"Health"})]}),e.jsx("div",{className:"h-5 w-px bg-border"}),e.jsx(ho,{})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden relative",children:e.jsxs(_s,{children:[e.jsx(Ne,{path:"/",element:e.jsx(ro,{})}),e.jsx(Ne,{path:"/device/:deviceId",element:e.jsx(Ki,{})}),e.jsx(Ne,{path:"/rules",element:e.jsx(xo,{})}),e.jsx(Ne,{path:"/api-docs",element:e.jsx(oo,{})}),e.jsx(Ne,{path:"/health",element:e.jsx(mo,{})})]})})]})]})}function vo(){const{theme:t,setTheme:s}=Ue();return m.useEffect(()=>{s(t)},[]),m.useEffect(()=>(Ys(),()=>Vs()),[]),e.jsx(Ls,{children:e.jsx(yo,{})})}Ze.createRoot(document.getElementById("root")).render(e.jsx(As.StrictMode,{children:e.jsx(vo,{})}));
